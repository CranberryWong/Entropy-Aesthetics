!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("lodash")):"function"==typeof define&&define.amd?define(["lodash"],t):"object"==typeof exports?exports["platformUtils-bundle"]=t(require("lodash")):e["platformUtils-bundle"]=t(e.lodash)}(this,function(e){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=10)}([function(t,n){t.exports=e},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAllCompsUnderRoot=function(e,t){for(var n=[t],i=0;i<n.length;i++){var o=r.default.get(e.components,[n[i],a])||[];n.push.apply(n,o)}return n.shift(),n},t.isTemplateComp=function(e,t){var n=function(t){return r.default.get(e,["components",t,"parent"])},a=function(t){return r.default.get(e,["components",u,"type"])===i},o=t,u=n(o);for(;u&&!a(u);)u=n(o=u);return a(u)&&r.default.includes(r.default.get(e,["components",u,"children"]),o)};var r=function(e){return e&&e.__esModule?e:{default:e}}(n(0));var a="children",i="wysiwyg.viewer.components.Repeater"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(14);t.default={items:{getAddedItems:r.getAddedItems,getRemovedItems:r.getRemovedItems,getTemplateCompsId:r.getTemplateCompIds},structure:{getUniqueDisplayedId:r.getUniqueDisplayedId,getOriginalId:r.getOriginalId,getItemId:r.getItemId,SPLITTED_DATA_TYPES:r.SPLITTED_DATA_TYPES}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fixMediaTitleLength=d,t.getVideoBackgroundObject=function(e,t){var n=f(e,t);return r.default.assign(n,o)},t.getMediaPlayerVideoObject=function(e,t){var n=f(e,t);return r.default.assign(n,u)},t.getVideoPosterObject=function(e,t,n,r){return{type:"WixVideo",videoId:e,posterImageRef:{type:"Image",uri:t,width:n,height:r}}},t.getImageBackgroundObject=function(e,t){return{type:"Image",uri:e.fileName,title:d(e.title,l),description:t.path,width:e.width,height:e.height,artist:{name:e.vendor||"",id:e.reference||""}}};var r=function(e){return e&&e.__esModule?e:{default:e}}(n(0));var a="...",i=3,o={opacity:1,autoplay:!0,loop:!0,preload:"auto",mute:!0},u={opacity:1,preload:"auto"},l=100;function s(e){return e.replace(/^(.*[\/])/,"")}function d(e,t){if(e.length<=t)return e;var n=e.split(""),r=e.length-t+a.length,o=(e.lastIndexOf(".")>e.length-r-i?e.lastIndexOf("."):e.length-1)-r-i;return n.splice(o,r,a),n.join("")}function c(e,t){return e[t]||e[r.default.camelCase(t)]}function f(e,t){var n=c(e,"file_input"),a=c(e,"file_output"),i=function(e){var t=e.match(/(?:\/|^)([0-9a-fA-F_]+)(?:\/|$)/);return t.length>1?t[1]:""}(e.fileUrl||e.file_name),o=d(e.title,l),u=function(e){var t=r.default.filter(e.video,{format:"mp4"}),n=r.default.head(r.default.get(e,"storyboard")),a=r.default.map(t,function(e){return r.default.pick(e,["width","height","quality","url"])});return n&&a.push({quality:"storyboard",width:n.width,height:n.height,url:n.url}),a}(a),f=function(e){var t=c(e,"adaptive_video");return r.default.map(t,function(e){return{format:e.format,url:e.url}})}(a),p=r.default.head(a.image),m={type:"Image",width:p.width,height:p.height,uri:s(p.url),description:t.path?t.path:void 0};return{type:"WixVideo",title:o,videoId:i,duration:+(n.duration/1e3).toFixed(2),posterImageRef:m,generatedPosters:function(e){return r.default.map(e.image,function(e){return s(e.url)})}(a),qualities:u,adaptiveVideo:f,artist:{name:e.vendor||"",id:e.reference||""},hasAudio:-1!==c(r.default.head(a.video),"audio_bitrate"),fps:r.default.get(r.default.head(a.video),"fps","").toString()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.videoTypes=void 0,t.getVideoUrl=function(e){if(e&&e.videoType&&e.videoId){var t=s(e.videoType,"getVideoUrl");return t&&t(e.videoId)||""}return""},t.getVideoDataFromUrl=function(e){var t=void 0;return r.default.forEach(l,function(n,a){var i=s(a,"getVideoIdFromUrl"),o=i&&i(e);if(!r.default.isEmpty(o))return t={videoType:a,videoId:o},!1}),t};var r=function(e){return e&&e.__esModule?e:{default:e}}(n(0)),a=u(n(5)),i=u(n(6)),o=u(n(7));function u(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}var l={YOUTUBE:u(n(8)),VIMEO:o,DAILYMOTION:a,FACEBOOK:i};function s(e,t){return l[e.toUpperCase()]&&l[e][t]}t.videoTypes={YOUTUBE:"YOUTUBE",VIMEO:"VIMEO",DAILYMOTION:"DAILYMOTION",FACEBOOK:"FACEBOOK"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVideoUrl=function(e){return"https://dailymotion.com/video/"+e},t.getVideoIdFromUrl=function(e){var t=/dailymotion\.com\/(?:video|playlist)\/([^_/]+)/gi.exec(e);if(t&&t.length&&t[1])return t[1]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVideoUrl=function(e){return"https://www.facebook.com/"+e},t.getVideoIdFromUrl=function(e){var t=/facebook\.com\/(.+\/videos\/[A-Za-z0-9._%-]*)/gi.exec(e);if(t&&t.length&&t[1])return t[1]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVideoUrl=function(e){return"https://vimeo.com/"+e},t.getVideoIdFromUrl=function(e){var t=/vimeo\.com\/(\d+)$/gi.exec(e);if(t&&t.length&&t[1])return t[1]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVideoUrl=function(e){return"https://www.youtube.com/watch?v="+e},t.getVideoIdFromUrl=function(e){var t=/(?:youtube\.com\/watch[^\s]*[\?&]v=)([\w-]+)/g.exec(e)||/(?:youtu\.be\/)([\w-]+)/g.exec(e);if(t&&t.length&&t[1])return t[1]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.types=t.errors=t.parseMediaItemUri=t.createMediaItemUri=t.isValidMediaItemUri=void 0;var r=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,a=!1,i=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{!r&&u.return&&u.return()}finally{if(a)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(e){return e&&e.__esModule?e:{default:e}}(n(0));var i={vector:function(e,t){return"wix:vector://v1/"+e+"/"+t},image:function(e,t,n,r,a){return"wix:image://v1/"+e+"/"+t+"#originWidth="+n+"&originHeight="+r+(a?"&watermark="+a:"")},document:function(e,t){return"wix:document://v1/"+e+"/"+t},video:function(e,t,n,r,a){return"wix:video://v1/"+e+"/"+n+"#posterUri="+t+"&posterWidth="+r+"&posterHeight="+a}},o={vector:/^wix:vector:\/\/v1\/([^\/]+)\/([^\/]*)$/,image:/^wix:image:\/\/v1\/([^\/]+)\/([^\/]+)#originWidth=([0-9]+)&originHeight=([0-9]+)(?:&watermark=([^\/]+))?$/,document:/^wix:document:\/\/v1\/([^\/]+)\/([^\/]+)$/,video:/^wix:video:\/\/v1\/([^\/]+)\/([^\/]+)#posterUri=([^\/]+)&posterWidth=([0-9]+)&posterHeight=([0-9]+)$/,deprecated_video:/^wix:video:\/\/v1\/([^\/]+)\/([^\/]+)\/#posterUri=([^\/]+)&posterWidth=([0-9]+)&posterHeight=([0-9]+)$/,deprecated_image:/^image:\/\/v1\/([^\/]+)\/([0-9]+)_([0-9]+)\/([^\/]*)$/,deprecated_type:/^(image):/,type:/^wix:(\w+):/,splitExtension:/\.(?=[^.]+$)/,emptyTitle:/^_\./},u={vector:[o.vector],image:[o.image,o.deprecated_image],document:[o.document],video:[o.video,o.deprecated_video]},l={IMAGE:"image",DOCUMENT:"document",VIDEO:"video",VECTOR:"vector"},s={empty_media_id:"empty_media_id",empty_poster_id:"empty_poster_id",bad_media_id:"bad_media_id",unknown_media_type:"unknown_media_type",missing_width_height:"missing_width_height",non_string_media_id:"non_string_media_id"};function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments[2].split(o.splitExtension),a=r(n,2),i=a[0],u=a[1],s=t.split(o.splitExtension),d=r(s,2),c=d[0],f=d[1],p="";switch(e){case l.IMAGE:p=(c||"_")+"."+(f||u);break;case l.DOCUMENT:p=(c||i)+"."+(f||u);break;case l.VIDEO:p=(c||"_")+(f?"."+f:"");break;case l.VECTOR:p=(c||i)+"."+(f||u)}return encodeURI(p)}function c(e){return o.emptyTitle.test(e)?"":decodeURI(e)}t.isValidMediaItemUri=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments[1],n=u[t];return a.default.some(n,function(t){return t.test(e)})},t.createMediaItemUri=function(e){var t=e.mediaId,n=e.type,r=e.title,a=e.width,o=e.height,u=e.posterId,c=e.watermark;switch(n){case l.IMAGE:return function(e,t,n,r,a){if(!e)return{error:s.empty_media_id};if(isNaN(r)||isNaN(n))return{error:s.missing_width_height};var o=d(l.IMAGE,t,e);return{item:i.image(e,o,n,r,a)}}(t,r,a,o,c);case l.DOCUMENT:return function(e,t){if(!e)return{error:s.empty_media_id};var n=d(l.DOCUMENT,t,e);return{item:i.document(e,n)}}(t,r);case l.VECTOR:return function(e,t){if(!e)return{error:s.empty_media_id};var n=d(l.VECTOR,t,e);return{item:i.vector(e,n)}}(t,r);case l.VIDEO:return function(e,t,n,r,a){if(!e)return{error:s.empty_media_id};if(!a)return{error:s.empty_poster_id};if(isNaN(r)||isNaN(n))return{error:s.missing_width_height};e=e.replace("video/","");var o=d(l.VIDEO,t,e);return{item:i.video(e,a,o,n,r)}}(t,r,a,o,u);default:return{error:s.unknown_media_type}}},t.parseMediaItemUri=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(!a.default.isString(e))return{error:s.non_string_media_id};var t=e.match(o.type)||[];switch(r(t,2)[1]){case l.IMAGE:return function(e){var t=e.match(o.image)||[],n=r(t,6),a=n[1],i=n[2],u=n[3],d=n[4],f=n[5],p=c(i);if(a){var m={type:l.IMAGE,mediaId:a,title:p,width:parseInt(u,10),height:parseInt(d,10)};return f&&(m.watermark=f),m}return{error:s.bad_media_id}}(e);case l.DOCUMENT:return function(e){var t=e.match(o.document)||[],n=r(t,3),a=n[1],i=c(n[2]);return a?{type:l.DOCUMENT,mediaId:a,title:i}:{error:s.bad_media_id}}(e);case l.VECTOR:return function(e){var t=e.match(o.vector)||[],n=r(t,3),a=n[1],i=c(n[2]);return a?{type:l.VECTOR,mediaId:a,title:i}:{error:s.bad_media_id}}(e);case l.VIDEO:return function(e){var t=o.deprecated_video.test(e)?o.deprecated_video:o.video,n=e.match(t)||[],a=r(n,6),i=a[1],u=a[2],d=a[3],f=a[4],p=a[5],m=c(u);return i&&d?{type:l.VIDEO,mediaId:i,posterId:d,width:parseInt(f,10),height:parseInt(p,10),title:m}:{error:s.bad_media_id}}(e);default:var n=e.match(o.deprecated_type)||[];return r(n,2)[1]?function(e){var t=e.match(o.deprecated_image)||[],n=r(t,5),a=n[1],i=n[2],u=n[3],d=c(n[4]);return a?{type:l.IMAGE,mediaId:a,title:d,width:parseInt(i,10),height:parseInt(u,10)}:{error:s.bad_media_id}}(e):{error:s.unknown_media_type}}},t.errors=s,t.types=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.platformizedEndpointsUtils=t.componentsHooks=t.backgroundUtils=t.repeaterUtils=t.videoUrlsUtils=t.richTextUtils=t.uriUtils=t.mediaSrcHandler=t.mediaItemUtils=t.widgetUtils=t.linkUtils=t.typeUtils=t.RemoteModelInterface=t.RemoteGlobalsInterface=void 0;var r=n(11);Object.defineProperty(t,"RemoteGlobalsInterface",{enumerable:!0,get:function(){return r.RemoteGlobalsInterface}});var a=n(12);Object.defineProperty(t,"RemoteModelInterface",{enumerable:!0,get:function(){return a.RemoteModelInterface}});var i=h(n(3)),o=h(n(15)),u=h(n(17)),l=h(n(18)),s=h(n(19)),d=h(n(20)),c=h(n(4)),f=h(n(21)),p=h(n(9)),m=n(22),g=function(e){return e&&e.__esModule?e:{default:e}}(n(2)),v=h(n(23)),y=h(n(27));function h(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}t.typeUtils=new m.TypeUtils(s);t.linkUtils=u,t.widgetUtils=f,t.mediaItemUtils=p,t.mediaSrcHandler=y,t.uriUtils=d,t.richTextUtils=l,t.videoUrlsUtils=c,t.repeaterUtils=g.default,t.backgroundUtils=i,t.componentsHooks=o,t.platformizedEndpointsUtils=v},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RemoteGlobalsInterface=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(e){return e&&e.__esModule?e:{default:e}}(n(0));var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._globals=t||{navigation:{},sessionInfo:{},appsData:{},siteMemberData:{uid:null,permissions:null,onUserLogin:[]},multilingualInfo:{isEnabled:!1,currentLanguageCode:null,siteLanguages:[],onCurrentLanguageChange:[]},appStudioWidgetData:{isApplicationStudio:!1,onPropsChanged:[]},deviceType:null,lightboxContext:{},contextId:null}}return r(e,[{key:"addNavigation",value:function(e){this._globals.navigation=e}},{key:"addSiteMemberData",value:function(e){var t=e.uid&&e.uid!==this._globals.siteMemberData.uid;if(a.default.assign(this._globals.siteMemberData,e),t){var n=this._globals.siteMemberData.onUserLogin;a.default.forEach(n,function(t){t(e)})}}},{key:"addAppsData",value:function(e){this._globals.appsData=e}},{key:"addOnUserLoginCallback",value:function(e){this._globals.siteMemberData.onUserLogin.push(e)}},{key:"addSessionInfoProp",value:function(e){a.default.assign(this._globals.sessionInfo,e)}},{key:"addDeviceType",value:function(e){this._globals.deviceType=e}},{key:"addLightboxContext",value:function(e){this._globals.lightboxContext=e}},{key:"addContextId",value:function(e){this._globals.contextId=e}},{key:"addMultilingualInfo",value:function(e){var t=e.currentLanguageCode&&e.currentLanguageCode!==this._globals.multilingualInfo.currentLanguageCode;if(a.default.assign(this._globals.multilingualInfo,e),t){var n=this._globals.multilingualInfo.onCurrentLanguageChange;a.default.forEach(n,function(t){t(e)})}}},{key:"addOnCurrentLanguageChangeCallback",value:function(e){this._globals.multilingualInfo.onCurrentLanguageChange.push(e)}},{key:"getAppsData",value:function(){return a.default.cloneDeep(this._globals.appsData)}},{key:"getDeviceType",value:function(){return this._globals.deviceType}},{key:"getLightboxContext",value:function(){return a.default.cloneDeep(this._globals.lightboxContext)}},{key:"getContextId",value:function(){return this._globals.contextId}},{key:"getAppData",value:function(e){return a.default.cloneDeep(a.default.get(this._globals.appsData,e))}},{key:"getNavigationInfo",value:function(){return a.default.cloneDeep(this._globals.navigation)}},{key:"getSiteMemberData",value:function(e){var t=a.default.cloneDeep(this._globals.siteMemberData);if(e){var n=a.default.get(this._globals.appsData,e);n&&a.default.assign(t,a.default.pick(n,["instance","instanceId"]))}return t}},{key:"getMultilingualInfo",value:function(){return a.default.cloneDeep(this._globals.multilingualInfo)}},{key:"getCurrentLanguageCode",value:function(){return this._globals.multilingualInfo.currentLanguageCode}},{key:"getSiteLanguages",value:function(){return this._globals.multilingualInfo.siteLanguages}},{key:"getIsMultilingualEnabled",value:function(){return this._globals.multilingualInfo.isEnabled}},{key:"getSessionInfo",value:function(){return a.default.cloneDeep(this._globals.sessionInfo)}},{key:"addIsApplicationStudio",value:function(e){this._globals.appStudioWidgetData.isApplicationStudio=e}},{key:"getIsApplicationStudio",value:function(){return this._globals.appStudioWidgetData.isApplicationStudio}},{key:"addOnWidgetPropsChangedCallback",value:function(e){this._globals.appStudioWidgetData.onPropsChanged.push(e)}},{key:"triggerWidgetPropsChanged",value:function(e,t){a.default.forEach(this._globals.appStudioWidgetData.onPropsChanged,function(n){n(a.default.cloneDeep(e),a.default.cloneDeep(t))})}},{key:"toJson",value:function(){return this._globals}}]),e}();t.RemoteGlobalsInterface=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RemoteModelInterface=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=l(n(0)),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(1)),o=n(13),u=l(n(2));function l(e){return e&&e.__esModule?e:{default:e}}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d="data",c="fullData",f="design",p="state",m="type",g="props",v="parent",y="events",h="layout",_="behavior",b="publicAPI",w="isDisplayed",k="style",I="id",O="children",T="displayedOnlyComponents",E="displayedRoot",D="GLOBAL_SCOPE";t.RemoteModelInterface=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._model=t||{components:{},connections:{},componentsScopes:{},siteStructure:{},pageData:{},eventHandlers:{},EventTypes:{},appStudioWidgetData:{properties:{}},scopesHierarchy:[{type:D,id:D,additionalData:{}}]},this._onUpdateCallback=n;var i=a.default.get(r,"_hooksManager"),u=a.default.get(r,"_transaction");this._hooksManager=i||new o.HooksManager,this._transaction=u||{_onTransaction:!1,_transactionData:{}}}return r(e,[{key:"addComponent",value:function(e,t){var n=M();for(var r in n)n[r]=t[r]||n[r];n[v]=t[v],n[m]=t[m],n[I]=t[I],n[E]=t[E],this._model.components[e]=n,this._model.componentsScopes[e]=D}},{key:"addSiteStructure",value:function(e){this._model.siteStructure=e}},{key:"addPageData",value:function(e){this._model.pageData=e}},{key:"addConnections",value:function(e){this._model.connections=e}},{key:"resetComponentsScope",value:function(){var e=this;for(var t in this._model.components){this._model.components[t].displayedOnlyComponents.forEach(function(t){return e._model.componentsScopes[t]=null})}}},{key:"addEventTypes",value:function(e){this._model.EventTypes=e}},{key:"addOnUserLoginCallback",value:function(e){this._model.siteMemberData.onUserLogin.push(e)}},{key:"getComp",value:function(e){return a.default.cloneDeep(a.default.get(this._model.components,e))}},{key:"getState",value:function(e){return a.default.cloneDeep(a.default.get(this._model.components,[e,p]))}},{key:"getData",value:function(e){return a.default.cloneDeep(a.default.get(this._model.components,[e,d]))}},{key:"getStyle",value:function(e){return a.default.cloneDeep(a.default.get(this._model.components,[e,k]))}},{key:"getDesign",value:function(e){return a.default.cloneDeep(a.default.get(this._model.components,[e,f]))}},{key:"getType",value:function(e){return a.default.cloneDeep(a.default.get(this._model.components,[e,m]))}},{key:"getProps",value:function(e){return a.default.cloneDeep(a.default.get(this._model.components,[e,g]))}},{key:"getEvents",value:function(e){return a.default.cloneDeep(a.default.get(this._model.components,[e,y]))}},{key:"getLayout",value:function(e){return a.default.cloneDeep(a.default.get(this._model.components,[e,h]))}},{key:"getId",value:function(e){return a.default.cloneDeep(a.default.get(this._model.components,[e,I]))}},{key:"getEventTypes",value:function(){return a.default.cloneDeep(this._model.EventTypes)}},{key:"getPublicAPI",value:function(e){var t=a.default.get(this._model.components,[e,b]);return a.default.isFunction(t)?t:a.default.cloneDeep(t)}},{key:"getCallbackById",value:function(e,t){var n=this._model.eventHandlers[e];return t?n:a.default.get(n,"callback")}},{key:"getParent",value:function(e){return a.default.cloneDeep(a.default.get(this._model.components,[e,v]))}},{key:"getChildren",value:function(e){return a.default.clone(a.default.get(this._model.components,[e,O]))}},{key:"getSiteStructure",value:function(){return a.default.cloneDeep(this._model.siteStructure)}},{key:"getPageData",value:function(){return a.default.cloneDeep(this._model.pageData)}},{key:"getFullDataWithOverrides",value:function(e){return a.default.defaults(this.getData(e),function(e){return a.default.cloneDeep(a.default.get(this._model.components,[e,c]))}.call(this,e))}},{key:"setDataWithoutUpdate",value:function(e,t){P.call(this,e,d,t)}},{key:"setData",value:function(e,t){P.call(this,e,d,t,this._onUpdateCallback)}},{key:"setStyle",value:function(e,t,n){var r=this;P.call(this,e,k,t,function(e,t,a){r._onUpdateCallback.call(r,e,t,a,n)})}},{key:"setDesign",value:function(e,t){P.call(this,e,f,t,this._onUpdateCallback)}},{key:"setProps",value:function(e,t,n){var r=this;P.call(this,e,g,t,function(e,t,a){r._onUpdateCallback.call(r,e,t,a,n)})}},{key:"setLayout",value:function(e,t){P.call(this,e,h,t,this._onUpdateCallback)}},{key:"setPublicAPI",value:function(e,t){var n=a.default.get(this._model.components,e);n&&(n[b]=t)}},{key:"getCurrentScope",value:function(){return a.default.clone(a.default.get(this._model.scopesHierarchy,0))}},{key:"executeCompBehavior",value:function(e,t,n,r){S.call(this,"comp",t,n,e,r)}},{key:"executeAnimation",value:function(e,t,n,r){S.call(this,"animation",t,n,e,r)}},{key:"setUpdateCallback",value:function(e){this._onUpdateCallback=e}},{key:"registerEvent",value:function(e,t,n,r,i){var o=void 0;void 0===i&&(i=r,r=void 0),a.default.isFunction(i)?(o=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}(),this._model.eventHandlers[o]={callback:i,contextId:e,controllerId:r}):o=i;var u={contextId:e,eventType:n,callbackId:o},l=a.default.get(this._model,["components",t]);if(void 0!==l){if(this._hooksManager.executeHooksAndUpdateValue(this,"registerEvent",l.type,t,[e,n,r,i]),l.events.push({eventType:n,callbackId:o}),this._transaction._onTransaction)return void U.call(this,t,"registerEvent",u);a.default.isFunction(this._onUpdateCallback)&&this._onUpdateCallback(t,"registerEvent",u)}}},{key:"toJson",value:function(){return this._model}},{key:"getComponents",value:function(){var e={};for(var t in this._model.components)i.isTemplateComp(this._model,t)||(e[t]=this.getComp(t));return e}},{key:"getScopedRMI",value:function(e){var t=new this.constructor(this._model,this._onUpdateCallback,{_hooksManager:this._hooksManager,_transaction:this._transaction});return t.getCompIdsFromRole=t.getCompIdsFromRole.bind(t,e),t.getCompIdsFromType=t.getCompIdsFromType.bind(t,e),t.getConfig=t.getConfig.bind(t,e),t}},{key:"getNestedScopedRMI",value:function(e){return new this.constructor(e||this._model,this._onUpdateCallback,{_hooksManager:this._hooksManager,_transaction:this._transaction})}},{key:"getCompIdsFromType",value:function(e,t,n){var r=a.default.get(this._model.connections,e),i=a.default.flatMap(r,Object.keys),o=[],u=C.call(this,n);return i.forEach(function(e){this.getType(e)===t&&a.default.includes(u,a.default.get(this._model.componentsScopes,e))&&o.push(e)},this),o}},{key:"getCompIdsFromRole",value:function(e,t,n){var r=this,i=a.default.get(this._model.connections,[e,t]),o=C.call(this,n);return(i?Object.keys(i):[]).filter(function(e){return a.default.includes(o,a.default.get(r._model.componentsScopes,e))})}},{key:"getConfig",value:function(e,t,n,r){var i=a.default.get(this._model.connections,[e,n]),o=C.call(this,r);return i&&i.hasOwnProperty(t)&&a.default.includes(o,a.default.get(this._model.componentsScopes,t))?i[t]:{}}},{key:"updateModel",value:function(e){for(var t in e){var n=M(),r=a.default.get(this._model.components,t),i=e[t];if(r)for(var o in i)a.default.has(r,o)&&(a.default.isObject(r[o])?i[o]?a.default.assign(r[o],i[o]):r[o]=n[o]:r[o]=i[o])}}},{key:"getScopedRMIByCompId",value:function(e){var t=this.getRepeaterItemContext(e);if(a.default.isEmpty(t))return this;var n=t.displayedRoot,r=t.itemId;return this.getScopedRMIForRepeaterItem(n,r)}},{key:"getScopedRMIForRepeaterItem",value:function(e,t){var n=a.default.clone(this._model),r=i.getAllCompsUnderRoot(n,e),o=r.map(function(e){return u.default.structure.getUniqueDisplayedId(e,t)});return n.scopesHierarchy=a.default.clone(n.scopesHierarchy),n.scopesHierarchy.unshift({type:"COMPONENT_SCOPE",id:e,compId:e,additionalData:{itemId:t}}),n.componentsScopes=a.default.clone(n.componentsScopes),r.forEach(function(e){return n.componentsScopes[e]=null}),o.forEach(function(t){return n.componentsScopes[t]=e}),this.getNestedScopedRMI(n)}},{key:"getRepeaterItemContext",value:function(e){var t=a.default.get(this._model.components,[e,E]);return t?{displayedRoot:t,itemId:u.default.structure.getItemId(e)}:{}}},{key:"getScopeByCompId",value:function(e){var t=this.getRepeaterItemContext(e),n=t.displayedRoot,r=t.itemId;return n?{type:"COMPONENT_SCOPE",id:n,compId:n,additionalData:{itemId:r}}:{type:D,id:D,additionalData:{}}}},{key:"isRepeaterScope",value:function(e){return"COMPONENT_SCOPE"===a.default.get(e,"type")&&!a.default.isEmpty(a.default.get(e,"additionalData.itemId"))}},{key:"startTransaction",value:function(){this._transaction._onTransaction=!0}},{key:"endTransaction",value:function(){this._onUpdateCallback&&this._onUpdateCallback(null,"executeBatch",this._transaction._transactionData),this._transaction._onTransaction=!1,this._transaction._transactionData={}}},{key:"setBatchData",value:function(e){var t=this;a.default.forEach(e,function(e,n){a.default.forEach(e,function(e,r){switch(r){case"registerEvent":a.default.forEach(e,function(e){t.registerEvent.call(t,e.contextId,n,e.eventType,e.controllerId,e.callbackId)});break;default:var i="set"+a.default.startCase(r);t[i].call(t,n,e)}})})}},{key:"registerHook",value:function(e,t,n){this._hooksManager.registerHook(e,t,n)}},{key:"getHooks",value:function(){return this._hooksManager.HOOKS}},{key:"updateWidgetProperties",value:function(e){this._model.appStudioWidgetData.properties=e}},{key:"getWidgetProperties",value:function(){return this._model.appStudioWidgetData.properties}}]),e}();function C(e){return e?a.default.get(this._model.scopesHierarchy,"0.id"):a.default.map(this._model.scopesHierarchy,function(e){return a.default.get(e,"id")})}function M(){var e;return s(e={},v,null),s(e,p,{}),s(e,m,null),s(e,d,{}),s(e,c,{}),s(e,f,{}),s(e,g,{}),s(e,h,{}),s(e,y,[]),s(e,w,!1),s(e,I,null),s(e,b,{}),s(e,k,{}),s(e,O,[]),s(e,T,[]),s(e,E,null),e}function S(e,t,n,r,i){var o=a.default.get(n,"requiresDom",{compId:r}),u={type:e,name:t,targetId:r,requiresDom:o,params:n=o?n:a.default.omit(n,["requiresDom"])};this._onUpdateCallback&&this._onUpdateCallback(r,_,u,i)}function P(e,t,n,r){var i=a.default.get(this._model,["components",e]);i&&(this._hooksManager.executeHooksAndUpdateValue(this,t,i.type,e,[n,r]),i[w]&&(this._model.components[e][t]=a.default.defaults({},n,i[t])),r&&(this._transaction._onTransaction?U.call(this,e,t,n):r(e,t,n)))}function U(e,t,n){var r=this._transaction._transactionData;if(r[e]||(r[e]={}),"registerEvent"===t)return r[e][t]||(r[e][t]=[]),void r[e][t].push(n);r[e][t]||(r[e][t]={}),a.default.assign(r[e][t],n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HooksManager=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(e){return e&&e.__esModule?e:{default:e}}(n(0));var i={all:"all",data:"data"};t.HooksManager=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._hooks={}}return r(e,[{key:"validateHookName",value:function(e){if(!i[e])throw"Invalid Hook Name "+e}},{key:"unregisterAllHooks",value:function(){this._hooks={}}},{key:"unregisterHooks",value:function(e){var t=this;a.default.forEach(e,function(e){return delete t._hooks[e]})}},{key:"executeHooksAndUpdateValue",value:function(e,t,n,r,o){function u(i){var u=this;if(i){var l=i[n]||[],s=i["*"]||[];a.default.forEach(l.concat(s),function(n){n.apply(u,[e,t,r].concat(o||[]))})}}var l=this._hooks[t],s=this._hooks[i.all];u(l),u(s)}},{key:"registerHook",value:function(e,t,n){if(this.validateHookName(e),n){var r=this._hooks[e];r||(this._hooks[e]=r={});var a=r[t=t||"*"];a||(r[t]=a=[]),a.push(n)}}},{key:"HOOKS",get:function(){return i}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SPLITTED_DATA_TYPES=void 0,t.getAddedItems=function(e,t){var n=o(t),a=o(e),i=r.default.difference(n,a);return u(t,i)},t.getRemovedItems=function(e,t){var n=o(t),a=o(e),i=r.default.difference(a,n);return u(e,i)},t.getUniqueDisplayedId=l,t.getOriginalId=function(e){if(!e)return;return e.split(i)[0]},t.getItemId=function(e){if(!e)return;return e.split(i)[1]},t.getTemplateCompIds=function(e,t,n){var i=(0,a.getAllCompsUnderRoot)(r.default.get(e,"_model"),t),o=r.default.compact(r.default.map(n,function(e){return r.default.get(e,"item._id")}));return r.default.reduce(o,function(e,t){return e.concat(r.default.map(i,function(e){return l(e,t)}))},[])};var r=function(e){return e&&e.__esModule?e:{default:e}}(n(0)),a=n(1);var i="__";t.SPLITTED_DATA_TYPES=["data","design"];function o(e){return r.default.map(e,function(e){return r.default.isString(e)?e:e._id})}function u(e,t){var n=r.default.map(e,function(e){return r.default.isString(e)?{_id:e}:e});return r.default.reduce(n,function(e,n,a){return r.default.includes(t,n._id)&&e.push({item:n,index:a}),e},[])}function l(e,t){return e+i+t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.repeaters=void 0;var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(16));t.repeaters=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateRepeaterItems=function(e,t,n,o){if(o.items){var u=a.getAllCompsUnderRoot(e._model,n),l=r.default.get(e._model.components,[n,"data"]),s=i.default.items.getAddedItems(l.items,o.items);!function(e,t,n,a){(function(e,t,n){var a=r.default.get(e,"connections"),o=r.default.keys(a);r.default.forEach(o,function(e){var o=r.default.keys(r.default.get(a,e));r.default.forEach(o,function(o){var u=r.default.keys(r.default.get(a,[e,o]));r.default.forEach(u,function(u){if(r.default.includes(t,u)){var l=r.default.get(a,[e,o,u]);r.default.forEach(n,function(t){var n=i.default.structure.getUniqueDisplayedId(u,t);r.default.set(a,[e,o,n],r.default.cloneDeep(l))})}})})})})(e,t,n),function(e,t,n,a){r.default.forEach(t,function(t){r.default.forEach(n,function(n){var o=i.default.structure.getUniqueDisplayedId(t,n),u=e.components[t],l=r.default.cloneDeep(u);l.displayedOnlyComponents=[],l.children=r.default.map(u.children,function(e){return i.default.structure.getUniqueDisplayedId(e,n)}),l.parent=u.parent===a?a:i.default.structure.getUniqueDisplayedId(u.parent,n),l.displayedRoot=a,l.isDisplayed=!!r.default.get(e.components[a],"isDisplayed"),r.default.forEach(i.default.structure.SPLITTED_DATA_TYPES,function(e){var t=l[e];t.id&&(t.id=i.default.structure.getUniqueDisplayedId(l[e].id,n),r.default.forEach(t,function(e,a){r.default.isObject(e)&&e.id&&(t[a].id=i.default.structure.getUniqueDisplayedId(t[a].id,n))}))}),e.components[o]=l})})}(e,t,n,a),function(e,t,n){r.default.forEach(t,function(t){r.default.forEach(n,function(n){var r=i.default.structure.getUniqueDisplayedId(t,n);e.componentsScopes[r]=null})})}(e,t,n)}(e._model,u,r.default.map(s,"item._id"),n);var d=i.default.items.getRemovedItems(l.items,o.items);!function(e,t,n){(function(e,t,n){var a=r.default.get(e,"connections"),o=r.default.keys(a);r.default.forEach(o,function(e){var o=r.default.keys(r.default.get(a,[e]));r.default.forEach(o,function(o){var u=r.default.keys(r.default.get(a,[e,o]));r.default.forEach(u,function(u){var l=i.default.structure.getItemId(u),s=i.default.structure.getOriginalId(u);l&&r.default.includes(n,l)&&r.default.includes(t,s)&&delete a[e][o][u]})})})})(e,t,n),function(e,t,n){r.default.forEach(t,function(t){r.default.forEach(n,function(n){var r=i.default.structure.getUniqueDisplayedId(t,n);delete e.componentsScopes[r]})})}(e,t,n),function(e,t,n){r.default.forEach(t,function(t){r.default.forEach(n,function(n){var r=i.default.structure.getUniqueDisplayedId(t,n);delete e.components[r]})})}(e,t,n)}(e._model,u,r.default.map(d,"item._id")),r.default.forEach(u,function(t){var n=e._model.components[t];n.displayedOnlyComponents=r.default.map(o.items,function(e){return i.default.structure.getUniqueDisplayedId(t,e)})})}},t.syncRepeaterItemData=function(e,t,n){var i=arguments,o=e._model;if("registerEvent"!==t&&a.isTemplateComp(o,n)){var u=r.default.get(o,["components",n]),l=arguments[3];o.components[n][t]=r.default.defaults({},l,u[t])}var s=r.default.get(e._model.components,[n,"displayedOnlyComponents"]);if(!r.default.isEmpty(s)){var d="set"+r.default.startCase(t);if("registerEvent"===t)return d="registerEvent",void r.default.forEach(s,function(t){var n=[].concat(Array.prototype.slice.call(i));e[d].apply(e,[n[3],t].concat(n.splice(4)))});r.default.forEach(s,function(n){var a=[].concat(Array.prototype.slice.call(i));"data"!==t||r.default.isFunction(r.default.last(a))?e[d].apply(e,[n].concat(a.splice(3))):e.setDataWithoutUpdate.apply(e,[n].concat(a.splice(3)))})}};var r=o(n(0)),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(1)),i=o(n(2));function o(e){return e&&e.__esModule?e:{default:e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertLinkObjectToUrl=function(e,t,n){if(!t||!r.default.get(E,[t.type,"url"]))throw new Error("Provided link type is not supported");return r.default.get(E,[t.type,"url"])(t,e,n)},t.convertUrlToLinkObject=function(e,t,n,a){var i=function(e,t){switch(!0){case u.test(e):return h.EXTERNAL;case l.test(e):return h.EMAIL;case v.test(e):return h.SAME_PAGE_ANCHOR_LINK;case d.test(e):return A(D(e),t)?R(e):h.PAGE_TOP;case c.test(e):return A(D(e),t)?R(e):h.PAGE_BOTTOM;case g.test(e):return A(D(e),t)?R(e):h.ANCHOR;case s.test(e):return A(D(e),t)?R(e):h.PAGE;case f.test(e):case p.test(e):return h.DOCUMENT;case m.test(e):return h.PHONE;default:throw new I}}(t,e),o=function(e,t,n){if(n===h.DYNAMIC_PAGE||n===h.DYNAMIC_PAGE_WITH_QUERY_PARAMS)return D(t);var a=r.default.find(e,function(e){return e.test(t)}),i=t.match(a);return i=i||[]}(E[i].regex,t,i);return r.default.get(E,[i,"link"])(i,o,e,a,n)},t.getAnchorDataId=function(e){return C(e.anchorDataId)},t.getPageId=function(e){return U(e.pageId)},t.convertQueryParamsToObject=L;var r=function(e){return e&&e.__esModule?e:{default:e}}(n(0));function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=/^(http|https):\/\/(.*)/,l=/^mailto:([^\?]*)(?:\?subject=(.*)?)?/,s=/^\/([^ \?]*)[\?]?(.*)/,d=/^(\/?)([^ \?]*)#(top|SCROLL_TO_TOP)[\?]?(.*)/,c=/^(\/?)([^ \?]*)#(bottom|SCROLL_TO_BOTTOM)[\?]?(.*)/,f=/^document:\/\/(.*)/,p=/^wix:document:\/\/v1\/(.+)\/(.+)/,m=/^tel:(.*)/,g=/^\/([^ \?]*)#([^ \?]*)[\?]?(.*)/,v=/^#([^ \?]*)[\?]?(.*)/,y={SCROLL_TO_TOP:"top",SCROLL_TO_BOTTOM:"bottom"},h={PAGE:"PageLink",DYNAMIC_PAGE:"DynamicPageLink",DYNAMIC_PAGE_WITH_QUERY_PARAMS:"DynamicPageLinkWithQueryParams",EXTERNAL:"ExternalLink",EMAIL:"EmailLink",DOCUMENT:"DocumentLink",PHONE:"PhoneLink",PAGE_TOP:"AnchorLink",PAGE_BOTTOM:"AnchorLink",SAME_PAGE_ANCHOR_LINK:"SamePageAnchorLink",ANCHOR:"AnchorLink"},_=["_blank","_self"],b="masterPage",w=r.default.template("<%=linkObject.pageId%>#<%=linkObject.anchorDataId%>",{variable:"linkObject"}),k=r.default.template("/<%=linkObject.pageId%>",{variable:"linkObject"}),I=function(e){function t(){a(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Unsupported link type"));return e.name="UnsupportedLinkTypeError",Error.captureStackTrace&&Error.captureStackTrace(e,t),e}return o(t,Error),t}(),O=function(e){function t(){a(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Unsupported target value"));return e.name="UnsupportedTargetValueError",e.supportedTargets=_,Error.captureStackTrace&&Error.captureStackTrace(e,t),e}return o(t,Error),t}();function T(e,t,n){var a=e;n&&(a=r.default.dropRight(e));var i=r.default.drop(t?r.default.dropRight(a):a);return r.default.join(i,"/")}var E={PageLink:{url:function(e,t,n){var a=P(e.pageId),i=r.default.find(n,{id:a});return i?i.url:k({pageId:a})},link:function(e,t,n,a){var i=function(e){var t=r.default.split(e,"/");if(t.length>1){var n=r.default.join(r.default.drop(t),"/");return r.default.concat([],r.default.head(t),n)}return t}(t[1]),o={type:e,pageId:"#"+x(r.default.head(i),a)};3===t.length&&t[2]&&r.default.assign(o,{queryParams:L(t[2])||""});var u=i[1];return u&&r.default.assign(o,{tpaInnerRoute:u}),o},regex:[s]},DocumentLink:{url:r.default.template("wix:document://v1/<%=linkObject.docId%>/<%=linkObject.name%>",{variable:"linkObject"}),link:function(e,t){return{type:e,docId:t[1],name:r.default.isUndefined(t[2])?"":t[2]}},regex:[f,p]},PhoneLink:{url:r.default.template("tel:<%=linkObject.phoneNumber%>",{variable:"linkObject"}),link:function(e,t){return{type:e,phoneNumber:t[1]}},regex:[m]},EmailLink:{url:function(e){var t="mailto:<%=linkObject.recipient%>";r.default.has(e,"subject")&&(t+="?subject=<%=linkObject.subject%>");return r.default.template(t,{variable:"linkObject"})(e)},link:function(e,t){var n={type:e,recipient:r.default.escape(t[1])};return t[2]&&(n.subject=r.default.escape(t[2])),n},regex:[l]},ExternalLink:{url:r.default.template("<%=linkObject.url%>",{variable:"linkObject"}),link:function(e,t,n,a,i){if(i&&!r.default.includes(_,i))throw new O;return{type:e,url:r.default.template("<%= partA %>://<%= partB%>")({partA:t[1],partB:t[2]}),target:i||"_blank"}},regex:[u]},DynamicPageLink:{url:M,link:function(e,t,n){var a=r.default.startsWith(r.default.last(t),"#"),i=r.default.find(n,{name:t[0]}),o={type:e,innerRoute:T(t,a)||"/",routerId:i.id};if(a){var u=r.default.last(t).replace("#","");o.anchorDataId=r.default.get(r.default.invert(y),u,u)}return o},regex:[d,c,g,s]},DynamicPageLinkWithQueryParams:{url:M,link:function(e,t,n){var a=r.default.last(t),i=r.default.startsWith(t[t.length-2],"#"),o=r.default.find(n,{name:t[0]}),u={type:h.DYNAMIC_PAGE,innerRoute:T(t,i,!0)||"/",routerId:o.id,queryParams:L(a)};if(i){var l=t[t.length-2].replace("#","");u.anchorDataId=r.default.get(r.default.invert(y),l,l)}return u},regex:[d,c,g,s]},AnchorLink:{url:S,link:function(e,t,n,a){var i=t[2],o={type:e,pageId:"#"+x(t[1],a),anchorDataId:r.default.invert(y)[i]||i};return 4===t.length&&t[3]&&r.default.assign(o,{queryParams:L(t[3])}),o},regex:[g]},SamePageAnchorLink:{url:S,link:function(e,t){var n=t[1],a={type:h.ANCHOR,anchorDataId:r.default.invert(y)[n]||n,pageId:"#"+b};return 3===t.length&&t[2]&&r.default.assign(a,{queryParams:L(t[2])}),a},regex:[v]}};function D(e){var t=e.match(s),n=t[1].replace("#","/#").split(/[\/]+/);return r.default.includes(e,"?")&&n.push(r.default.last(t)),n}function C(e){return y[e]||e}function M(e,t){var n=e.innerRoute&&"/"!==e.innerRoute?"/"+e.innerRoute:"",a=function(e,t){var n=r.default.find(e,{id:t.routerId});return n&&n.prefix}(t,e)+n,i=C(e.anchorDataId),o={pageId:r.default.startsWith(a,"/")?a:"/"+a,anchorDataId:i};return o.anchorDataId?w(o):a}function S(e,t,n){var a=C(e.anchorDataId);if(j(U(e.pageId)))return"#"+a;var i=P(e.pageId),o=r.default.find(n,{id:i});return w(o?{pageId:o.url,anchorDataId:a}:{pageId:r.default.startsWith(i,"/")?i:"/"+i,anchorDataId:a})}function P(e){return j(e=U(e))?"":e.replace("#","")}function U(e){if(!e)return e;if(r.default.isPlainObject(e)){if(e.pageUriSEO)return e.pageUriSEO;if(j(e.id))return b;throw new Error("pageId object should contain pageUriSEO")}return e}function x(e,t){var n=""===e?r.default.find(t,"isMainPage"):r.default.find(t,{url:"/"+e});return r.default.get(n,"id",e)}function A(e,t){return r.default.find(t,{name:e[0]})}function R(e){return r.default.includes(e,"?")?h.DYNAMIC_PAGE_WITH_QUERY_PARAMS:h.DYNAMIC_PAGE}function j(e){return e.replace("#","")===b}function L(e){if(!r.default.isString(e))return{};var t=e.split("&");return r.default.reduce(t,function(e,t){var n=t.split("=");return e[n[0]]=n[1]?decodeURIComponent(n[1]):null,e},{})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyTransformationForSetHtml=function(e){return e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(!e)return e;var t=/class\s*?=\s*["'](.*?)['"]/,n=/(class\s*?=\s*["'])(.*?)(['"])/;return e.replace(/<(ol|ul|h[1-6]|p)(.*?)>/g,function(e,a,i){var o=i.match(t);if(!o)return"<"+a+i+' class="'+r[a]+'">';var u=o[1];return/(^|\s)font_[0-9]($|\s)/.test(u)?e:"p"===a&&/\bp[13]\b/i.test(u)?e.replace(/(.*?\bclass\s*?=.*?)\bp([13])\b(.*)/,function(e,t,n,r){var a="1"===n?"font_7":"font_9";return""+t+a+r}):"<"+a+i.replace(n,function(e,t,n,i){return""+t+r[a]+" "+n+i})+">"})}(e)},t.applyTransformationForGetHtml=function(){var e=/(class\s*=['"][^'"]*?)\bfont_([79])\b/;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").replace(/<(ol|ul|h[1-6]|p)(.*?)>/g,function(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=r[n],o=new RegExp("(class\\s*=['\"].*?)"+i);return o.test(a)?t=t.replace(o,"$1"):"p"===n&&e.test(a)&&(t=t.replace(e,function(e,t,n){return t+("7"===n?"p1":"p3")})),t.replace(/class\s*=(['"])\s*\1/,"").replace(/class\s*=(['"])\s*(.*?)\s*\1/,function(e,t,n){return"class="+t+n+t}).replace(/(.+)\s{2,}/g,"$1 ").replace(/\s+>/,">")})};var r={p:"font_8",h1:"font_0",h2:"font_2",h3:"font_3",h4:"font_4",h5:"font_5",h6:"font_6",ol:"font_8",ul:"font_8"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sdkTypeByViewerType={"wysiwyg.viewer.components.SiteButton":"Button","wysiwyg.viewer.components.PopupCloseTextButton":"Button","wysiwyg.viewer.components.PopupCloseIconButton":"Button","wysiwyg.common.components.imagebutton.viewer.ImageButton":"Button","wysiwyg.viewer.components.WPhoto":"Image","wysiwyg.viewer.components.FooterContainer":"Footer","wysiwyg.viewer.components.HeaderContainer":"Header","wysiwyg.viewer.components.WRichText":"Text","mobile.core.components.Page":"Page","wysiwyg.viewer.components.inputs.TextInput":"TextInput","wysiwyg.viewer.components.inputs.TextAreaInput":"TextBox","wysiwyg.viewer.components.inputs.DatePicker":"DatePicker","wysiwyg.viewer.components.BoxSlideShow":"Slideshow","wysiwyg.viewer.components.StripContainerSlideShow":"Slideshow","wysiwyg.viewer.components.SlideShowGallery":"Gallery","wysiwyg.viewer.components.SliderGallery":"Gallery","wysiwyg.viewer.components.MatrixGallery":"Gallery","wysiwyg.viewer.components.PaginatedGridGallery":"Gallery","mobile.core.components.Container":"Box","wysiwyg.viewer.components.Group":"Box","platform.components.AppController":"AppController","wysiwyg.viewer.components.svgshape.SvgShape":"VectorImage","wysiwyg.viewer.components.VectorImage":"VectorImage","wysiwyg.viewer.components.inputs.Checkbox":"Checkbox","wixui.RichTextBox":"RichTextBox","wixui.ToggleSwitch":"Switch","wysiwyg.viewer.components.inputs.RadioGroup":"RadioButtonGroup","wysiwyg.viewer.components.inputs.CheckboxGroup":"CheckboxGroup","wysiwyg.viewer.components.BoxSlideShowSlide":"Slide","wysiwyg.viewer.components.StripContainerSlideShowSlide":"Slide","wysiwyg.viewer.components.inputs.ComboBoxInput":"Dropdown","wysiwyg.viewer.components.Column":"Column","wysiwyg.viewer.components.StripColumnsContainer":"ColumnStrip","wysiwyg.viewer.components.Grid":"Table","wysiwyg.viewer.components.inputs.FileUploader":"UploadButton","wysiwyg.common.components.anchor.viewer.Anchor":"Anchor","wysiwyg.viewer.components.tpapps.TPASection":"IFrame","wysiwyg.viewer.components.tpapps.TPAMultiSection":"IFrame","wysiwyg.viewer.components.tpapps.TPAGluedWidget":"IFrame","wysiwyg.viewer.components.HtmlComponent":"HtmlComponent","wysiwyg.viewer.components.GoogleMap":"GoogleMap","wysiwyg.viewer.components.Video":"Video","wysiwyg.viewer.components.HoverBox":"HoverBox","wysiwyg.viewer.components.Popover":"Popover","tpa.viewer.components.Freestyle":"Gallery","tpa.viewer.components.Honeycomb":"Gallery","tpa.viewer.components.Accordion":"Gallery","wysiwyg.viewer.components.tpapps.TPA3DCarousel":"Gallery","wysiwyg.viewer.components.tpapps.TPA3DGallery":"Gallery","tpa.viewer.components.Impress":"Gallery","tpa.viewer.components.Masonry":"Gallery","tpa.viewer.components.Collage":"Gallery","tpa.viewer.components.StripSlideshow":"Gallery","tpa.viewer.components.StripShowcase":"Gallery","tpa.viewer.components.Thumbnails":"Gallery","wysiwyg.viewer.components.tpapps.TPAWidget":"IFrame","wysiwyg.common.components.verticalmenu.viewer.VerticalMenu":"VerticalMenu","wysiwyg.viewer.components.LoginSocialBar":"AccountNavBar","wysiwyg.viewer.components.Repeater":"Repeater","wysiwyg.viewer.components.MediaContainer":"Container","wysiwyg.viewer.components.mobile.TinyMenu":"MobileMenu","wysiwyg.viewer.components.QuickActionBar":"QuickActionBar","wixui.VideoPlayer":"VideoPlayer","wixui.Pagination":"Pagination","wixui.Tags":"Tags","wixui.Slider":"Slider","wixui.RatingsDisplay":"RatingsDisplay","wixui.RatingsInput":"RatingsInput","platform.components.AppWidget":"AppWidget","native.components.*":"Native"},t.sdkTypeByWidgetId={"142bb34d-3439-576a-7118-683e690a1e0d":"Gallery"},t.defaultSdkType="HiddenCollapsedElement"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,a=!1,i=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{!r&&u.return&&u.return()}finally{if(a)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.generateWixCodeImageUri=function(e){return i(e)},t.generateWixCodeDocumentUri=function(e){return o(e)},t.extractImageRelativeUriFromWixUri=function(e){if(u.test(e)){var t=e.match(u)||[0,0,e],n=r(t,3),a=n[2];return a}return e},t.extractImageDataFromWixUri=function(e){if(u.test(e)){var t=e.match(u)||[0,0,e],n=r(t,6),i=n[2],o=n[3],s=n[4],d=n[5];return a.default.reduce({uri:i,width:o,height:s,title:d},l,{})}return{uri:e}};var a=function(e){return e&&e.__esModule?e:{default:e}}(n(0));var i=a.default.template("image://v1/${uri}/${width}_${height}/${title}"),o=a.default.template("wix:document://v1/${uri}/${filename}"),u=/^image:\/\/(.*)\/(.*)\/(.*)_(.*)\/(.*)/;function l(e,t,n){return t&&(e[n]=t),e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSkinName=function(e){return r.default.get(o,e)||e},t.convertStyleParamForViewerType=function(e,t){var n=r.default.get(i,e),o=n||a;return r.default.get(o,t,t)};var r=function(e){return e&&e.__esModule?e:{default:e}}(n(0));var a={backgroundColor:"bg",borderColor:"brd",borderWidth:"brw",borderRadius:"rd",color:"txt"},i={"wysiwyg.viewer.components.inputs.FileUploader":{backgroundColor:"btn_bg",borderColor:"btn_brd",borderWidth:"btn_brw",borderRadius:"btn_rd",color:"btn_txt"}},o={"skins.input.RadioGroupDefaultSkin":"wysiwyg.common.components.radio.viewer.skins.RadioButtonDefaultSkin"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TypeUtils=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(e){return e&&e.__esModule?e:{default:e}}(n(0));t.TypeUtils=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._typesData=t}return r(e,[{key:"getSdkType",value:function(e,t){var n=this._typesData,r=n.sdkTypeByViewerType,i=n.sdkTypeByWidgetId,o=n.defaultSdkType;return i[t]||r[function(e){return a.default.startsWith(e,"native.components.")?"native.components.*":e}(e)]||o}},{key:"getFullSdkType",value:function(e,t){return"$w."+this.getSdkType(e,t)}},{key:"getPotentialViewerTypes",value:function(e){var t=this._typesData,n=t.sdkTypeByViewerType,r=t.sdkTypeByWidgetId,i=a.default.keys(n).filter(function(t){return n[t]===e});return a.default.includes(a.default.values(r),e)&&i.push("wysiwyg.viewer.components.tpapps.TPAWidget"),i}},{key:"setType",value:function(e,t){this._typesData.sdkTypeByViewerType[e]=t}},{key:"Types",get:function(){var e=this._typesData,t=e.sdkTypeByViewerType,n=e.sdkTypeByWidgetId,r=a.default.uniq(a.default.values(t).concat(a.default.values(n)));return a.default.zipObject(r,r)}},{key:"defaultSdkType",get:function(){return this._typesData.defaultSdkType}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.members=t.contacts=void 0;var r=n(24);t.contacts=r.contacts,t.members=r.members},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(25);t.contacts=r;var a=n(26);t.members=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),a={firstName:{},lastName:{},picture:{schemaKey:"imageUrl"},emails:{},phones:{},labels:{}};t.serializeContactInfo=function(e){return r.reduce(e,function(e,t,n){var i=a[n];if(i)return e[i.serviceKey||n]=t,e;var o,u="strValue";return r.isDate(t)?u="dateValue":r.isNumber(t)&&(u="numValue"),e.customFields.push(((o={name:n})[u]=t,o)),e},{customFields:[]})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.serializeMemberRoles=function(e){return r.map(e&&e.groups,function(e){return{name:e.title,description:e.description}})}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.types=t.errors=t.parseMediaSrc=t.createMediaSrc=t.isValidMediaSrc=void 0;var a=function(e){return e&&e.__esModule?e:{default:e}}(n(0)),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(9));function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=i.errors,l=i.types,s={externalUrl:/(^https?)|(^data)|(^blob)|(^\/\/)/,inlineSvg:/<svg[\s\S]*>[\s\S]*<\/svg>/im},d=(o(r={},i.types.VECTOR,[s.externalUrl,s.inlineSvg]),o(r,i.types.IMAGE,[s.externalUrl]),o(r,i.types.DOCUMENT,[]),o(r,i.types.VIDEO,[]),r);t.isValidMediaSrc=function(e,t){if(i.isValidMediaItemUri(e,t))return!0;var n=d[t];return a.default.some(n,function(t){return t.test(e)})},t.createMediaSrc=function(e){var t=e.mediaId,n=e.type,r=e.title,o=e.width,u=e.height,l=e.posterId,s=e.watermark,c=d[n];return a.default.some(c,function(e){return e.test(t)})?{item:t}:i.createMediaItemUri({mediaId:t,type:n,title:r,width:o,height:u,posterId:l,watermark:s})},t.parseMediaSrc=function(e,t){if(!a.default.includes(l,t))return{error:u.unknown_media_type};var n=d[t];if(a.default.some(n,function(t){return t.test(e)}))return{type:t,mediaId:e};var r=i.parseMediaItemUri(e);return r.error===u.non_string_media_id?r:r.error===u.unknown_media_type||t!==r.type?{error:u.bad_media_id}:r},t.errors=u,t.types=l}])});
//# sourceMappingURL=platformUtils-bundle.js.map