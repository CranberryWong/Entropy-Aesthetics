!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("lodash"),require("coreUtilsLib"),require("platformUtils"),require("prop-types"),require("mobx")):"function"==typeof define&&define.amd?define(["lodash","coreUtilsLib","platformUtils","prop-types","mobx"],t):"object"==typeof exports?exports["host-platform-api"]=t(require("lodash"),require("coreUtilsLib"),require("platformUtils"),require("prop-types"),require("mobx")):e["host-platform-api"]=t(e.lodash,e.coreUtilsLib,e.platformUtils,e["prop-types"],e.mobx)}(this,function(e,t,n,r,o){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=17)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t,n){"use strict";var r=n(0),o=n(18),i=n(1),a=n(3),s=o.RemoteModelInterface,d=o.RemoteGlobalsInterface,u=o.componentsHooks,c=function(e,t,n,o){if(r.isFunction(e.getPlatformModels)){var i=e.getPlatformModels(n);return{components:i.components,connections:i.connections}}return{components:t.reduce(function(t,r){return t[r]=a.getCompModel(e,r,n,o),t},{}),connections:a.getConnectionsModel(e,t,n)}};e.exports={generateRemoteModelInterface:function(e,t,n,o,a,d,p,l){var f=new s(void 0,d);f.registerHook(f.getHooks().data,"wysiwyg.viewer.components.Repeater",u.repeaters.updateRepeaterItems);var g=c(e,t,p,l),m=g.components,h=g.connections;return r.forEach(t,function(e){return f.addComponent(e,m[e])}),f.addSiteStructure(n),f.addPageData(o),f.addConnections(h),f.resetComponentsScope(),f.addEventTypes(i.siteConstants.ACTION_TYPES),f.updateWidgetProperties(a),f},createRemoteModelInterface:function(e,t){var n=new s(e,t);return n.registerHook(n.getHooks().data,"wysiwyg.viewer.components.Repeater",u.repeaters.updateRepeaterItems),n},generateRemoteGlobalsInterface:function(e,t,n,r,o,i,a,s,u){var c=new d;return c.addNavigation(e),c.addSiteMemberData(n),c.addMultilingualInfo(r),c.addAppsData(o),c.addSessionInfoProp(t),c.addDeviceType(a),c.addLightboxContext(s),c.addContextId(u),c.addIsApplicationStudio(i),c}}},function(e,t,n){"use strict";var r=n(0),o=n(1),i="wysiwyg.viewer.components.BoxSlideShowSlide",a="wysiwyg.viewer.components.StripContainerSlideShowSlide",s="wysiwyg.viewer.components.Repeater";function d(e,t,n,o,i){var a={data:e.getCompData(t,i),fullData:e.getCompData(t,!0),props:e.getCompProps(t,i)},s=e.getCompState(t);return r.isUndefined(s)||r.isEmpty(s)?function(e,t,n){var r=n(t);return r&&r.publicState?r.publicState(null,e):{}}(a,n,o):s}function u(e,t,n){var r=e.getParentId(t),o=e.getCompStructure(r),i=o&&d(e,r,o.componentType,n);return o&&i&&o.components[i.currentIndex]}e.exports={getCompModel:function(e,t,n,c){var p=e.getCompType(t),l=function(e,t){return e.getAncestorOfType(t,s)}(e,t),f=function(e,t){return!o.displayedOnlyStructureUtil.isDisplayedComponent(e)&&t}(t,!!l),g=d(e,t,p,c,f),m=e.getActionsAndBehaviors(t),h=o.displayedOnlyStructureUtil.isDisplayedComponent(t);return{parent:e.getParentId(t),type:p,state:g,layout:e.getCompLayout(t),design:e.getCompDesign(t,f),isDisplayed:function(e,t,n){for(var r=t;r;){var o=e.getCompType(r);if(o===i||o===a){var s=r,d=u(e,r,n);return s===d}r=e.getParentId(r)}return e.isDisplayed(t)}(e,t,c),id:e.getCompName(t),data:e.getCompData(t,f),style:e.getCompStyle(t),fullData:e.getCompData(t,!0),props:e.getCompProps(t,f),children:e.getChildrenIds(t),events:r.map(m,function(e){return r.assign({eventType:r.get(e,"action.name")},r.get(e,"behavior.params"))}),displayedRoot:h&&l?r.get(l,"id"):null,displayedOnlyComponents:h?[]:r.map(e.getDisplayedOnlyCompsForFullComp(t,n),"id")}},getConnectionsModel:function(e,t,n){var o=function(e,t,n){return r.reduce(e,function(e,o){var i=t.getCompConnections(o),a=r.map(i,function(e){return{connection:"WixCodeConnectionItem"===e.type?r.assign({},e,{controllerId:n,config:null}):r.defaults({},e,{config:null}),compId:o}});return e.concat(a)},[])}(t,e,n);return r(o).groupBy("connection.controllerId").mapValues(function(e){return r(e).groupBy("connection.role").mapValues(function(e){return r(e).keyBy("compId").mapValues("connection.config").value()}).value()}).value()}}},function(e,t,n){"use strict";var r=n(0),o={PAGE:"Page",POPUP:"Popup",UNKNOWN:"Unknown"};var i=["Page","AppPage"];e.exports={getApi:function(e){return{RMI:{fetchData:e.getDataByQuery.bind(e),fetchSiteStructure:e.getSiteStructureForRmi.bind(e),fetchPageData:e.getPageDataForRmi.bind(e),fetchWidgetData:e.getAppStudioWidgetProperties.bind(e)},RGI:{fetchNavigationData:e.getNavigationDataForRgi.bind(e),fetchSessionInfo:e.getSessionInfoForRgi.bind(e),fetchDeviceType:e.getDeviceTypeForRgi.bind(e),fetchSiteMemberData:e.getSMbySiteExtensionInstanceForRgi.bind(e),fetchMultilingualInfo:e.getMultilingualInfoForRgi.bind(e),fetchAppsData:e.getAppsDataForRgi.bind(e),fetchIsApplicationStudio:e.isApplicationStudio.bind(e)}}},getWidgetType:function(e){return r.includes(i,r.get(e,"type"))?r.get(e,"isPopup")?o.POPUP:o.PAGE:o.UNKNOWN},WIDGET_TYPES:o}},,,,,function(e,t,n){"use strict";var r=n(0),o=n(1);function i(e,t,n,o){var i=e.filterValidContextsForLoad,a=void 0===i?r.identity:i,u=e.filterContextsToSync,c=void 0===u?r.identity:u,p=e.filterContextsToActivate,l=void 0===p?r.identity:p,f=e.getContextInitData,g=e.getApplicationsForContexts,m=g(n=c(n));if(r.isEmpty(m))return t;var h=r.difference(n,r.map(t,"rootId"));h=l(h),t=function(e,t,n,o,i,a){return r.isEmpty(t)||(i=s(n,i,e,a),r.isEmpty(i)||d(t,a,o)),i}(a(n),h,g,f,t,o);var v=r(t).reject({started:!0}).map("rootId").value();return r.isEmpty(v)?t:(o.startWidgets(v),t=function(e,t){return r.map(e,function(e){return r.includes(t,e.rootId)?r.assign(e,{started:!0}):e})}(t,v))}function a(e,t,n){return r.isEmpty(t)||r.isEmpty(e)?e:(n.stopWidgets(t),r.reject(e,function(e){return r.includes(t,e.rootId)}))}function s(e,t,n,o,i){if(r(n).difference(r.map(t,"rootId")).thru(r.isEmpty).value())return t;var a=e(n);if(r.isEmpty(a))return t;o.loadWidgets(a,n,i);var s=r.map(n,function(e){return{rootId:e}});return t.concat(s)}function d(e,t,n){var i=r.without(e,o.siteConstants.MASTER_PAGE_ID),a=r(i).transform(function(e,t){e[t]=n(t)},{}).omitBy(r.isEmpty).value();r.isEmpty(a)||t.initWidgets(a)}e.exports={syncAppsState:function(e,t,n,o){var s=t.getContextIdsWhichShouldBeRendered,d=t.filterValidContextsForLoad,u=t.filterContextsToSync,c=t.filterContextsToActivate,p=t.getContextInitData,l=t.getApplicationsForContexts,f=s();return e?i({filterValidContextsForLoad:d,filterContextsToSync:u,filterContextsToActivate:c,getContextInitData:p,getApplicationsForContexts:l},n=a(n,function(e,t){var n=r.reject(e,function(e){return r.includes(t,e.rootId)});return r.map(n,"rootId")}(n,f),o),f,o):a(n,f,o)},loadApps:s,initApps:d,stopApps:function(e,t,n,o){var i=function(e,t){var n=r.filter(e,function(e){return r.includes(t,e.rootId)});return r.map(n,"rootId")}(e,t);return r(o()).intersection(i).thru(r.isEmpty).value()?e:a(e,i,n)},triggerAppStudioWidgetOnPropsChanged:function(e,t,n,r){r.triggerAppStudioWidgetOnPropsChanged(e,t,n)}}},function(e,t,n){"use strict";var r=n(0),o=n(1),i=n(2),a=n(4),s=o.siteConstants;function d(e,t){var n=[s.PAGES_CONTAINER_ID,s.SITE_PAGES_ID],o=t(e,e);return r(o).omit([s.SITE_STRUCTURE_ID]).keys().difference(n).value()}function u(e,t,n){var i=o.siteConstants.MASTER_PAGE_ID,s=d(i,t),u=r.without(e,i);return r.transform(u,function(e,r){e[r]=d(r,t),function(e,t){var n=t(e,e);return a.getWidgetType(n)===a.WIDGET_TYPES.PAGE}(r,n)&&(e[r]=e[r].concat(s))},{})}e.exports={build:function(e,t,n,o,a,s,d){d.mark("build RMI model start");var c=function(e,t,n,o,a,s,d){return r.mapValues(t,function(t,r){return i.generateRemoteModelInterface(e,t,o(),a(),s(r),n,r,d)})}(e,u(n,a,t.RMI.fetchData),o,t.RMI.fetchSiteStructure,t.RMI.fetchPageData,t.RMI.fetchWidgetData,s);return d.mark("build RMI model end"),d.measure("build RMI model","build RMI model start","build RMI model end"),c},attach:function(e,t,n){return r.forEach(t,function(t){e[t]._onUpdateCallback=n}),e}}},function(e,t,n){"use strict";var r=n(0),o=n(2);e.exports={build:function(e,t,n,i){var a=e.RGI.fetchNavigationData(t,r.get(i,"pageInfo")),s=e.RGI.fetchSessionInfo(),d=e.RGI.fetchSiteMemberData(),u=e.RGI.fetchMultilingualInfo(),c=e.RGI.fetchAppsData(),p=e.RGI.fetchDeviceType(),l=e.RGI.fetchIsApplicationStudio();return o.generateRemoteGlobalsInterface(a,s,d,u,c,l,p,r.get(i,"lightboxContext"),n)}}},function(e,t,n){"use strict";e.exports={setBootstrapParametersMessage:function(e){return{intent:"WIX_CODE",type:"wix_code_iframe_set_bootstrap_parameters",parameters:e}},loadWidgetsMessage:function(e,t,n,r){return{type:"load_widgets",sdkParameters:{referrer:"undefined"==typeof window?"":window.document.referrer},widgets:e,rootIds:n,routersMap:t||{},rgisByRootId:r}},loadUserCodesMessage:function(e,t){return{type:"load_user_code",widgets:e,rootIds:t}},initWidgetsMessage:function(e){return{type:"init_widgets",contexts:e}},startWidgetsMessage:function(e){return{type:"start_widgets",contexts:e}},stopWidgetsMessage:function(e){return{type:"stop_widgets",widgetIds:e}},updateWidgetMessage:function(e,t){return{type:"update",contextId:e,updates:t}},updateSiteMemberData:function(e,t){return{contextId:e,type:"update_site_member",updates:t}},updateMultilingualInfo:function(e,t){return{contextId:e,type:"update_multilingual_info",updates:t}},updateSessionInfo:function(e,t){return{contextId:e,type:"update_session_info",updates:t}},updateaNavigation:function(e,t){return{contextId:e,type:"update_navigation",updates:t}},triggerOnRenderMessage:function(e){return{intent:"WIX_CODE",type:"trigger_onRender",contextId:e}},triggerUserFunctionMessage:function(e,t,n){return{intent:"WIX_CODE",type:"wix_code_run_user_function",contextId:e,callbackId:t.callbackId,compId:t.compId,event:n}},updateWixCodeModelDataAfterLoginMessage:function(e,t){return{type:"update_wix_code_model_data_after_login",rootIds:t,widgets:e}},updateAppsData:function(e,t){return{contextId:e,type:"update_apps_data",updates:t}},stopMessage:function(e){return{contextId:e,type:"stop"}},isStopMessage:function(e){return"stop"===e.type},triggerAppStudioWidgetOnPropsChanged:function(e,t,n){return{contextId:e,type:"trigger_app_studio_widget_on_props_changed",oldProps:t,newProps:n}},invokeWorkerSubscribersMessage:function(e,t,n){return{type:"invoke_worker_subscribers",contextId:e,appDefId:t,data:n}}}},,,,,function(e,t,n){"use strict";var r=n(2),o=n(19),i=n(10),a=n(11),s=n(4),d=n(28),u=n(29),c=n(12),p=n(3),l=n(9);e.exports={wixCodeRemoteModelService:r,messageBuilder:c,modelBuilder:i,globalsBuilder:a,widgetModel:p,widgetBehaviorHandler:d,widgetBehaviorPreprocessor:u,WidgetAspect:o,modelBuilderDataHelper:s,widgetService:l}},function(e,t){e.exports=n},function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=n(0),i=n(1),a=n(20),s=n(9),d=n(21),u=n(3),c=n(4),p=n(23),l=new WeakMap;function f(e,t,n){var r=l.get(this),o=new d(e,t,n);return r.widgetHandler=o,l.set(this,r),o}var g=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{on:o.noop},i=arguments[3],a=arguments[4],s=arguments[5],d=arguments[6];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),l.set(this,{storageAPI:n,eventsManager:r,runtimeDal:i,actionQueue:a,wixCodeAppApi:s,aspectProps:t,updateSiteCallBacks:[],onWidgetReady:{},updating:!1,widgetHandler:{},contextIdsToIgnore:[]}),n.set("loadedAppsRoots",[]),r.on("runtimeCompChange",function(e,t){var n=l.get(this),r=o.zipObject([{dataChange:"data",propsChange:"props",stateChange:"state",layoutChange:"layout"}[t.type]],[t.value]),i=o.zipObject([e],[r]);n.widgetHandler.handleWidgetUpdate(i)}.bind(this));var u={runtimeDal:i,actionQueue:a,wixCodeAppApi:s,storageAPI:n,aspectProps:t};d?f.call(this,u,o.noop,this.flushWidgetReady.bind(this)):f.call(this,u,this.updateSite.bind(this),this.flushWidgetReady.bind(this))}return r(e,[{key:"onHostPropsChanged",value:function(e){l.get(this).aspectProps=e}},{key:"updateSite",value:function(e){var t=l.get(this);e&&t.updateSiteCallBacks.push(e),t.updating||(t.updating=!0,i.animationFrame.request(function(){o.invokeMap(t.updateSiteCallBacks,o.call),t.updating=!1,t.updateSiteCallBacks=[]}))}},{key:"allContextsReady",value:function(){var e=this,t=l.get(this).storageAPI.get("loadedAppsRoots");return o(t).map("rootId").every(function(t){return e.isContextReady(t)})}},{key:"isContextReady",value:function(e){var t=l.get(this);if(t.aspectProps.isFirstRenderAfterSSR())return!0;var n=t.aspectProps.getAllPossiblyRenderedContexts(),r=t.storageAPI.get("loadedAppsRoots"),a=o.map(r,"rootId"),s=function(e,t){var n=l.get(this);return e!==i.siteConstants.MASTER_PAGE_ID?e:o.find(t,function(e){var t=n.aspectProps.getDataByQuery(e);return c.getWidgetType(t)===c.WIDGET_TYPES.PAGE})}.call(this,e,a);return!(!o.isEmpty(r)&&o.includes(n,e))||o.includes(a,s)&&t.widgetHandler.isWidgetReady(s)}},{key:"loadApps",value:function(e,t){var n=l.get(this),r=n.storageAPI.get("loadedAppsRoots");n.storageAPI.set("loadedAppsRoots",s.loadApps(n.aspectProps.getApplicationsForContexts,r,e,n.widgetHandler,t))}},{key:"triggerAppStudioWidgetOnPropsChanged",value:function(e,t,n){var r=l.get(this);s.triggerAppStudioWidgetOnPropsChanged(e,t,n,r.widgetHandler)}},{key:"initApps",value:function(e){var t=l.get(this);t.aspectProps.initWixCode&&s.initApps(e,t.widgetHandler,t.aspectProps.getContextInitData)}},{key:"startApps",value:function(e){l.get(this).widgetHandler.startWidgets(e)}},{key:"stopApps",value:function(e){var t=l.get(this),n=t.storageAPI.get("loadedAppsRoots");t.storageAPI.set("loadedAppsRoots",s.stopApps(n,e,t.widgetHandler,t.aspectProps.getAllRenderedContextIds))}},{key:"restartApps",value:function(){var e=l.get(this).storageAPI.get("loadedAppsRoots");if(!o.isEmpty(e)){var t=o.map(e,"rootId");this.stopApps(t),this.loadApps(t),this.initApps(t)}}},{key:"registerToOnWidgetReady",value:function(e,t){if(o.isFunction(t))if(this.isContextReady(e))t();else{var n=l.get(this);n.onWidgetReady[e]||(n.onWidgetReady[e]=[]),n.onWidgetReady[e].push(t)}}},{key:"flushWidgetReady",value:function(e){var t=l.get(this),n=t.onWidgetReady[e];o.forEach(n,function(e){e()}),delete t.onWidgetReady[e]}},{key:"syncAppsState",value:function(e){var t=l.get(this),n=o.pick(t.aspectProps,["getContextIdsWhichShouldBeRendered","filterValidContextsForLoad","filterContextsToSync","filterContextsToActivate","getContextInitData","getApplicationsForContexts"]);return e=e||t.storageAPI.get("loadedAppsRoots"),e=o.reject(e,function(e){return o.includes(t.contextIdsToIgnore,e.rootId)}),e=s.syncAppsState(t.aspectProps.initWixCode,n,e,t.widgetHandler),t.storageAPI.set("loadedAppsRoots",e),e}},{key:"getWidgetHandler",value:function(){return l.get(this).widgetHandler}},{key:"getLoadedAppsContexts",value:function(){return l.get(this).storageAPI.get("loadedAppsRoots")}},{key:"getCompModel",value:function(e,t,n){var r=l.get(this);return u.getCompModel(e,t,n,r.aspectProps.getCompReactClass)}},{key:"setContextIdToIgnore",value:function(e){var t=l.get(this);t.contextIdsToIgnore=o.union(t.contextIdsToIgnore,[e]),l.set(this,t)}},{key:"removeContextIdToIgnore",value:function(e){var t=l.get(this);t.contextIdsToIgnore=o.filter(t.contextIdsToIgnore,function(t){return t!==e}),l.set(this,t)}}]),e}();g.hostPropTypes={isMobileView:a.bool.isRequired,currentUrlPageId:a.string,isExperimentOpen:a.func.isRequired,initWixCode:a.bool.isRequired,isViewerMode:a.bool.isRequired,handleProcessedBehavior:a.func.isRequired,refreshRenderedContextsData:a.func.isRequired,getDataByQuery:a.func.isRequired,shouldUpdateRuntimeModels:a.func.isRequired,componentsFetcher:a.func.isRequired,RMIDataAPI:a.shape({RMI:a.shape({fetchData:a.func.isRequired,fetchSiteStructure:a.func.isRequired,fetchPageData:a.func.isRequired}),RGI:a.shape({fetchNavigationData:a.func,fetchSessionInfo:a.func,fetchSiteMemberData:a.func,fetchMultilingualInfo:a.func,fetchDeviceType:a.func.isRequired,fetchAppsData:a.func.isRequired})}).isRequired,resolveWidgetData:a.func.isRequired,routers:a.object.isRequired,setWarmupDataForController:a.func.isRequired,getRuntimeModels:a.func.isRequired,isFirstRenderAfterSSR:a.func.isRequired,getNavigationDataForRgi:a.func.isRequired,getSMbySiteExtensionInstanceForRgi:a.func.isRequired,getAppsDataForRgi:a.func.isRequired,getAllPossiblyRenderedContexts:a.func.isRequired,getApplicationsForContexts:a.func.isRequired,filterContextsToSync:a.func,filterValidContextsForLoad:a.func,filterContextsToActivate:a.func,getContextInitData:a.func.isRequired,getContextIdsWhichShouldBeRendered:a.func,getCompReactClass:a.func,performanceLogger:a.shape({mark:a.func,measure:a.func}),getAllRenderedContextIds:a.func.isRequired},g.modelBuilderDataHelper=c,g.widgetDataResolvers=p,e.exports=g},function(e,t){e.exports=r},function(e,t,n){"use strict";var r=n(0),o=n(22),i=n(1),a=n(10),s=n(11),d=n(12),u="stateChanged",c="dataChanged",p="designChanged",l="propsChanged",f="registerEvent",g="layoutChanged",m="executeBehavior",h="styleChanged",v="executeBatch",y="widget_ready",I="wix_code_warmup_data";function b(e,t,n,o){var i={data:this._runtimeDal.setCompData.bind(this._runtimeDal),style:this._runtimeDal.updateCompStyle.bind(this._runtimeDal),design:this._runtimeDal.setCompDesign.bind(this._runtimeDal),props:this._runtimeDal.setCompProps.bind(this._runtimeDal),layout:this._runtimeDal.updateCompLayout.bind(this._runtimeDal),registerEvent:this._runtimeDal.registerComponentEvent.bind(this._runtimeDal)};e?i[t](e,n):i[t](n),r.isFunction(this._onUpdateCallback)&&this._onUpdateCallback(o)}function A(e){if(!this._isFlushingPendingCommands){var t=this;this._isFlushingPendingCommands=!0,e?n():i.animationFrame.request(n)}function n(){t._isFlushingPendingCommands=!1,t._actionQueue.flush(),function(e){r.forEach(e,function(e){return e()})}(t._commandsFlushListeners),t._aspectProps.refreshRenderedContextsData()}}function _(e,t,n){this._runtimeDal=e.runtimeDal,this._wixCodeAppApi=e.wixCodeAppApi,this._remoteModelInterfaces={},this._remoteGlobalsInterfaces={},this._onUpdateCallback=t,this._receivedChanges=void 0,this._isFlushingPendingCommands=!1,this._commandsFlushListeners=[],this._actionQueue=e.actionQueue,this._storageAPI=e.storageAPI,this._flushWidgetReady=n,this._aspectProps=e.aspectProps,this._widgetsLoaded=!1}function S(e,t){this._storageAPI.set(e+"_widgetState",t)}function C(e,t,n){var o=r.assign({},e.getCompData(t),n),i=e.getCompProps(t);return this._aspectProps.resolveWidgetData(o,{compProps:i,compId:t})}_.prototype.initWidgets=function(e){var t=d.initWidgetsMessage(e);this._sendMessage(t)},_.prototype.startWidgets=function(e){if(!r.isEmpty(e)){r.assign(this._remoteModelInterfaces,function(e){if(this._aspectProps.shouldUpdateRuntimeModels())return a.attach(this._aspectProps.getRuntimeModels(),e,b.bind(this));var t=this._aspectProps.RMIDataAPI;return a.build(this._runtimeDal,t,e,b.bind(this),this._aspectProps.componentsFetcher,this._aspectProps.getCompReactClass,this._aspectProps.performanceLogger)}.call(this,e));var t=r.mapValues(this._remoteModelInterfaces,function(e){return e.toJson()}),n=d.startWidgetsMessage(r.pick(t,e));this._sendMessage(n)}},_.prototype.loadUserCode=function(e,t){var n=d.loadUserCodesMessage(e,t);this._sendMessage(n)},_.prototype.updateWixCodeModelDataAfterLogin=function(e,t){var n=d.updateWixCodeModelDataAfterLoginMessage(e,t);this._sendMessage(n)},_.prototype.loadWidgets=function(e,t,n){var o=this;this.loadUserCode(e,t);var i=r(t).transform(function(e,t){e[t]=o._runtimeDal.getPopupContext(t)},{}).omitBy(r.isUndefined).value();this._widgetsLoaded=!0,r.assign(this._remoteGlobalsInterfaces,function(e,t,n){var o=r.keyBy(t,"pageId"),i=this._aspectProps.RMIDataAPI;return r.transform(e,function(e,t){e[t]=s.build(i,!1,t,{pageInfo:o[t],lightboxContext:n[t]})},{})}.call(this,t,n,i));var a=r.mapValues(this._remoteGlobalsInterfaces,function(e){return e.toJson()}),u=d.loadWidgetsMessage(e,this._aspectProps.routers,t,a);this._sendMessage(u)},_.prototype.getActiveWidgetIds=function(){return r.keys(this._remoteModelInterfaces)},_.prototype.stopWidgets=function(e){var t=this;if(!r.isEmpty(e)){r.forEach(e,function(e){delete t._remoteModelInterfaces[e],delete t._remoteGlobalsInterfaces[e],S.call(t,e,!1)});var n=d.stopWidgetsMessage(e);this._sendMessage(n)}},_.prototype.stopAllWidgets=function(){this.stopWidgets(r.keys(this._remoteModelInterfaces))},_.prototype.updateComponent=function(e,t){this._sendMessage(e,t)},_.prototype.invokeWorkerSubscribers=function(e,t,n){this._sendMessage(d.invokeWorkerSubscribersMessage(e,t,n))},_.prototype.handleWidgetUpdate=function(e){var t=r(e).keys().head(),n=r.pickBy(this._remoteModelInterfaces,function(e){return r.has(e.toJson(),["components",t])}),o=r.find(r.find(e));if(!r.isEmpty(n)&&!r.isEqual(this._receivedChanges,o)){var i=r(n).keys().head();n[i].updateModel(e);var a=d.updateWidgetMessage(i,e);this._sendMessage(a)}},_.prototype.handleSiteMemberUpdate=function(e){var t=this;if(!this._widgetsLoaded){var n=d.updateSiteMemberData(this._aspectProps.currentUrlPageId,e);this._sendMessage(n)}r.forEach(this._remoteGlobalsInterfaces,function(n,r){n.addSiteMemberData(e);var o=d.updateSiteMemberData(r,e);t._sendMessage(o)})},_.prototype.handleMultilingualInfoUpdate=function(e){var t=this;r.forEach(this._remoteGlobalsInterfaces,function(n,r){n.addMultilingualInfo(e);var o=d.updateMultilingualInfo(r,e);t._sendMessage(o)})},_.prototype.triggerAppStudioWidgetOnPropsChanged=function(e,t,n){var r=this._remoteModelInterfaces[e];r&&r.updateWidgetProperties(n);var o=d.triggerAppStudioWidgetOnPropsChanged(e,t,n);this._sendMessage(o)},_.prototype.handleAppDataUpdate=function(e){var t=this;r.forEach(this._remoteGlobalsInterfaces,function(n,r){n.addAppsData(e);var o=d.updateAppsData(r,e);t._sendMessage(o)})},_.prototype.handleSvSessionUpdate=function(e){var t=this;if(!this._widgetsLoaded){var n=d.updateSessionInfo(this._aspectProps.currentUrlPageId,{svSession:e});this._sendMessage(n)}r.forEach(this._remoteGlobalsInterfaces,function(n,r){n.addSessionInfoProp(e);var o=d.updateSessionInfo(r,{svSession:e});t._sendMessage(o)})},_.prototype.handleLocationUpdate=function(e){var t=this;r.forEach(this._remoteGlobalsInterfaces,function(n,r){n.addNavigation(e);var o=d.updateaNavigation(r,e);t._sendMessage(o)})},_.prototype.handleRemoteMessage=function(e){var t=this;switch(e.type){case y:(function(e){return this._remoteModelInterfaces[e]}).call(this,e.widgetId)&&o.runInAction(function(){S.call(t,e.widgetId,!0),A.call(t,!0),t._flushWidgetReady(e.widgetId)});break;case I:var n=r.get(e.data,"controllerId"),i=r.get(e.data,"data");this._aspectProps.setWarmupDataForController(n,i)}},_.prototype.onCommand=function(e,t){(function e(t,n){this._actionQueue.addItem(function(){this.isWidgetReady(t.contextId)?this.handleCommand(t,n):e.call(this,t,n)}.bind(this))}).call(this,e,t),this.isWidgetReady(e.contextId)&&A.call(this,e.command===f)},_.prototype.handleCommand=function(e,t){this._receivedChanges=e.data;var n=this._remoteModelInterfaces[e.contextId];if(n){switch(e.command){case v:e.data=function(e,t){var n=this;return r.assign({},r.mapValues(t,function(t,o){return t.data?r.assign(t,{data:C.call(n,e,o,t.data)}):t}))}.call(this,this._runtimeDal,e.data),n.setBatchData(e.data);break;case u:n.setState(e.compId,e.data);break;case c:e.data=C.call(this,this._runtimeDal,e.compId,e.data),n.setData(e.compId,e.data);break;case p:n.setDesign(e.compId,e.data);break;case g:n.setLayout(e.compId,e.data);break;case l:n.setProps(e.compId,e.data,t);break;case f:n.registerEvent(e.contextId,e.compId,e.data.eventType,e.data.callbackId);break;case h:n.setStyle(e.compId,e.data);break;case m:var o=e.data,i={group:"command",callback:t};this._aspectProps.handleProcessedBehavior(o,i)}this._receivedChanges=void 0}},_.prototype.handleEvent=function(e,t,n,o){var i=void 0;switch(t){case"runCode":i=d.triggerUserFunctionMessage(e,n,function(e){var t=r.merge(r.pick(e,"item"),r.pickBy(e,r.negate(r.isObject)));return t.nativeEvent=r.pickBy(e.nativeEvent,r.negate(r.isObject)),e.data&&(t.data=e.data),t}(o));break;case"onRendered":i=d.triggerOnRenderMessage(e)}this._sendMessage(i)},_.prototype.isWidgetReady=function(e){return!!function(e){return this._storageAPI.get(e+"_widgetState")}.call(this,e)},_.prototype._sendMessage=function(e,t){this._wixCodeAppApi.sendMessage(e,t)},_.prototype.getPostMessageTarget=function(e){var t=this._wixCodeAppApi;return this._aspectProps.isExperimentOpen("wixCodeNoIframe")&&this._aspectProps.isViewerMode?t.getWorkerById(e):t.getAppsIframe()},_.prototype.registerCommandsFlushedListener=function(e){if(!r.isFunction(e))throw new TypeError("The callback provided is not a function.");this._commandsFlushListeners.push(e)},e.exports=_},function(e,t){e.exports=o},function(e,t,n){"use strict";var r=n(0),o=[n(24),n(25),n(26)];e.exports={resolve:function(e,t,n){return r.forEach(o,function(r){e=r.resolve(e,t,n)}),e}}},function(e,t,n){"use strict";var r=n(0);e.exports={resolve:function(e,t,n){var o=n.compProps,i=t.getSiteData(),a=void 0;return a="Grid"===e.type?function(e,t){var n=r.reduce(t.columns,function(e,t){return t.linkPath&&e.push(t.linkPath),e},[]),o=[];return n.length>0&&r.forEach(e.rows,function(e){r.forEach(n,function(t){var n=t+"_linkObj",i=r.get(e,n);r.isUndefined(i)||o.push(i)})}),o}(e,o):function e(t){var n=[],o=r.get(t,"link");o&&n.push(o);var i=r.get(t,"linkList");return i&&(n=n.concat(i)),r.forEach(t,function(t){r.isObject(t)&&(n=n.concat(e(t)))}),n}(e),r.forEach(a,function(e){var t=e.type,n=e.pageId;if(("PageLink"===t||"AnchorLink"===t)&&r.isString(n)){var o=function(e,t){var n=r.compact(e.replace(/^#/,"").split("/")),o=r.findKey(t.getRouters(),{prefix:n[0]});return o?{type:"DynamicPageLink",routerId:o,innerRoute:n.slice(1).join("/")}:null}(e.pageId,i);o?(r.assign(e,o),delete e.pageId):e.pageId=function(e,t){if("#"===e)return"#"+t.getMainPageId();var n=t.findDataOnMasterPageByPredicate(function(t){return t.pageUriSEO===e.replace("#","")}),o=r.get(n,"id",e);return r.startsWith(o,"#")?o:"#"+o}(n,i)}}),e}}},function(e,t,n){"use strict";var r=n(0),o="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";function i(e){return e.uri?e:r.assign({},e,{uri:o})}e.exports={resolve:function(e){return"Image"===e.type?i(e):"ImageList"===e.type?r.assign({},e,{items:e.items&&e.items.map(i)}):e}}},function(e,t,n){"use strict";var r=n(1),o=n(27),i=r.svgUtils,a=r.guidUtils,s=r.requestsUtil,d=i.SOURCE_TYPES,u=i.EMPTY_SVG_ID,c=i.EMPTY_SHAPE,p=i.getSourceType,l=a.nameUUIDFromString,f={method:"GET",headers:{"content-type":"text/plain"},mode:"cors"};function g(e){var t=o.sanitizeSVG(e),n=t.svg,r=t.error;return n||(console.warn(r),c)}e.exports={resolve:function(e,t,n){var r=n.compId;if("VectorImage"!==e.type||!e.hasOwnProperty("svgSrc"))return e;var o=e.svgSrc;switch(p(o)){case d.WIX_MEDIA_ID:return{svgId:o,svgSrc:o};case d.EMPTY:return{svgId:u,svgSrc:o};case d.URL:return function(e,t,n){var r=l(t),o=e.getPointers(),i=e.getDisplayedDAL(),a=e.getRuntimeDal(),d=o.svgShapes.getSvgShapePointer(r);return i.get(d)?{svgId:r,svgSrc:t}:(s.fetch(t,f).then(function(o){return o.text().then(function(o){i.set(d,e.getSvgStringToStoreData(g(o)));var s=a.getCompData(n).svgSrc;t===s&&a.setCompData(n,{svgId:r,svgSrc:t})})}).catch(function(){var e=a.getCompData(n).svgSrc;t===e&&a.setCompData(n,{svgId:u,svgSrc:t})}),{svgSrc:t})}(t,o,r);case d.INLINE:return function(e,t){var n=l(t),r=e.getPointers(),o=e.getDisplayedDAL(),i=r.svgShapes.getSvgShapePointer(n);return o.get(i)||o.set(i,e.getSvgStringToStoreData(g(t))),{svgId:n,svgSrc:t}}(t,o)}return e}}},function(e,t,n){e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";var r=n(1);e.exports=r},function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(2),i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"sanitizeSVG",value:function(e){o.addHook("afterSanitizeAttributes",function(e){e.hasAttribute("xlink:href")&&!e.getAttribute("xlink:href").match(/^#/)&&e.remove()});var t=o.sanitize(e,{RETURN_DOM_FRAGMENT:!0,KEEP_CONTENT:!1,USE_PROFILES:{svg:!0,svgFilters:!0},ADD_TAGS:["use"]});o.removeHook("afterSanitizeAttributes");var n=t.querySelector("svg");if(!n)return{error:""};n.setAttribute("data-type","ugc");var r=this.validateSVG(n);return r?{error:r}:{svg:n.outerHTML}}},{key:"validateSVG",value:function(e){var t=e.getAttribute("width"),n=e.getAttribute("height");return e.getAttribute("viewBox")||t&&n?null:"SVG does not have viewBox nor width and height"}}]),e}();e.exports=new i},function(e,t,n){e.exports=function(){"use strict";var e=["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"],t=["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","audio","canvas","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","video","view","vkern"],n=["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"],r=["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmuliscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mpspace","msqrt","mystyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"],o=["#text"],i=["accept","action","align","alt","autocomplete","background","bgcolor","border","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","coords","crossorigin","datetime","default","dir","disabled","download","enctype","face","for","headers","height","hidden","high","href","hreflang","id","integrity","ismap","label","lang","list","loop","low","max","maxlength","media","method","min","multiple","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","type","usemap","valign","value","width","xmlns"],a=["accent-height","accumulate","additivive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"],s=["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"],d=["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"];function u(e,t){for(var n=t.length;n--;)"string"==typeof t[n]&&(t[n]=t[n].toLowerCase()),e[t[n]]=!0;return e}function c(e){var t={},n=void 0;for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}var p=/\{\{[\s\S]*|[\s\S]*\}\}/gm,l=/<%[\s\S]*|[\s\S]*%>/gm,f=/^data-[\-\w.\u00B7-\uFFFF]/,g=/^aria-[\-\w]+$/,m=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,h=/^(?:\w+script|data):/i,v=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function I(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}return function b(){var A=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window,_=function(e){return b(e)};if(_.version="1.0.6",_.removed=[],!A||!A.document||9!==A.document.nodeType)return _.isSupported=!1,_;var S=A.document,C=!1,x=A.document,R=A.DocumentFragment,M=A.HTMLTemplateElement,D=A.Node,P=A.NodeFilter,w=A.NamedNodeMap,T=void 0===w?A.NamedNodeMap||A.MozNamedAttrMap:w,E=A.Text,k=A.Comment,O=A.DOMParser;if("function"==typeof M){var W=x.createElement("template");W.content&&W.content.ownerDocument&&(x=W.content.ownerDocument)}var L=x,F=L.implementation,N=L.createNodeIterator,U=L.getElementsByTagName,G=L.createDocumentFragment,H=S.importNode,B={};_.isSupported=F&&void 0!==F.createHTMLDocument&&9!==x.documentMode;var q=p,j=l,z=f,V=g,Q=h,Y=v,K=m,X=null,J=u({},[].concat(I(e),I(t),I(n),I(r),I(o))),$=null,Z=u({},[].concat(I(i),I(a),I(s),I(d))),ee=null,te=null,ne=!0,re=!0,oe=!1,ie=!1,ae=!1,se=!1,de=!1,ue=!1,ce=!1,pe=!1,le=!1,fe=!0,ge=!0,me=!1,he={},ve=u({},["audio","head","math","script","style","template","svg","video"]),ye=u({},["audio","video","img","source","image"]),Ie=u({},["alt","class","for","id","label","name","pattern","placeholder","summary","title","value","style","xmlns"]),be=null,Ae=x.createElement("form"),_e=function(p){"object"!==(void 0===p?"undefined":y(p))&&(p={}),X="ALLOWED_TAGS"in p?u({},p.ALLOWED_TAGS):J,$="ALLOWED_ATTR"in p?u({},p.ALLOWED_ATTR):Z,ee="FORBID_TAGS"in p?u({},p.FORBID_TAGS):{},te="FORBID_ATTR"in p?u({},p.FORBID_ATTR):{},he="USE_PROFILES"in p&&p.USE_PROFILES,ne=!1!==p.ALLOW_ARIA_ATTR,re=!1!==p.ALLOW_DATA_ATTR,oe=p.ALLOW_UNKNOWN_PROTOCOLS||!1,ie=p.SAFE_FOR_JQUERY||!1,ae=p.SAFE_FOR_TEMPLATES||!1,se=p.WHOLE_DOCUMENT||!1,ce=p.RETURN_DOM||!1,pe=p.RETURN_DOM_FRAGMENT||!1,le=p.RETURN_DOM_IMPORT||!1,ue=p.FORCE_BODY||!1,fe=!1!==p.SANITIZE_DOM,ge=!1!==p.KEEP_CONTENT,me=p.IN_PLACE||!1,K=p.ALLOWED_URI_REGEXP||K,ae&&(re=!1),pe&&(ce=!0),he&&(X=u({},[].concat(I(o))),$=[],!0===he.html&&(u(X,e),u($,i)),!0===he.svg&&(u(X,t),u($,a),u($,d)),!0===he.svgFilters&&(u(X,n),u($,a),u($,d)),!0===he.mathMl&&(u(X,r),u($,s),u($,d))),p.ADD_TAGS&&(X===J&&(X=c(X)),u(X,p.ADD_TAGS)),p.ADD_ATTR&&($===Z&&($=c($)),u($,p.ADD_ATTR)),p.ADD_URI_SAFE_ATTR&&u(Ie,p.ADD_URI_SAFE_ATTR),ge&&(X["#text"]=!0),se&&u(X,["html","head","body"]),X.table&&u(X,["tbody"]),Object&&"freeze"in Object&&Object.freeze(p),be=p},Se=function(e){_.removed.push({element:e});try{e.parentNode.removeChild(e)}catch(t){e.outerHTML=""}},Ce=function(e,t){try{_.removed.push({attribute:t.getAttributeNode(e),from:t})}catch(e){_.removed.push({attribute:null,from:t})}t.removeAttribute(e)},xe=function(e){var t=void 0;if(ue&&(e="<remove></remove>"+e),C)try{t=(new O).parseFromString(e,"text/html")}catch(e){}if(!t||!t.documentElement){var n=t=F.createHTMLDocument(""),r=n.body;r.parentNode.removeChild(r.parentNode.firstElementChild),r.outerHTML=e}return U.call(t,se?"html":"body")[0]};_.isSupported&&function(){try{var e=xe('<svg><p><style><img src="</style><img src=x onerror=alert(1)//">');e.querySelector("svg img")&&(C=!0)}catch(e){}}();var Re=function(e){return N.call(e.ownerDocument||e,e,P.SHOW_ELEMENT|P.SHOW_COMMENT|P.SHOW_TEXT,function(){return P.FILTER_ACCEPT},!1)},Me=function(e){return"object"===(void 0===D?"undefined":y(D))?e instanceof D:e&&"object"===(void 0===e?"undefined":y(e))&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},De=function(e,t,n){B[e]&&B[e].forEach(function(e){e.call(_,t,n,be)})},Pe=function(e){var t=void 0;if(De("beforeSanitizeElements",e,null),function(e){return!(e instanceof E||e instanceof k||"string"==typeof e.nodeName&&"string"==typeof e.textContent&&"function"==typeof e.removeChild&&e.attributes instanceof T&&"function"==typeof e.removeAttribute&&"function"==typeof e.setAttribute)}(e))return Se(e),!0;var n=e.nodeName.toLowerCase();if(De("uponSanitizeElement",e,{tagName:n,allowedTags:X}),!X[n]||ee[n]){if(ge&&!ve[n]&&"function"==typeof e.insertAdjacentHTML)try{e.insertAdjacentHTML("AfterEnd",e.innerHTML)}catch(e){}return Se(e),!0}return!ie||e.firstElementChild||e.content&&e.content.firstElementChild||!/</g.test(e.textContent)||(_.removed.push({element:e.cloneNode()}),e.innerHTML?e.innerHTML=e.innerHTML.replace(/</g,"&lt;"):e.innerHTML=e.textContent.replace(/</g,"&lt;")),ae&&3===e.nodeType&&(t=(t=(t=e.textContent).replace(q," ")).replace(j," "),e.textContent!==t&&(_.removed.push({element:e.cloneNode()}),e.textContent=t)),De("afterSanitizeElements",e,null),!1},we=function(e,t,n){if(fe&&("id"===t||"name"===t)&&(n in x||n in Ae))return!1;if(ae&&(n=(n=n.replace(q," ")).replace(j," ")),re&&z.test(t));else if(ne&&V.test(t));else{if(!$[t]||te[t])return!1;if(Ie[t]);else if(K.test(n.replace(Y,"")));else if("src"!==t&&"xlink:href"!==t||0!==n.indexOf("data:")||!ye[e])if(oe&&!Q.test(n.replace(Y,"")));else if(n)return!1}return!0},Te=function(e){var t=void 0,n=void 0,r=void 0,o=void 0,i=void 0;De("beforeSanitizeAttributes",e,null);var a=e.attributes;if(a){var s={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:$};for(i=a.length;i--;){var d=t=a[i],u=d.name;if(n=t.value.trim(),r=u.toLowerCase(),s.attrName=r,s.attrValue=n,s.keepAttr=!0,De("uponSanitizeAttribute",e,s),n=s.attrValue,"name"===r&&"IMG"===e.nodeName&&a.id)o=a.id,a=Array.prototype.slice.apply(a),Ce("id",e),Ce(u,e),a.indexOf(o)>i&&e.setAttribute("id",o.value);else{if("INPUT"===e.nodeName&&"type"===r&&"file"===n&&($[r]||!te[r]))continue;"id"===u&&e.setAttribute(u,""),Ce(u,e)}if(s.keepAttr){var c=e.nodeName.toLowerCase();if(we(c,r,n))try{e.setAttribute(u,n),_.removed.pop()}catch(e){}}}De("afterSanitizeAttributes",e,null)}},Ee=function e(t){var n=void 0,r=Re(t);for(De("beforeSanitizeShadowDOM",t,null);n=r.nextNode();)De("uponSanitizeShadowNode",n,null),Pe(n)||(n.content instanceof R&&e(n.content),Te(n));De("afterSanitizeShadowDOM",t,null)};return _.sanitize=function(e,t){var n=void 0,r=void 0,o=void 0,i=void 0,a=void 0;if(e||(e="\x3c!--\x3e"),"string"!=typeof e&&!Me(e)){if("function"!=typeof e.toString)throw new TypeError("toString is not a function");if("string"!=typeof(e=e.toString()))throw new TypeError("dirty is not a string, aborting")}if(!_.isSupported){if("object"===y(A.toStaticHTML)||"function"==typeof A.toStaticHTML){if("string"==typeof e)return A.toStaticHTML(e);if(Me(e))return A.toStaticHTML(e.outerHTML)}return e}if(de||_e(t),_.removed=[],me);else if(e instanceof D)n=xe("\x3c!--\x3e"),1===(r=n.ownerDocument.importNode(e,!0)).nodeType&&"BODY"===r.nodeName?n=r:n.appendChild(r);else{if(!ce&&!se&&-1===e.indexOf("<"))return e;if(!(n=xe(e)))return ce?null:""}n&&ue&&Se(n.firstChild);for(var s=Re(me?e:n);o=s.nextNode();)3===o.nodeType&&o===i||Pe(o)||(o.content instanceof R&&Ee(o.content),Te(o),i=o);if(me)return e;if(ce){if(pe)for(a=G.call(n.ownerDocument);n.firstChild;)a.appendChild(n.firstChild);else a=n;return le&&(a=H.call(S,a,!0)),a}return se?n.outerHTML:n.innerHTML},_.setConfig=function(e){_e(e),de=!0},_.clearConfig=function(){be=null,de=!1},_.isValidAttribute=function(e,t,n){be||_e({});var r=e.toLowerCase(),o=t.toLowerCase();return we(r,o,n)},_.addHook=function(e,t){"function"==typeof t&&(B[e]=B[e]||[],B[e].push(t))},_.removeHook=function(e){B[e]&&B[e].pop()},_.removeHooks=function(e){B[e]&&(B[e]=[])},_.removeAllHooks=function(){B={}},_}()}()}])},function(e,t,n){"use strict";var r=n(0),o=["type","name","targetId"];e.exports={handle:function(e,t,n){var o=t.getSiteAspect("WidgetAspect").getWidgetHandler();r.forEach(e,function(e){o.handleEvent(e.targetId,e.name,e.params,n)})},getUniqueIdentifier:function(e){var t=r.at(e,o);return t.push(e.params.callbackId),t.push(e.params.compId),t.join(",")}}},function(e,t,n){"use strict";var r=n(0);e.exports=function(e,t,n){return r.assign({},e,{targetId:function(e,t){var n=e.getRuntimeDal().getPageId(t);return n?"masterPage"===n?e.getSiteData().getFocusedRootId():n:null}(n,t.sourceId)})}}])});
//# sourceMappingURL=host-platform-api.js.map