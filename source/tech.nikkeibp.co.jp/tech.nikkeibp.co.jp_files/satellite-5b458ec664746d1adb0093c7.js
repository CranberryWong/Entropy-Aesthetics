!function o(r,d,l){function u(t,e){if(!d[t]){if(!r[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(s)return s(t,!0);var a=new Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a}var i=d[t]={exports:{}};r[t][0].call(i.exports,function(e){return u(r[t][1][e]||e)},i,i.exports,o,r,d,l)}return d[t].exports}for(var s="function"==typeof require&&require,e=0;e<l.length;e++)u(l[e]);return u}({1:[function(e,t,n){"use strict";n.parse=function(e,t){if("string"!=typeof e)throw new TypeError("argument str must be a string");for(var n={},a=t||{},i=e.split(p),o=a.decode||c,r=0;r<i.length;r++){var d=i[r],l=d.indexOf("=");if(!(l<0)){var u=d.substr(0,l).trim(),s=d.substr(++l,d.length).trim();'"'==s[0]&&(s=s.slice(1,-1)),null==n[u]&&(n[u]=m(s,o))}}return n},n.serialize=function(e,t,n){var a=n||{},i=a.encode||u;if("function"!=typeof i)throw new TypeError("option encode is invalid");if(!s.test(e))throw new TypeError("argument name is invalid");var o=i(t);if(o&&!s.test(o))throw new TypeError("argument val is invalid");var r=e+"="+o;if(null!=a.maxAge){var d=a.maxAge-0;if(isNaN(d))throw new Error("maxAge should be a Number");r+="; Max-Age="+Math.floor(d)}if(a.domain){if(!s.test(a.domain))throw new TypeError("option domain is invalid");r+="; Domain="+a.domain}if(a.path){if(!s.test(a.path))throw new TypeError("option path is invalid");r+="; Path="+a.path}if(a.expires){if("function"!=typeof a.expires.toUTCString)throw new TypeError("option expires is invalid");r+="; Expires="+a.expires.toUTCString()}a.httpOnly&&(r+="; HttpOnly");a.secure&&(r+="; Secure");if(a.sameSite){var l="string"==typeof a.sameSite?a.sameSite.toLowerCase():a.sameSite;switch(l){case!0:r+="; SameSite=Strict";break;case"lax":r+="; SameSite=Lax";break;case"strict":r+="; SameSite=Strict";break;default:throw new TypeError("option sameSite is invalid")}}return r};var c=decodeURIComponent,u=encodeURIComponent,p=/; */,s=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function m(t,e){try{return e(t)}catch(e){return t}}},{}],2:[function(e,t,n){for(var i=[],a=0;a<256;++a)i[a]=(a+256).toString(16).substr(1);t.exports=function(e,t){var n=t||0,a=i;return a[e[n++]]+a[e[n++]]+a[e[n++]]+a[e[n++]]+"-"+a[e[n++]]+a[e[n++]]+"-"+a[e[n++]]+a[e[n++]]+"-"+a[e[n++]]+a[e[n++]]+"-"+a[e[n++]]+a[e[n++]]+a[e[n++]]+a[e[n++]]+a[e[n++]]+a[e[n++]]}},{}],3:[function(e,t,n){var a="undefined"!=typeof crypto&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&msCrypto.getRandomValues.bind(msCrypto);if(a){var i=new Uint8Array(16);t.exports=function(){return a(i),i}}else{var o=new Array(16);t.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},{}],4:[function(e,t,n){var r=e("./lib/rng"),d=e("./lib/bytesToUuid");t.exports=function(e,t,n){var a=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||r)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var o=0;o<16;++o)t[a+o]=i[o];return t||d(i)}},{"./lib/bytesToUuid":2,"./lib/rng":3}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a,i=function(){function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}}(),o=e("./utils.js");var m=new((a=o)&&a.__esModule?a:{default:a}).default,f=new m.handler,g={},r={},v={},w={},h={},y={},d={},l={},u={},s={},k={trackDownload:{},trackLink:{},trackMedia:{}},c=null,b=+new Date,p=+new Date,_=function(){function a(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);var t=null;try{t=new CustomEvent("atlasVisibilityStatus")}catch(e){(t=window.parent.document.createEvent("CustomEvent")).initCustomEvent("atlasVisibilityStatus",!1,!1,{})}var e=window.parent.requestAnimationFrame||window.parent.mozRequestAnimationFrame||window.parent.webkitRequestAnimationFrame||window.parent.msRequestAnimationFrame;if(e)window.parent.requestAnimationFrame=e;else{var i=0;window.parent.requestAnimationFrame=function(e){var t=+new Date,n=Math.max(0,16-(t-i)),a=window.parent.setTimeout(function(){e(t+n)},n);return i=t+n,a}}var n=null;!function e(){if(window.parent.requestAnimationFrame(e),n)return!1;n=setTimeout(function(){window.parent.dispatchEvent(t),n=null},250)}()}return i(a,[{key:"getQueryValue",value:function(e){return m.getQueryValue(e)||""}},{key:"getCookieValue",value:function(e){return m.getCookieValue(e)||""}},{key:"setDataSrc",value:function(e){d=JSON.parse(decodeURIComponent(e))}},{key:"getDataFromSrc",value:function(e){return d[e]||""}},{key:"getVisibility",value:function(e){return m.getVisibility(e)||""}},{key:"config",value:function(e){var t=this;l.url=void 0!==e.defaults.pageUrl?e.defaults.pageUrl:window.parent.document.location.href,l.referrer=void 0!==e.defaults.pageReferrer?e.defaults.pageReferrer:window.parent.document.referrer,l.page_title=void 0!==e.defaults.pageTitle?e.defaults.pageTitle:window.parent.document.title,l.product_family=void 0!==e.product.productFamily?e.product.productFamily:null,l.product=void 0!==e.product.productName?e.product.productName:null,r=void 0!==e.system?e.system:{},g=void 0!==e.debug?e.debug:{},v=void 0!==e.options?e.options:{},m.initSystem(r),v&&(v.dataSrc&&this.setDataSrc(v.dataSrc),v.observeMutation&&(c&&c.disconnect(),(c=new MutationObserver(function(e){t.initEventListeners(e)})).observe(document.getElementsByTagName("body")[0],{childList:!0,subtree:!0})),v.exchangeAtlasId&&v.exchangeAtlasId.catch&&m.setAtlasIdFromParam(v.exchangeAtlasId.catchParamKey,v.exchangeAtlasId.catchTargetDomains)),("true"===this.getCookieValue("atlasOutputLog")||g&&g.outputLog)&&(g.outputLog=!0,console.log("ATJ configured"))}},{key:"setCustomVars",value:function(e,t){h[e]=t}},{key:"setCustomObject",value:function(e,t){h.custom_object[e]=t}},{key:"setCustomId",value:function(e,t){w.external_ids[e]=t}},{key:"delCustomVars",value:function(e){delete h[e]}},{key:"delCustomObject",value:function(e){delete h.custom_object[e]}},{key:"delCustomId",value:function(e){delete w.external_ids[e]}},{key:"debug",value:function(e){var t=this.getCookieValue("atlasOutputLog");"enable"===e?window.parent.document.cookie="atlasOutputLog=true":"disable"===e?window.parent.document.cookie="atlasOutputLog=":"true"===t?console.log("enabled"):console.log("disabled")}},{key:"optout",value:function(e){var t=this.getCookieValue("atlasOptout");"enable"===e?window.parent.document.cookie="atlasOptout=true":"disable"===e?window.parent.document.cookie="atlasOptout=":"true"===t?console.log("enabled"):console.log("disabled")}},{key:"initEventListeners",value:function(e){if(g&&g.outputLog&&console.log("ATJ initialized EventListeners"),(v.exchangeAtlasId&&v.exchangeAtlasId.pass||v.trackLink&&v.trackLink.enable||v.trackDownload&&v.trackDownload.enable)&&this.setEventToLinks({passAtlasId:v.exchangeAtlasId,trackLink:v.trackLink,trackDownload:v.trackDownload}),v.trackUnload&&v.trackUnload.enable){var t=null;t="onbeforeunload"in window.parent?"beforeunload":"onpagehide"in window.parent?"pagehide":"unload",window.parent.addEventListener(t,function(){m.transmitData("unload","page",y,w,h,{action:{name:"leave_from_page",elapsed_since_page_load:Math.round((+new Date-b)/1e3)}},v.useGet,g)},!1)}v.trackScroll&&v.trackScroll.enable&&this.trackScroll(v.trackScroll.granularity,v.trackScroll.threshold),v.trackInfinityScroll&&v.trackInfinityScroll.enable&&this.trackInfinityScroll(v.trackInfinityScroll.step,v.trackInfinityScroll.threshold),v.trackRead&&v.trackRead.enable&&this.trackRead(v.trackRead.target,v.trackRead.granularity,v.trackRead.milestones),v.trackViewability&&v.trackViewability.enable&&this.trackViewability(v.trackViewability.targets),v.trackMedia&&v.trackMedia.enable&&this.trackMedia(v.trackMedia.targets,v.trackMedia.heartbeat),v.trackPerformance&&v.trackPerformance.enable&&window.parent.addEventListener("DOMContentLoaded",function(){s=m.getPerformanceInfo(),h.navigation_timing=s.performanceResult||{},h.navigation_type=s.navigationType||{}},!1)}},{key:"initPage",value:function(e){g&&g.outputLog&&console.log("ATJ initialized Page"),void 0!==e.context&&void 0!==e.user&&(y={url:void 0!==e.context.url?e.context.url:l.url,referrer:void 0!==e.context.referrer?e.context.referrer:l.referrer,content_id:e.context.content_id||"",user_id:e.user.user_id||""}),void 0!==e.user&&(w={user_status:e.user.user_status||void 0,site_session:e.user.site_session||void 0,external_ids:{},federation_id:e.user.federation_id||void 0}),void 0!==e.context&&(h={product_family:void 0!==e.context.product_family?e.context.product_family:l.product_family,product:e.context.product||l.product,app:e.context.app||void 0,app_version:e.context.app_version||void 0,page_title:e.context.page_title||l.page_title,source:e.context.source||void 0,edition:e.context.edition||void 0,content_name:e.context.content_name||void 0,content_status:e.context.content_status||void 0,page_name:e.context.page_name||void 0,page_num:e.context.page_num||1,category_l1:e.context.category_l1||void 0,category_l2:e.context.category_l2||void 0,category_l3:e.context.category_l3||void 0,tracking_code:e.context.tracking_code||void 0,events:e.context.events||void 0,custom_object:e.context.custom_object||{},funnel:e.context.funnel||{},visibility:window.parent.document.visibilityState||"unknown"}),v.trackPerformance&&v.trackPerformance.enable&&(s=m.getPerformanceInfo(),h.navigation_timing=s.performanceResult||{},h.navigation_type=s.navigationType||{}),this.initEventListeners()}},{key:"trackPage",value:function(){m.transmitData("view","page",y,w,h,u,v.useGet,g)}},{key:"trackAction",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"action",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"unknown",n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},i=+new Date;h.events=n||null,m.transmitData(e,t,y,w,h,{action:{location:void 0!==a.location?a.location:l.url,destination:a.destination||void 0,name:a.action_name||void 0,elapsed_since_page_load:Math.round((i-b)/1e3),elapsed_since_prev_action:Math.round((i-p)/1e3),content_id:a.content_id||void 0,content_name:a.content_name||void 0,custom_vars:a.custom_value||{}}},v.useGet,g),h.events=null,p=+new Date}},{key:"setEventToLinks",value:function(t){for(var n=window.parent.document.getElementsByTagName("a"),a=null,i=null,o=null,e=function(e){(a=window.parent.document.createElement("a")).href=n[e].href,o=a.pathname.match(/.+\/.+?\.([a-z]+([?#;].*)?$)/),t.passAtlasId&&t.passAtlasId.pass&&a.hostname&&window.parent.location.hostname!==a.hostname&&0<=t.passAtlasId.passTargetDomains.indexOf(a.hostname)&&(i=m.buildLinkWithAtlasId(a,t.passAtlasId.passParamKey),n[e].href=i),t.trackLink&&t.trackLink.enable&&a.hostname&&window.parent.location.hostname!==a.hostname&&t.trackLink.internalDomains.indexOf(a.hostname)<0&&(f.removeListener(k.trackLink[e]),k.trackLink[e]=f.addListener(n[e],"click",function(){m.transmitData("open","outbound_link",y,w,h,{link:{destination:this.href||void 0,target:this.target||void 0,media:this.media||void 0,type:this.type||void 0,name:t.trackLink.nameAttribute?this.getAttribute(t.trackLink.nameAttribute):void 0,index:e}},v.useGet,g)},!1)),t.trackDownload&&t.trackDownload.enable&&a.hostname&&o&&0<=t.trackDownload.fileExtensions.indexOf(o[1])&&(f.removeListener(k.trackDownload[e]),k.trackDownload[e]=f.addListener(n[e],"click",function(){m.transmitData("download","file",y,w,h,{download:{destination:this.href||void 0,target:this.target||void 0,media:this.media||void 0,type:this.type||void 0,name:t.trackDownload.nameAttribute?this.getAttribute(t.trackDownload.nameAttribute):void 0,index:e}},v.useGet,g)},!1))},r=0;r<n.length;r++)e(r)}},{key:"trackScroll",value:function(e,t){var n=e||25,a=100/n,i=1e3*t||2e3,o=+new Date,r=o,d={},l=0,u=0;f.removeListener(k.trackScroll),k.trackScroll=f.addListener(window.parent,"atlasVisibilityStatus",function(){"hidden"!==(d=m.getVisibility(null)).detail.documentIsVisible&&"prerender"!==d.detail.documentIsVisible&&(o=+new Date,l=Math.round(d.detail.documentScrollRate*a)*n,u<l&&0<=l&&l<=100&&setTimeout(function(){u<l&&(m.transmitData("scroll","page",y,w,h,{scroll_depth:{page_height:d.detail.documentHeight,viewed_until:d.detail.documentScrollUntil,viewed_percent:l,elapsed_since_page_load:Math.round((o-b)/1e3),elapsed_since_prev_action:Math.round((o-r)/1e3)}},v.useGet,g),u=l),r=o},i))},!1)}},{key:"trackInfinityScroll",value:function(e,t){var n=1e3*t||2e3,a=+new Date,i=a,o={},r=0,d=0;f.removeListener(k.trackInfinityScroll),k.trackInfinityScroll=f.addListener(window.parent,"atlasVisibilityStatus",function(){"hidden"!==(o=m.getVisibility(null)).detail.documentIsVisible&&"prerender"!==o.detail.documentIsVisible&&(a=+new Date,r=o.detail.documentScrollUntil,d<r&&d<=r&&e<=r&&setTimeout(function(){d<r&&(m.transmitData("infinity_scroll","page",y,w,h,{scroll_depth:{page_height:o.detail.documentHeight,viewed_until:r,viewed_percent:o.detail.documentScrollRate,elapsed_since_page_load:Math.round((a-b)/1e3),elapsed_since_prev_action:Math.round((a-i)/1e3)}},v.useGet,g),d=r+e),i=a},n))},!1)}},{key:"trackRead",value:function(e,t,n){if(e){var a=t||25,i=100/a,o=+new Date,r=o,d={},l=0,u=null,s=null,c=0,p=0;f.removeListener(k.trackRead),k.trackRead=f.addListener(window.parent,"atlasVisibilityStatus",function(){"hidden"!==(d=m.getVisibility(e)).detail.documentIsVisible&&"prerender"!==d.detail.documentIsVisible&&d.status.isInView&&(1e3<=(o=+new Date)-r&&(r=o),l+=o-r,r=o,n.forEach(function(e){Math.floor(l/1e3)>=e&&o-r<1e3&&(n.shift(),u=e)}),u&&s!==u&&(m.transmitData("read","article",y,w,h,{read:{mode:"time",milestone:u,page_height:d.detail.documentHeight,element_height:d.detail.targetHeight,viewed_from:d.detail.targetVisibleTop,viewed_until:d.detail.targetVisibleBottom,viewed_percent:c,elapsed_since_page_load:Math.round((o-b)/1e3),elapsed_since_prev_action:Math.round((o-r)/1e3)}},v.useGet,g),s=u,u=null),c=Math.round(d.detail.targetScrollRate*i)*a,p<c&&0<=c&&c<=100&&setTimeout(function(){p<c&&(m.transmitData("read","article",y,w,h,{read:{mode:"scroll",page_height:d.detail.documentHeight,element_height:d.detail.targetHeight,viewed_from:d.detail.targetVisibleTop,viewed_until:d.detail.targetVisibleBottom,viewed_percent:c,elapsed_since_page_load:Math.round((o-b)/1e3),elapsed_since_prev_action:Math.round((o-r)/1e3)}},v.useGet,g),p=c)},1e3))},!1)}}},{key:"trackViewability",value:function(n){var a=+new Date,i={},o={};f.removeListener(k.trackViewability),k.trackViewability=f.addListener(window.parent,"atlasVisibilityStatus",function(){for(var e=function(e){n[e]&&(i[e]=m.getVisibility(n[e]),!0===i[e].status.isInView&&"hidden"!==i[e].detail.documentIsVisible&&"prerender"!==i[e].detail.documentIsVisible&&.5<=i[e].detail.targetViewableRate&&!o[e]&&setTimeout(function(){.5<=i[e].detail.targetViewableRate&&!o[e]&&(a=+new Date,o[e]=!0,m.transmitData("viewable_impression","ad",y,w,h,{viewability:{page_height:i[e].detail.documentHeight,element_order_in_target:e,element_tag:n[e].tagName,element_class:n[e].className,element_id:n[e].id,element_height:i[e].detail.targetHeight,elapsed_since_page_load:Math.round((a-b)/1e3)}},v.useGet,g))},1e3))},t=0;t<n.length;t++)e(t)},!1)}},{key:"trackMedia",value:function(n,a){var i={};f.removeListener(k.trackMedia);for(var e=function(e){var t=n[e].tagName.toLowerCase();k.trackMedia[e]={},i[e]={},n[e].paused||n[e].ended||m.transmitData("play",t,y,w,h,{media:m.getMediaStatus(n[e])},v.useGet,g),n[e].ended&&m.transmitData("ended",t,y,w,h,{media:m.getMediaStatus(n[e])},v.useGet,g),k.trackMedia[e].play=f.addListener(n[e],"play",function(){m.transmitData("play",t,y,w,h,{media:m.getMediaStatus(n[e])},v.useGet,g)},!1),k.trackMedia[e].pause=f.addListener(n[e],"pause",function(){n[e].ended||(m.transmitData("pause",t,y,w,h,{media:m.getMediaStatus(n[e])},v.useGet,g),i[e].status="paused")},!1),k.trackMedia[e].ended=f.addListener(n[e],"ended",function(){m.transmitData("ended",t,y,w,h,{media:m.getMediaStatus(n[e])},v.useGet,g),i[e].status="ended"},!1),i[e].timerFrequency=null,k.trackMedia[e].timeupdate=f.addListener(n[e],"timeupdate",function(){if(i[e].timerFrequency)return!1;i[e].timerFrequency=setTimeout(function(){"paused"!==i[e].status&&"ended"!==i[e].status&&m.transmitData("playing",n[e].tagName.toLowerCase(),y,w,h,{media:m.getMediaStatus(n[e])},v.useGet,g),i[e].timerFrequency=null},1e3*a),i[e].status="playing"},!1)},t=0;t<n.length;t++)e(t)}}]),a}();n.default=_,window.atlasTracking=new _},{"./utils.js":6}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}}(),i=r(e("cookie")),o=r(e("uuid/v4"));function r(e){return e&&e.__esModule?e:{default:e}}var h=null,d=null,y=null,l=null,u=null,k="0",s={},c=0,b=!0,p=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,[{key:"initSystem",value:function(e){var t=i.default.parse(window.parent.document.cookie),n=window.parent.location.hostname,a=n.split(".").reverse();h=e.endpoint?e.endpoint:"atlas-endpoint.data.n8s.jp",d=e.beaconTimeout?e.beaconTimeout:2e3,y=e.cookieName?e.cookieName:"atlasId",l=e.cookieMaxAge?e.cookieMaxAge:63072e3,u=e.cookieDomain?e.cookieDomain:a.length<=2?n:2<a[1].length?a[1]+"."+a[0]:2===a[0].length&&2===a[1].length?a[2]+"."+a[1]+"."+a[0]:n,(!(k=t[y])||"0"===k||0===k||"1"===k||1===k||k.length<5)&&(k=((0,o.default)()+(0,o.default)()).replace(/-/g,""),window.parent.document.cookie=i.default.serialize(y,k,{maxAge:l,domain:u,path:"/"}))}},{key:"setAtlasIdFromParam",value:function(e,t){if(!k&&window.parent.document.referrer){var n=window.parent.document.createElement("a");if(n.href=window.parent.document.referrer,0<=t.indexOf(n.hostname)){var a=this.getQueryValue(e);a&&(k=a,window.parent.document.cookie=i.default.serialize(y,k,{maxAge:l,domain:u,path:"/"}))}}}},{key:"getCookieValue",value:function(e){var t=i.default.parse(window.parent.document.cookie);return t[e]?t[e]:""}},{key:"getQueryValue",value:function(e){var t=window.parent.location.search.slice(1);if(""===t)return"";for(var n=t.split("&"),a=n.length,i=0;i<a;++i){var o=n[i].split("=");if(decodeURIComponent(o[0])===e)return decodeURIComponent(o[1])}return""}},{key:"getPerformanceInfo",value:function(){var e={},t={},n={};return"performance"in window.parent&&(n={unload:(e=window.parent.performance.timing).unloadEnd-e.unloadStart,redirect:e.redirectEnd-e.redirectStart,dns:e.domainLookupEnd-e.domainLookupStart,tcp:e.connectEnd-e.connectStart,request:e.responseStart-e.requestStart,response:e.responseEnd-e.responseStart,dom:e.domContentLoadedEventStart-e.domLoading<0||36e5<e.domContentLoadedEventStart-e.domLoading?null:e.domContentLoadedEventStart-e.domLoading,domContent:e.domContentLoadedEventEnd-e.domContentLoadedEventStart<0||36e5<e.domContentLoadedEventEnd-e.domContentLoadedEventStart?null:e.domContentLoadedEventEnd-e.domContentLoadedEventStart,onload:e.loadEventEnd-e.loadEventStart<0||36e5<e.loadEventEnd-e.loadEventStart?null:e.loadEventEnd-e.loadEventStart,untilResponseComplete:e.responseEnd-e.navigationStart<0||36e5<e.responseEnd-e.navigationStart?null:e.responseEnd-e.navigationStart,untilDomComplete:e.domContentLoadedEventStart-e.navigationStart<0||36e5<e.domContentLoadedEventStart-e.navigationStart?null:e.domContentLoadedEventStart-e.navigationStart},t=(window.parent.performance||{}).navigation),{performanceResult:n,navigationType:t}}},{key:"handler",value:function(){return{addListener:function(e,t,n,a){return e.addEventListener(t,n,a),s[c]={target:e,type:t,listener:n,capture:a},c++},removeListener:function(e){if(e in s){var t=s[e];t.target.removeEventListener(t.type,t.listener,t.capture)}}}}},{key:"getVisibility",value:function(e){var t={};try{t=e.getBoundingClientRect()}catch(e){t={}}var n,a=window.parent.innerHeight,i=window.parent.document.documentElement.scrollHeight,o=window.parent.document.visibilityState||"unknown",r="pageYOffset"in window.parent?window.parent.pageYOffset:(window.parent.document.documentElement||window.parent.document.body.parentNode||window.parent.document.body).scrollTop,d=r+a,l=t.height,u=t.top<=0?0:t.top,s=-1*(t.bottom-a)<=0?0:-1*(t.bottom-a),c=d,p=d/i,m=null,f=null,g=!1,v=null;return 0<=t.top&&t.bottom>a&&t.top>=a?(f=m=null,g=!1,v="pre"):0<=t.top&&t.bottom>a&&t.top<a?(m=0,f=a-t.top,g=!0,v="top"):t.top<0&&t.bottom>a?(f=(m=-1*t.top)+a,g=!0,v="middle"):0<=t.top&&t.bottom<=a?(f=l,g=!(m=0),v="all"):t.top<0&&0<=t.bottom&&t.bottom<=a?(m=l+t.top,f=l,g=!0,v="bottom"):t.top<0&&t.bottom<0?(f=m=null,g=!1,v="post"):(g=!1,v="unknown"),{detail:{viewportHeight:a,documentHeight:i,documentIsVisible:o,documentVisibleTop:r,documentVisibleBottom:d,targetHeight:l,targetVisibleTop:m,targetVisibleBottom:n=f,targetMarginTop:u,targetMarginBottom:s,targetScrollUntil:n,targetScrollRate:n/l,targetViewableRate:(f-m)/l,documentScrollUntil:c,documentScrollRate:p},status:{isInView:g,location:v}}}},{key:"getMediaStatus",value:function(e){if(void 0!==e)return{src:e.src||null,type:e.type||null,codecs:e.codecs||null,muted:e.muted||null,default_muted:e.defaultMuted||null,autoplay:e.autoplay||null,width:e.clientWidth||null,height:e.clientHeight||null,player_id:e.playerId||null,played_percent:Math.round(e.currentTime/e.duration*100),duration:e.duration,current_time:Math.round(10*e.currentTime)/10}}},{key:"buildIngest",value:function(e,t,n){var a={},i="unknown";for(var o in window.parent.orientation&&(i=90===Math.abs(window.parent.orientation)?"landscape":"portrait"),a={user:e,context:{}},t)a.context[o]=t[o];for(var r in n)a.context[r]=n[r];var d=new Date;return a.user.timezone=d.getTimezoneOffset()/60*-1,a.user.timestamp=d.toISOString(),a.user.viewport_height=window.parent.innerHeight,a.user.viewport_width=window.parent.innerWidth,a.user.screen_height=window.parent.screen.height,a.user.screen_width=window.parent.screen.width,a.user.layout=i,a}},{key:"buildLinkWithAtlasId",value:function(e,t){var n=null,a=null;return k&&(n=new RegExp("(\\?|&)"+t+"=(.*?)(&|$)"),0<(a=e.search.replace(n,"")).length?e.search=a+"&"+t+"="+k:e.search="?"+t+"="+k),e.href}},{key:"compressJsonString",value:function(e){var t=e;return t=(t=(t=(t=(t=(t=(t=t.replace(/%22%7D%2C%22/g,"%z")).replace(/%22%3A%22/g,"%y")).replace(/%22%2C%22/g,"%x")).replace(/%22%3A%7B/g,"%w")).replace(/%22%3A/g,"%v")).replace(/%2C%22/g,"%u")).replace(/%7D%7D%7D/g,"%t")}},{key:"xhrFetch",value:function(e,t,n,a){var i=null;window.parent.XDomainRequest?((i=new XDomainRequest).ontimeout=function(){},i.onprogress=function(){},i.onerror=function(){}):i=new XMLHttpRequest,i.open(n,e,a),!0===a&&(i.timeout=d),i.withCredentials=!0,"GET"===n?i.send():i.send(t)}},{key:"transmitData",value:function(e,t,n,a,i,o,r,d){var l=document.location&&"http:"===document.location.protocol?"http:":"https:",u=+new Date,s=d&&d.syncMode?"&sync=true":"",c=r?"GET":"POST",p=!("unload"===e&&"page"===t),m="true"===this.getCookieValue("atlasOptout"),f=1;this.getCookieValue(y)!==k&&(k=f=0);var g=l+"//"+h+"/ATJ-2.10.4/"+u+"/"+encodeURIComponent(k)+"/"+f+"/ingest?k=f5bd13f23dd7ba41ddcf0cfcd9971a834a08b495"+s+"&a="+e+"&c="+t+"&g="+encodeURIComponent(n.url)+"&r="+encodeURIComponent(n.referrer)+"&i="+encodeURIComponent(n.content_id)+"&u="+encodeURIComponent(n.user_id)+"&aqe=%",v=JSON.stringify(this.buildIngest(a,i,o)),w=null;if(r&&(w=this.compressJsonString(encodeURIComponent(v)),v=null,g=g+"&d="+w),d&&d.outputLog&&console.log({action:e,category:t,request:{endpoint:g,body:v},identity:{atlasId:k,fpcStatus:f,optout:m},variables:{mandatories:n,user:a,context:i,supplement:o}}),!m){if("sendBeacon"in navigator&&!0===b){try{b=navigator.sendBeacon(g,v)}catch(e){b=!1}return b||this.xhrFetch(g,v,c,p),!0}return this.xhrFetch(g,v,c,p),!0}}}]),e}();n.default=p},{cookie:1,"uuid/v4":4}]},{},[5]);
