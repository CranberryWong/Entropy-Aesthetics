var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();!function(){"use strict";var commonjsGlobal="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function unwrapExports(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function createCommonjsModule(e,t){return e(t={exports:{}},t.exports),t.exports}var requiresPort=function e(t,n){if(n=n.split(":")[0],!(t=+t))return!1;switch(n){case"http":case"ws":return 80!==t;case"https":case"wss":return 443!==t;case"ftp":return 21!==t;case"gopher":return 70!==t;case"file":return!1}return 0!==t},has=Object.prototype.hasOwnProperty;function decode(e){return decodeURIComponent(e.replace(/\+/g," "))}function querystring(e){for(var t,n=/([^=?&]+)=?([^&]*)/g,r={};t=n.exec(e);r[decode(t[1])]=decode(t[2]));return r}function querystringify(e,t){t=t||"";var n=[];for(var r in"string"!=typeof t&&(t="?"),e)has.call(e,r)&&n.push(encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return n.length?t+n.join("&"):""}var stringify=querystringify,parse=querystring,querystringify_1={stringify:stringify,parse:parse},protocolre=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\S\s]*)/i,slashes=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,rules=[["#","hash"],["?","query"],["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],ignore={hash:1,query:1};function lolcation(e){var t,n={},r=typeof(e=e||commonjsGlobal.location||{});if("blob:"===e.protocol)n=new URL$1(unescape(e.pathname),{});else if("string"===r)for(t in n=new URL$1(e,{}),ignore)delete n[t];else if("object"===r){for(t in e)t in ignore||(n[t]=e[t]);void 0===n.slashes&&(n.slashes=slashes.test(e.href))}return n}function extractProtocol(e){var t=protocolre.exec(e);return{protocol:t[1]?t[1].toLowerCase():"",slashes:!!t[2],rest:t[3]}}function resolve(e,t){for(var n=(t||"/").split("/").slice(0,-1).concat(e.split("/")),r=n.length,i=n[r-1],o=!1,a=0;r--;)"."===n[r]?n.splice(r,1):".."===n[r]?(n.splice(r,1),a++):a&&(0===r&&(o=!0),n.splice(r,1),a--);return o&&n.unshift(""),"."!==i&&".."!==i||n.push(""),n.join("/")}function URL$1(e,t,n){if(!(this instanceof URL$1))return new URL$1(e,t,n);var r,i,o,a,s,u,c=rules.slice(),l=typeof t,d=this,f=0;for("object"!==l&&"string"!==l&&(n=t,t=null),n&&"function"!=typeof n&&(n=querystringify_1.parse),t=lolcation(t),r=!(i=extractProtocol(e||"")).protocol&&!i.slashes,d.slashes=i.slashes||r&&t.slashes,d.protocol=i.protocol||t.protocol||"",e=i.rest,i.slashes||(c[2]=[/(.*)/,"pathname"]);f<c.length;f++)u=(a=c[f])[1],(o=a[0])!=o?d[u]=e:"string"==typeof o?~(s=e.indexOf(o))&&("number"==typeof a[2]?(d[u]=e.slice(0,s),e=e.slice(s+a[2])):(d[u]=e.slice(s),e=e.slice(0,s))):(s=o.exec(e))&&(d[u]=s[1],e=e.slice(0,s.index)),d[u]=d[u]||r&&a[3]&&t[u]||"",a[4]&&(d[u]=d[u].toLowerCase());n&&(d.query=n(d.query)),r&&t.slashes&&"/"!==d.pathname.charAt(0)&&(""!==d.pathname||""!==t.pathname)&&(d.pathname=resolve(d.pathname,t.pathname)),requiresPort(d.port,d.protocol)||(d.host=d.hostname,d.port=""),d.username=d.password="",d.auth&&(a=d.auth.split(":"),d.username=a[0]||"",d.password=a[1]||""),d.origin=d.protocol&&d.host&&"file:"!==d.protocol?d.protocol+"//"+d.host:"null",d.href=d.toString()}function set(e,t,n){var r=this;switch(e){case"query":"string"==typeof t&&t.length&&(t=(n||querystringify_1.parse)(t)),r[e]=t;break;case"port":r[e]=t,requiresPort(t,r.protocol)?t&&(r.host=r.hostname+":"+t):(r.host=r.hostname,r[e]="");break;case"hostname":r[e]=t,r.port&&(t+=":"+r.port),r.host=t;break;case"host":r[e]=t,/:\d+$/.test(t)?(t=t.split(":"),r.port=t.pop(),r.hostname=t.join(":")):(r.hostname=t,r.port="");break;case"protocol":r.protocol=t.toLowerCase(),r.slashes=!n;break;case"pathname":case"hash":if(t){var i="pathname"===e?"/":"#";r[e]=t.charAt(0)!==i?i+t:t}else r[e]=t;break;default:r[e]=t}for(var o=0;o<rules.length;o++){var a=rules[o];a[4]&&(r[a[1]]=r[a[1]].toLowerCase())}return r.origin=r.protocol&&r.host&&"file:"!==r.protocol?r.protocol+"//"+r.host:"null",r.href=r.toString(),r}function toString(e){e&&"function"==typeof e||(e=querystringify_1.stringify);var t,n=this,r=n.protocol;r&&":"!==r.charAt(r.length-1)&&(r+=":");var i=r+(n.slashes?"//":"");return n.username&&(i+=n.username,n.password&&(i+=":"+n.password),i+="@"),i+=n.host+n.pathname,(t="object"==typeof n.query?e(n.query):n.query)&&(i+="?"!==t.charAt(0)?"?"+t:t),n.hash&&(i+=n.hash),i}URL$1.prototype={set:set,toString:toString},URL$1.extractProtocol=extractProtocol,URL$1.location=lolcation,URL$1.qs=querystringify_1;var urlParse=URL$1,urlParse_=Object.freeze({default:urlParse,__moduleExports:urlParse}),urlParse$1=urlParse||urlParse_,url,strings,TEST_MODE;function getWin(e,t){try{for(var n=0;n<10&&e!==e.top;n+=1){try{if(t&&t(e))break}catch(e){}if(!e.parent)break;e=e.parent}}catch(e){}return e}function getWritableWin(e){return getWin(e,function(e){try{if(e.parent&&e.parent.location.href)return!1}catch(e){return!0}return!1})}function parseTestMode(e){if("true"===e)return 1;var t="string"==typeof e?parseInt(e,10):e;return!isNaN(t)&&t>=TEST_MODE.Unknown&&t<=TEST_MODE.VMAP?t:TEST_MODE.Unknown}!function(e){e.URL="undefined"!=typeof window&&"URL"in window?window.URL:urlParse$1;var t=/(^(data:|about:|javascript:|blob:|#))|(\.kaspersky-labs\.com)/i,n=/javascript:/i,r=/javascript:\s*?([''])(.+)(\1)/i;function i(e){return!e||!(e=(""+e).trim())||t.test(e)}function o(e){var t=[];try{for(var n=e,r=0;r<10&&n.location.href&&(t.push(n),!(n===e.top||n.proxyLocation&&n.parent.proxyLocation&&n.proxyLocation.origin!==n.parent.proxyLocation.origin));r+=1)n=n.parent}catch(e){}return t}function a(e){if(e.indexOf("cloudfront")>-1)return e;if(e.indexOf("facebook.com")>-1)return e;for(var t=e.split(".");t.length>2;)t.shift();return t.join(".")}function s(e){try{if(!e)return"";var t=(e=(""+e).trim()).indexOf("//");return-1!==t&&(e=e.substring(t+2)),-1!==(t=e.indexOf(":"))?a(e.substring(0,t)):-1!==(t=e.indexOf("/"))?a(e.substring(0,t)):-1!==(t=e.indexOf("?"))?a(e.substring(0,t)):a(-1!==(t=e.indexOf("#"))?e.substring(0,t):e)}catch(e){}return""}e.isIgnoredURL=i,e.resolveURL=function u(t,n){if(i(t))return t;t=""+t;try{return new e.URL(t).toString()}catch(e){}try{return new e.URL(t,n).toString()}catch(e){}return t},e.extractInlineScript=function c(e){if(!n.test(e=e||""))return{type:"none",value:""};var t=r.exec(e);return t?{type:"html",value:t[2]}:{type:"script",value:e.split("javascript:")[1]}},e.Protocol=function l(e){return e.substring(0,e.indexOf(":")+1)},e.getProto=function d(){var e=window;try{for(;i(e.location.href);)e=e.parent}catch(e){}return e.location.protocol},e.getControlledWindow=function f(e,t){var n=e;try{for(t&&t(n);!n.proxyLocation&&((n=n.parent).location.href&&t&&t(n),n!==window.top););}catch(e){}return n},e.getAccessibleWindows=o,e.getAncestorOrigins=function p(e,t){void 0===t&&(t=!1);for(var n=o(e),r=n.map(function(e){return"proxyLocation"in e&&e.proxyLocation.origin?e.proxyLocation.origin:e.location.origin}),i=n.length-1;i>=0;i-=1){var a=n[i];if(a&&a.proxyLocation){(a.proxyLocation.ancestorOrigins||[]).forEach(function(e){r.push(e)});break}}return t||r.shift(),r},e.parseQuery=function h(e){var t={};return function n(e){if(!e)return"";var t=(""+e).trim(),n=t.indexOf("?");return n>-1?t.substring(n+1):t}(e).split("&").forEach(function(e){var n=e.split("="),r=n[1];t[decodeURIComponent(n[0]||"").trim()]=decodeURIComponent(r||"").trim()}),t},e.isFixedResource=function g(e){var t=e.indexOf("//"),n=e.substring(t+2,e.indexOf("/",t+2)),r=e.indexOf("#"),i=e.indexOf("?"),o=n.split(":")[0],a=e.substring(e.indexOf("/",t+2),i>-1?i:r>-1?r:e.length);if(-1===t)return!1;for(var s=0,u=[{hostname:"imasdk.googleapis.com",pathname:"/js/sdkloader/vpaid_adapter.js"},{hostname:"imasdk.googleapis.com",pathname:"/js/sdkloader/ima3.js"},{hostname:"imasdk.googleapis.com",pathname:"/js/sdkloader/ima3_debug.js"},{hostname:"s0.2mdn.net",pathname:"/instream/video/client.js"},{hostname:"www.googletagservices.com",pathname:"/tag/js/gpt.js"},{hostname:"publica-storage.getpublica.com",pathname:"/ui-scripts/prebid.js/tmp/rd.com/prebid_20180215224539.js"},{hostname:"static.criteo.net",pathname:"/js/ld/publishertag.js"},{hostname:"cdnjs.cloudflare.com",pathname:"/ajax/libs/postscribe/2.0.8/postscribe.min.js"}];s<u.length;s++){var c=u[s];if(o===c.hostname&&a===c.pathname)return!0}return!1},e.extractPath=function E(e){if(!e)return"";var t=(""+e).trim();return(t=t.substring(t.lastIndexOf("/"))).indexOf("?")>-1&&(t=t.substring(0,t.indexOf("?"))),t},e.extractQuery=function y(e){if(!e)return"";var t=(""+e).trim();return t.indexOf("?")>-1?t.substring(t.indexOf("?")+1):""},e.extractDomain=s,e.isSameDomain=function m(e,t){if(!e)return!1;var n={};t.map(s).forEach(function(e){e&&(n[e]=!0)}),e=s(e);for(var r=0,i=Object.keys(n);r<i.length;r++)if(i[r]===e)return!0;return!1},e.normalizeURL=function _(e){var t=document.createElement("a");return t.href=e,t.href}}(url||(url={})),function(e){e.reverse=function t(e){return(e||"").split("").reverse().join("")},e.shuffle=function n(e,t,r){var i,o,a=e.split(""),s=r.minRange?r.minRange:85,u=r.maxRange?r.maxRange:115,c=0,l=Math.floor(a.length/(r.size?r.size:100));do{var d=(i=s,o=u,Math.floor(Math.random()*(o-i+1))+i);if(!(c+d<a.length))break;a.splice(c+d,0,t),c+=d+1,l-=1}while(l);return a.join("")},e.split=function r(e,t,n){void 0===t&&(t=":::"),void 0===n&&(n="=");var r={};return(""+e).split(t).forEach(function(e){var t=(""+e).split(n);r[t[0]]=t[1]}),r},e.replaceAt=function i(e,t,n){return t>e.length-1?e:e.substr(0,t)+n+e.substr(t+1)},e.multiEncode=function o(e,t){for(var n=0;n<t;n+=1)e=e.replace("\\","\\x5c");return e},e.truncate=function a(e,t){return e?e.substring(0,t):""}}(strings||(strings={})),function(e){e[e.Unknown=0]="Unknown",e[e.VAST=1]="VAST",e[e.JSTag=2]="JSTag",e[e.DISPLAY=3]="DISPLAY",e[e.VASTTags=4]="VASTTags",e[e.VMAP=5]="VMAP"}(TEST_MODE||(TEST_MODE={}));var global$1="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},lookup=[],revLookup=[],Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,inited=!1;function init(){inited=!0;for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,n=e.length;t<n;++t)lookup[t]=e[t],revLookup[e.charCodeAt(t)]=t;revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63}function toByteArray(e){var t,n,r,i,o,a;inited||init();var s=e.length;if(s%4>0)throw new Error("Invalid string. Length must be a multiple of 4");a=new Arr(3*s/4-(o="="===e[s-2]?2:"="===e[s-1]?1:0)),r=o>0?s-4:s;var u=0;for(t=0,n=0;t<r;t+=4,n+=3)i=revLookup[e.charCodeAt(t)]<<18|revLookup[e.charCodeAt(t+1)]<<12|revLookup[e.charCodeAt(t+2)]<<6|revLookup[e.charCodeAt(t+3)],a[u++]=i>>16&255,a[u++]=i>>8&255,a[u++]=255&i;return 2===o?(i=revLookup[e.charCodeAt(t)]<<2|revLookup[e.charCodeAt(t+1)]>>4,a[u++]=255&i):1===o&&(i=revLookup[e.charCodeAt(t)]<<10|revLookup[e.charCodeAt(t+1)]<<4|revLookup[e.charCodeAt(t+2)]>>2,a[u++]=i>>8&255,a[u++]=255&i),a}function tripletToBase64(e){return lookup[e>>18&63]+lookup[e>>12&63]+lookup[e>>6&63]+lookup[63&e]}function encodeChunk(e,t,n){for(var r=[],i=t;i<n;i+=3)r.push(tripletToBase64((e[i]<<16)+(e[i+1]<<8)+e[i+2]));return r.join("")}function fromByteArray(e){var t;inited||init();for(var n=e.length,r=n%3,i="",o=[],a=0,s=n-r;a<s;a+=16383)o.push(encodeChunk(e,a,a+16383>s?s:a+16383));return 1===r?(i+=lookup[(t=e[n-1])>>2],i+=lookup[t<<4&63],i+="=="):2===r&&(i+=lookup[(t=(e[n-2]<<8)+e[n-1])>>10],i+=lookup[t>>4&63],i+=lookup[t<<2&63],i+="="),o.push(i),o.join("")}function read(e,t,n,r,i){var o,a,s=8*i-r-1,u=(1<<s)-1,c=u>>1,l=-7,d=n?i-1:0,f=n?-1:1,p=e[t+d];for(d+=f,o=p&(1<<-l)-1,p>>=-l,l+=s;l>0;o=256*o+e[t+d],d+=f,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+e[t+d],d+=f,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,r),o-=c}return(p?-1:1)*a*Math.pow(2,o-r)}function write(e,t,n,r,i,o){var a,s,u,c=8*o-i-1,l=(1<<c)-1,d=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,h=r?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),(t+=a+d>=1?f/u:f*Math.pow(2,1-d))*u>=2&&(a++,u/=2),a+d>=l?(s=0,a=l):a+d>=1?(s=(t*u-1)*Math.pow(2,i),a+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,i),a=0));i>=8;e[n+p]=255&s,p+=h,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;e[n+p]=255&a,p+=h,a/=256,c-=8);e[n+p-h]|=128*g}var toString$1={}.toString,isArray=Array.isArray||function(e){return"[object Array]"==toString$1.call(e)},INSPECT_MAX_BYTES=50;Buffer.TYPED_ARRAY_SUPPORT=void 0===global$1.TYPED_ARRAY_SUPPORT||global$1.TYPED_ARRAY_SUPPORT;var _kMaxLength=kMaxLength();function kMaxLength(){return Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function createBuffer(e,t){if(kMaxLength()<t)throw new RangeError("Invalid typed array length");return Buffer.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=Buffer.prototype:(null===e&&(e=new Buffer(t)),e.length=t),e}function Buffer(e,t,n){if(!(Buffer.TYPED_ARRAY_SUPPORT||this instanceof Buffer))return new Buffer(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return allocUnsafe(this,e)}return from(this,e,t,n)}function from(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?fromArrayBuffer(e,t,n,r):"string"==typeof t?fromString(e,t,n):fromObject(e,t)}function assertSize(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function alloc(e,t,n,r){return assertSize(t),t<=0?createBuffer(e,t):void 0!==n?"string"==typeof r?createBuffer(e,t).fill(n,r):createBuffer(e,t).fill(n):createBuffer(e,t)}function allocUnsafe(e,t){if(assertSize(t),e=createBuffer(e,t<0?0:0|checked(t)),!Buffer.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function fromString(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!Buffer.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|byteLength(t,n),i=(e=createBuffer(e,r)).write(t,n);return i!==r&&(e=e.slice(0,i)),e}function fromArrayLike(e,t){var n=t.length<0?0:0|checked(t.length);e=createBuffer(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function fromArrayBuffer(e,t,n,r){if(n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),Buffer.TYPED_ARRAY_SUPPORT?(e=t).__proto__=Buffer.prototype:e=fromArrayLike(e,t),e}function fromObject(e,t){if(internalIsBuffer(t)){var n=0|checked(t.length);return 0===(e=createBuffer(e,n)).length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||isnan(t.length)?createBuffer(e,0):fromArrayLike(e,t);if("Buffer"===t.type&&isArray(t.data))return fromArrayLike(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function checked(e){if(e>=kMaxLength())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength().toString(16)+" bytes");return 0|e}function SlowBuffer(e){return+e!=e&&(e=0),Buffer.alloc(+e)}function internalIsBuffer(e){return!(null==e||!e._isBuffer)}function byteLength(e,t){if(internalIsBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return utf8ToBytes(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return base64ToBytes(e).length;default:if(r)return utf8ToBytes(e).length;t=(""+t).toLowerCase(),r=!0}}function slowToString(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return hexSlice(this,t,n);case"utf8":case"utf-8":return utf8Slice(this,t,n);case"ascii":return asciiSlice(this,t,n);case"latin1":case"binary":return latin1Slice(this,t,n);case"base64":return base64Slice(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function swap(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function bidirectionalIndexOf(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=Buffer.from(t,r)),internalIsBuffer(t))return 0===t.length?-1:arrayIndexOf(e,t,n,r,i);if("number"==typeof t)return t&=255,Buffer.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):arrayIndexOf(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(e,t,n,r,i){var o,a=1,s=e.length,u=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,u/=2,n/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var l=-1;for(o=n;o<s;o++)if(c(e,o)===c(t,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===u)return l*a}else-1!==l&&(o-=o-l),l=-1}else for(n+u>s&&(n=s-u),o=n;o>=0;o--){for(var d=!0,f=0;f<u;f++)if(c(e,o+f)!==c(t,f)){d=!1;break}if(d)return o}return-1}function hexWrite(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var a=0;a<r;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[n+a]=s}return a}function utf8Write(e,t,n,r){return blitBuffer(utf8ToBytes(t,e.length-n),e,n,r)}function asciiWrite(e,t,n,r){return blitBuffer(asciiToBytes(t),e,n,r)}function latin1Write(e,t,n,r){return asciiWrite(e,t,n,r)}function base64Write(e,t,n,r){return blitBuffer(base64ToBytes(t),e,n,r)}function ucs2Write(e,t,n,r){return blitBuffer(utf16leToBytes(t,e.length-n),e,n,r)}function base64Slice(e,t,n){return fromByteArray(0===t&&n===e.length?e:e.slice(t,n))}function utf8Slice(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,a,s,u,c=e[i],l=null,d=c>239?4:c>223?3:c>191?2:1;if(i+d<=n)switch(d){case 1:c<128&&(l=c);break;case 2:128==(192&(o=e[i+1]))&&(u=(31&c)<<6|63&o)>127&&(l=u);break;case 3:a=e[i+2],128==(192&(o=e[i+1]))&&128==(192&a)&&(u=(15&c)<<12|(63&o)<<6|63&a)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:a=e[i+2],s=e[i+3],128==(192&(o=e[i+1]))&&128==(192&a)&&128==(192&s)&&(u=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&u<1114112&&(l=u)}null===l?(l=65533,d=1):l>65535&&(r.push((l-=65536)>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=d}return decodeCodePointsArray(r)}Buffer.poolSize=8192,Buffer._augment=function(e){return e.__proto__=Buffer.prototype,e},Buffer.from=function(e,t,n){return from(null,e,t,n)},Buffer.TYPED_ARRAY_SUPPORT&&(Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array),Buffer.alloc=function(e,t,n){return alloc(null,e,t,n)},Buffer.allocUnsafe=function(e){return allocUnsafe(null,e)},Buffer.allocUnsafeSlow=function(e){return allocUnsafe(null,e)},Buffer.isBuffer=isBuffer,Buffer.compare=function e(t,n){if(!internalIsBuffer(t)||!internalIsBuffer(n))throw new TypeError("Arguments must be Buffers");if(t===n)return 0;for(var r=t.length,i=n.length,o=0,a=Math.min(r,i);o<a;++o)if(t[o]!==n[o]){r=t[o],i=n[o];break}return r<i?-1:i<r?1:0},Buffer.isEncoding=function e(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function e(t,n){if(!isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return Buffer.alloc(0);var r;if(void 0===n)for(n=0,r=0;r<t.length;++r)n+=t[r].length;var i=Buffer.allocUnsafe(n),o=0;for(r=0;r<t.length;++r){var a=t[r];if(!internalIsBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(i,o),o+=a.length}return i},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function e(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var n=0;n<t;n+=2)swap(this,n,n+1);return this},Buffer.prototype.swap32=function e(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var n=0;n<t;n+=4)swap(this,n,n+3),swap(this,n+1,n+2);return this},Buffer.prototype.swap64=function e(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var n=0;n<t;n+=8)swap(this,n,n+7),swap(this,n+1,n+6),swap(this,n+2,n+5),swap(this,n+3,n+4);return this},Buffer.prototype.toString=function e(){var t=0|this.length;return 0===t?"":0===arguments.length?utf8Slice(this,0,t):slowToString.apply(this,arguments)},Buffer.prototype.equals=function e(t){if(!internalIsBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===Buffer.compare(this,t)},Buffer.prototype.inspect=function e(){var t="",n=INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},Buffer.prototype.compare=function e(t,n,r,i,o){if(!internalIsBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===n&&(n=0),void 0===r&&(r=t?t.length:0),void 0===i&&(i=0),void 0===o&&(o=this.length),n<0||r>t.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&n>=r)return 0;if(i>=o)return-1;if(n>=r)return 1;if(n>>>=0,r>>>=0,i>>>=0,o>>>=0,this===t)return 0;for(var a=o-i,s=r-n,u=Math.min(a,s),c=this.slice(i,o),l=t.slice(n,r),d=0;d<u;++d)if(c[d]!==l[d]){a=c[d],s=l[d];break}return a<s?-1:s<a?1:0},Buffer.prototype.includes=function e(t,n,r){return-1!==this.indexOf(t,n,r)},Buffer.prototype.indexOf=function e(t,n,r){return bidirectionalIndexOf(this,t,n,r,!0)},Buffer.prototype.lastIndexOf=function e(t,n,r){return bidirectionalIndexOf(this,t,n,r,!1)},Buffer.prototype.write=function e(t,n,r,i){if(void 0===n)i="utf8",r=this.length,n=0;else if(void 0===r&&"string"==typeof n)i=n,r=this.length,n=0;else{if(!isFinite(n))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");n|=0,isFinite(r)?(r|=0,void 0===i&&(i="utf8")):(i=r,r=void 0)}var o=this.length-n;if((void 0===r||r>o)&&(r=o),t.length>0&&(r<0||n<0)||n>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var a=!1;;)switch(i){case"hex":return hexWrite(this,t,n,r);case"utf8":case"utf-8":return utf8Write(this,t,n,r);case"ascii":return asciiWrite(this,t,n,r);case"latin1":case"binary":return latin1Write(this,t,n,r);case"base64":return base64Write(this,t,n,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,t,n,r);default:if(a)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),a=!0}},Buffer.prototype.toJSON=function e(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(e){var t=e.length;if(t<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=MAX_ARGUMENTS_LENGTH));return n}function asciiSlice(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function latin1Slice(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function hexSlice(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=toHex(e[o]);return i}function utf16leSlice(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function checkOffset(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function checkInt(e,t,n,r,i,o){if(!internalIsBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function objectWriteUInt16(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);i<o;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function objectWriteUInt32(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);i<o;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function checkIEEE754(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function writeFloat(e,t,n,r,i){return i||checkIEEE754(e,t,n,4,3.4028234663852886e38,-3.4028234663852886e38),write(e,t,n,r,23,4),n+4}function writeDouble(e,t,n,r,i){return i||checkIEEE754(e,t,n,8,1.7976931348623157e308,-1.7976931348623157e308),write(e,t,n,r,52,8),n+8}Buffer.prototype.slice=function e(t,n){var r,i=this.length;if(t=~~t,n=void 0===n?i:~~n,t<0?(t+=i)<0&&(t=0):t>i&&(t=i),n<0?(n+=i)<0&&(n=0):n>i&&(n=i),n<t&&(n=t),Buffer.TYPED_ARRAY_SUPPORT)(r=this.subarray(t,n)).__proto__=Buffer.prototype;else{var o=n-t;r=new Buffer(o,void 0);for(var a=0;a<o;++a)r[a]=this[a+t]}return r},Buffer.prototype.readUIntLE=function e(t,n,r){t|=0,n|=0,r||checkOffset(t,n,this.length);for(var i=this[t],o=1,a=0;++a<n&&(o*=256);)i+=this[t+a]*o;return i},Buffer.prototype.readUIntBE=function e(t,n,r){t|=0,n|=0,r||checkOffset(t,n,this.length);for(var i=this[t+--n],o=1;n>0&&(o*=256);)i+=this[t+--n]*o;return i},Buffer.prototype.readUInt8=function e(t,n){return n||checkOffset(t,1,this.length),this[t]},Buffer.prototype.readUInt16LE=function e(t,n){return n||checkOffset(t,2,this.length),this[t]|this[t+1]<<8},Buffer.prototype.readUInt16BE=function e(t,n){return n||checkOffset(t,2,this.length),this[t]<<8|this[t+1]},Buffer.prototype.readUInt32LE=function e(t,n){return n||checkOffset(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},Buffer.prototype.readUInt32BE=function e(t,n){return n||checkOffset(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},Buffer.prototype.readIntLE=function e(t,n,r){t|=0,n|=0,r||checkOffset(t,n,this.length);for(var i=this[t],o=1,a=0;++a<n&&(o*=256);)i+=this[t+a]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*n)),i},Buffer.prototype.readIntBE=function e(t,n,r){t|=0,n|=0,r||checkOffset(t,n,this.length);for(var i=n,o=1,a=this[t+--i];i>0&&(o*=256);)a+=this[t+--i]*o;return a>=(o*=128)&&(a-=Math.pow(2,8*n)),a},Buffer.prototype.readInt8=function e(t,n){return n||checkOffset(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},Buffer.prototype.readInt16LE=function e(t,n){n||checkOffset(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},Buffer.prototype.readInt16BE=function e(t,n){n||checkOffset(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},Buffer.prototype.readInt32LE=function e(t,n){return n||checkOffset(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},Buffer.prototype.readInt32BE=function e(t,n){return n||checkOffset(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},Buffer.prototype.readFloatLE=function e(t,n){return n||checkOffset(t,4,this.length),read(this,t,!0,23,4)},Buffer.prototype.readFloatBE=function e(t,n){return n||checkOffset(t,4,this.length),read(this,t,!1,23,4)},Buffer.prototype.readDoubleLE=function e(t,n){return n||checkOffset(t,8,this.length),read(this,t,!0,52,8)},Buffer.prototype.readDoubleBE=function e(t,n){return n||checkOffset(t,8,this.length),read(this,t,!1,52,8)},Buffer.prototype.writeUIntLE=function e(t,n,r,i){t=+t,n|=0,r|=0,i||checkInt(this,t,n,r,Math.pow(2,8*r)-1,0);var o=1,a=0;for(this[n]=255&t;++a<r&&(o*=256);)this[n+a]=t/o&255;return n+r},Buffer.prototype.writeUIntBE=function e(t,n,r,i){t=+t,n|=0,r|=0,i||checkInt(this,t,n,r,Math.pow(2,8*r)-1,0);var o=r-1,a=1;for(this[n+o]=255&t;--o>=0&&(a*=256);)this[n+o]=t/a&255;return n+r},Buffer.prototype.writeUInt8=function e(t,n,r){return t=+t,n|=0,r||checkInt(this,t,n,1,255,0),Buffer.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[n]=255&t,n+1},Buffer.prototype.writeUInt16LE=function e(t,n,r){return t=+t,n|=0,r||checkInt(this,t,n,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8):objectWriteUInt16(this,t,n,!0),n+2},Buffer.prototype.writeUInt16BE=function e(t,n,r){return t=+t,n|=0,r||checkInt(this,t,n,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[n]=t>>>8,this[n+1]=255&t):objectWriteUInt16(this,t,n,!1),n+2},Buffer.prototype.writeUInt32LE=function e(t,n,r){return t=+t,n|=0,r||checkInt(this,t,n,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[n+3]=t>>>24,this[n+2]=t>>>16,this[n+1]=t>>>8,this[n]=255&t):objectWriteUInt32(this,t,n,!0),n+4},Buffer.prototype.writeUInt32BE=function e(t,n,r){return t=+t,n|=0,r||checkInt(this,t,n,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=255&t):objectWriteUInt32(this,t,n,!1),n+4},Buffer.prototype.writeIntLE=function e(t,n,r,i){if(t=+t,n|=0,!i){var o=Math.pow(2,8*r-1);checkInt(this,t,n,r,o-1,-o)}var a=0,s=1,u=0;for(this[n]=255&t;++a<r&&(s*=256);)t<0&&0===u&&0!==this[n+a-1]&&(u=1),this[n+a]=(t/s>>0)-u&255;return n+r},Buffer.prototype.writeIntBE=function e(t,n,r,i){if(t=+t,n|=0,!i){var o=Math.pow(2,8*r-1);checkInt(this,t,n,r,o-1,-o)}var a=r-1,s=1,u=0;for(this[n+a]=255&t;--a>=0&&(s*=256);)t<0&&0===u&&0!==this[n+a+1]&&(u=1),this[n+a]=(t/s>>0)-u&255;return n+r},Buffer.prototype.writeInt8=function e(t,n,r){return t=+t,n|=0,r||checkInt(this,t,n,1,127,-128),Buffer.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[n]=255&t,n+1},Buffer.prototype.writeInt16LE=function e(t,n,r){return t=+t,n|=0,r||checkInt(this,t,n,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8):objectWriteUInt16(this,t,n,!0),n+2},Buffer.prototype.writeInt16BE=function e(t,n,r){return t=+t,n|=0,r||checkInt(this,t,n,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[n]=t>>>8,this[n+1]=255&t):objectWriteUInt16(this,t,n,!1),n+2},Buffer.prototype.writeInt32LE=function e(t,n,r){return t=+t,n|=0,r||checkInt(this,t,n,4,2147483647,-2147483648),Buffer.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8,this[n+2]=t>>>16,this[n+3]=t>>>24):objectWriteUInt32(this,t,n,!0),n+4},Buffer.prototype.writeInt32BE=function e(t,n,r){return t=+t,n|=0,r||checkInt(this,t,n,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),Buffer.TYPED_ARRAY_SUPPORT?(this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=255&t):objectWriteUInt32(this,t,n,!1),n+4},Buffer.prototype.writeFloatLE=function e(t,n,r){return writeFloat(this,t,n,!0,r)},Buffer.prototype.writeFloatBE=function e(t,n,r){return writeFloat(this,t,n,!1,r)},Buffer.prototype.writeDoubleLE=function e(t,n,r){return writeDouble(this,t,n,!0,r)},Buffer.prototype.writeDoubleBE=function e(t,n,r){return writeDouble(this,t,n,!1,r)},Buffer.prototype.copy=function e(t,n,r,i){if(r||(r=0),i||0===i||(i=this.length),n>=t.length&&(n=t.length),n||(n=0),i>0&&i<r&&(i=r),i===r)return 0;if(0===t.length||0===this.length)return 0;if(n<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-n<i-r&&(i=t.length-n+r);var o,a=i-r;if(this===t&&r<n&&n<i)for(o=a-1;o>=0;--o)t[o+n]=this[o+r];else if(a<1e3||!Buffer.TYPED_ARRAY_SUPPORT)for(o=0;o<a;++o)t[o+n]=this[o+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+a),n);return a},Buffer.prototype.fill=function e(t,n,r,i){if("string"==typeof t){if("string"==typeof n?(i=n,n=0,r=this.length):"string"==typeof r&&(i=r,r=this.length),1===t.length){var o=t.charCodeAt(0);o<256&&(t=o)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!Buffer.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof t&&(t&=255);if(n<0||this.length<n||this.length<r)throw new RangeError("Out of range index");if(r<=n)return this;var a;if(n>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(a=n;a<r;++a)this[a]=t;else{var s=internalIsBuffer(t)?t:utf8ToBytes(new Buffer(t,i).toString()),u=s.length;for(a=0;a<r-n;++a)this[a+n]=s[a%u]}return this};var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g;function base64clean(e){if((e=stringtrim(e).replace(INVALID_BASE64_RE,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}function stringtrim(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function toHex(e){return e<16?"0"+e.toString(16):e.toString(16)}function utf8ToBytes(e,t){var n;t=t||1/0;for(var r=e.length,i=null,o=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function asciiToBytes(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function utf16leToBytes(e,t){for(var n,r,i=[],o=0;o<e.length&&!((t-=2)<0);++o)r=(n=e.charCodeAt(o))>>8,i.push(n%256),i.push(r);return i}function base64ToBytes(e){return toByteArray(base64clean(e))}function blitBuffer(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function isnan(e){return e!=e}function isBuffer(e){return null!=e&&(!!e._isBuffer||isFastBuffer(e)||isSlowBuffer(e))}function isFastBuffer(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function isSlowBuffer(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&isFastBuffer(e.slice(0,0))}var _buffer=Object.freeze({INSPECT_MAX_BYTES:INSPECT_MAX_BYTES,kMaxLength:_kMaxLength,Buffer:Buffer,SlowBuffer:SlowBuffer,isBuffer:isBuffer});function b64Encode(e){return e&&"string"==typeof e?"function"==typeof btoa?encodeWithBTOA(e):Buffer.from(e).toString("base64"):""}function encodeWithBTOA(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function e(t,n){return String.fromCharCode(parseInt("0x"+n,16))}))}function generateEntrophy(e,t){for(var n=[],r=0;r<t;r++)n[r]=Math.floor(Math.random()*e);return n}function entropyHourlyRotator(e,t){for(var n=~~((new Date).getTime()/36e5),r=[],i=0;i<t;i+=1)r.push((n+i)%e);return r}function getEntropy(e,t){for(var n=[],r=0;r<e.length;r+=1)n[r]=t.indexOf(e.charAt(r));return n}var b64enc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",entropy64=generateEntrophy(64,4),fixedEntropy64=entropyHourlyRotator(64,4);function obfu(e,t,n){for(var r="string"==typeof n?getEntropy(n,t):n,i=r.length,o=t.length,a="",s=0;s<e.length;s++){var u=r[s%i],c=t.indexOf(e.charAt(s));a+=t.charAt((c+u)%o)}for(s=0;s<i;s++)a+=t.charAt(r[s]);return a}function cleanB64String(e){return b64Encode(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function obfuscate(e,t){return obfu(cleanB64String(e),b64enc,t?fixedEntropy64:entropy64)}function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}var cachedSetTimeout=defaultSetTimout,cachedClearTimeout=defaultClearTimeout;function runTimeout(e){if(cachedSetTimeout===setTimeout)return setTimeout(e,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(e,0);try{return cachedSetTimeout(e,0)}catch(t){try{return cachedSetTimeout.call(null,e,0)}catch(t){return cachedSetTimeout.call(this,e,0)}}}function runClearTimeout(e){if(cachedClearTimeout===clearTimeout)return clearTimeout(e);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(e);try{return cachedClearTimeout(e)}catch(t){try{return cachedClearTimeout.call(null,e)}catch(t){return cachedClearTimeout.call(this,e)}}}"function"==typeof global$1.setTimeout&&(cachedSetTimeout=setTimeout),"function"==typeof global$1.clearTimeout&&(cachedClearTimeout=clearTimeout);var queue=[],draining=!1,currentQueue,queueIndex=-1;function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var e=runTimeout(cleanUpNextTick);draining=!0;for(var t=queue.length;t;){for(currentQueue=queue,queue=[];++queueIndex<t;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,t=queue.length}currentQueue=null,draining=!1,runClearTimeout(e)}}function nextTick(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];queue.push(new Item(e,t)),1!==queue.length||draining||runTimeout(drainQueue)}function Item(e,t){this.fun=e,this.array=t}Item.prototype.run=function(){this.fun.apply(null,this.array)};var title="browser",platform="browser",browser=!0,env={},argv=[],version="",versions={},release={},config={};function noop(){}var on=noop,addListener=noop,once=noop,off=noop,removeListener=noop,removeAllListeners=noop,emit=noop;function binding(e){throw new Error("process.binding is not supported")}function cwd(){return"/"}function chdir(e){throw new Error("process.chdir is not supported")}function umask(){return 0}var performance=global$1.performance||{},performanceNow=performance.now||performance.mozNow||performance.msNow||performance.oNow||performance.webkitNow||function(){return(new Date).getTime()};function hrtime(e){var t=.001*performanceNow.call(performance),n=Math.floor(t),r=Math.floor(t%1*1e9);return e&&(n-=e[0],(r-=e[1])<0&&(n--,r+=1e9)),[n,r]}var startTime=new Date;function uptime(){return(new Date-startTime)/1e3}var process={nextTick:nextTick,title:title,browser:browser,env:env,argv:argv,version:version,versions:versions,on:on,addListener:addListener,once:once,off:off,removeListener:removeListener,removeAllListeners:removeAllListeners,emit:emit,binding:binding,cwd:cwd,chdir:chdir,umask:umask,hrtime:hrtime,platform:platform,release:release,config:config,uptime:uptime},base32=createCommonjsModule(function(e){
/*
         * [hi-base32]{@link https://github.com/emn178/hi-base32}
         *
         * @version 0.3.0
         * @author Chen, Yi-Cyuan [emn178@gmail.com]
         * @copyright Chen, Yi-Cyuan 2015-2017
         * @license MIT
         */
!function(){var t="object"==typeof window?window:{};!t.HI_BASE32_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node&&(t=commonjsGlobal);var n=!t.HI_BASE32_NO_COMMON_JS&&e.exports,r="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567".split(""),i={A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,O:14,P:15,Q:16,R:17,S:18,T:19,U:20,V:21,W:22,X:23,Y:24,Z:25,2:26,3:27,4:28,5:29,6:30,7:31},o=[0,0,0,0,0,0,0,0],a=function(e){for(var t,n,r,o,a,s,u,c,l=[],d=0,f=(e=e.replace(/=/g,"")).length,p=0,h=f>>3<<3;p<h;)t=i[e.charAt(p++)],n=i[e.charAt(p++)],r=i[e.charAt(p++)],o=i[e.charAt(p++)],a=i[e.charAt(p++)],s=i[e.charAt(p++)],u=i[e.charAt(p++)],c=i[e.charAt(p++)],l[d++]=255&(t<<3|n>>>2),l[d++]=255&(n<<6|r<<1|o>>>4),l[d++]=255&(o<<4|a>>>1),l[d++]=255&(a<<7|s<<2|u>>>3),l[d++]=255&(u<<5|c);var g=f-h;return 2===g?(t=i[e.charAt(p++)],n=i[e.charAt(p++)],l[d++]=255&(t<<3|n>>>2)):4===g?(t=i[e.charAt(p++)],n=i[e.charAt(p++)],r=i[e.charAt(p++)],o=i[e.charAt(p++)],l[d++]=255&(t<<3|n>>>2),l[d++]=255&(n<<6|r<<1|o>>>4)):5===g?(t=i[e.charAt(p++)],n=i[e.charAt(p++)],r=i[e.charAt(p++)],o=i[e.charAt(p++)],a=i[e.charAt(p++)],l[d++]=255&(t<<3|n>>>2),l[d++]=255&(n<<6|r<<1|o>>>4),l[d++]=255&(o<<4|a>>>1)):7===g&&(t=i[e.charAt(p++)],n=i[e.charAt(p++)],r=i[e.charAt(p++)],o=i[e.charAt(p++)],a=i[e.charAt(p++)],s=i[e.charAt(p++)],u=i[e.charAt(p++)],l[d++]=255&(t<<3|n>>>2),l[d++]=255&(n<<6|r<<1|o>>>4),l[d++]=255&(o<<4|a>>>1),l[d++]=255&(a<<7|s<<2|u>>>3)),l},s=function(e,t){if(!t)return function(e){for(var t,n,r="",i=e.length,o=0,a=0;o<i;)if((t=e[o++])<=127)r+=String.fromCharCode(t);else{if(t>191&&t<=223)n=31&t,a=1;else if(t<=239)n=15&t,a=2;else{if(!(t<=247))throw"not a UTF-8 string";n=7&t,a=3}for(var s=0;s<a;++s){if((t=e[o++])<128||t>191)throw"not a UTF-8 string";n<<=6,n+=63&t}if(n>=55296&&n<=57343)throw"not a UTF-8 string";if(n>1114111)throw"not a UTF-8 string";n<=65535?r+=String.fromCharCode(n):(n-=65536,r+=String.fromCharCode(55296+(n>>10)),r+=String.fromCharCode(56320+(1023&n)))}return r}(a(e));var n,r,o,s,u,c,l,d,f="",p=e.indexOf("=");-1===p&&(p=e.length);for(var h=0,g=p>>3<<3;h<g;)n=i[e.charAt(h++)],r=i[e.charAt(h++)],o=i[e.charAt(h++)],s=i[e.charAt(h++)],u=i[e.charAt(h++)],c=i[e.charAt(h++)],l=i[e.charAt(h++)],d=i[e.charAt(h++)],f+=String.fromCharCode(255&(n<<3|r>>>2))+String.fromCharCode(255&(r<<6|o<<1|s>>>4))+String.fromCharCode(255&(s<<4|u>>>1))+String.fromCharCode(255&(u<<7|c<<2|l>>>3))+String.fromCharCode(255&(l<<5|d));var E=p-g;return 2===E?(n=i[e.charAt(h++)],r=i[e.charAt(h++)],f+=String.fromCharCode(255&(n<<3|r>>>2))):4===E?(n=i[e.charAt(h++)],r=i[e.charAt(h++)],o=i[e.charAt(h++)],s=i[e.charAt(h++)],f+=String.fromCharCode(255&(n<<3|r>>>2))+String.fromCharCode(255&(r<<6|o<<1|s>>>4))):5===E?(n=i[e.charAt(h++)],r=i[e.charAt(h++)],o=i[e.charAt(h++)],s=i[e.charAt(h++)],u=i[e.charAt(h++)],f+=String.fromCharCode(255&(n<<3|r>>>2))+String.fromCharCode(255&(r<<6|o<<1|s>>>4))+String.fromCharCode(255&(s<<4|u>>>1))):7===E&&(n=i[e.charAt(h++)],r=i[e.charAt(h++)],o=i[e.charAt(h++)],s=i[e.charAt(h++)],u=i[e.charAt(h++)],c=i[e.charAt(h++)],l=i[e.charAt(h++)],f+=String.fromCharCode(255&(n<<3|r>>>2))+String.fromCharCode(255&(r<<6|o<<1|s>>>4))+String.fromCharCode(255&(s<<4|u>>>1))+String.fromCharCode(255&(u<<7|c<<2|l>>>3))),f},u={encode:function(e,t){var n="string"!=typeof e;return n&&e.constructor===ArrayBuffer&&(e=new Uint8Array(e)),n?function(e){for(var t,n,i,o,a,s="",u=e.length,c=0,l=5*parseInt(u/5);c<l;)t=e[c++],n=e[c++],i=e[c++],o=e[c++],a=e[c++],s+=r[t>>>3]+r[31&(t<<2|n>>>6)]+r[n>>>1&31]+r[31&(n<<4|i>>>4)]+r[31&(i<<1|o>>>7)]+r[o>>>2&31]+r[31&(o<<3|a>>>5)]+r[31&a];var d=u-l;return 1===d?s+=r[(t=e[c])>>>3]+r[t<<2&31]+"======":2===d?(t=e[c++],s+=r[t>>>3]+r[31&(t<<2|(n=e[c])>>>6)]+r[n>>>1&31]+r[n<<4&31]+"===="):3===d?(t=e[c++],n=e[c++],s+=r[t>>>3]+r[31&(t<<2|n>>>6)]+r[n>>>1&31]+r[31&(n<<4|(i=e[c])>>>4)]+r[i<<1&31]+"==="):4===d&&(t=e[c++],n=e[c++],i=e[c++],s+=r[t>>>3]+r[31&(t<<2|n>>>6)]+r[n>>>1&31]+r[31&(n<<4|i>>>4)]+r[31&(i<<1|(o=e[c])>>>7)]+r[o>>>2&31]+r[o<<3&31]+"="),s}(e):t?function(e){for(var t,n,i,o,a,s="",u=e.length,c=0,l=5*parseInt(u/5);c<l;)t=e.charCodeAt(c++),n=e.charCodeAt(c++),i=e.charCodeAt(c++),o=e.charCodeAt(c++),a=e.charCodeAt(c++),s+=r[t>>>3]+r[31&(t<<2|n>>>6)]+r[n>>>1&31]+r[31&(n<<4|i>>>4)]+r[31&(i<<1|o>>>7)]+r[o>>>2&31]+r[31&(o<<3|a>>>5)]+r[31&a];var d=u-l;return 1===d?(t=e.charCodeAt(c),s+=r[t>>>3]+r[t<<2&31]+"======"):2===d?(t=e.charCodeAt(c++),n=e.charCodeAt(c),s+=r[t>>>3]+r[31&(t<<2|n>>>6)]+r[n>>>1&31]+r[n<<4&31]+"===="):3===d?(t=e.charCodeAt(c++),n=e.charCodeAt(c++),i=e.charCodeAt(c),s+=r[t>>>3]+r[31&(t<<2|n>>>6)]+r[n>>>1&31]+r[31&(n<<4|i>>>4)]+r[i<<1&31]+"==="):4===d&&(t=e.charCodeAt(c++),n=e.charCodeAt(c++),i=e.charCodeAt(c++),o=e.charCodeAt(c),s+=r[t>>>3]+r[31&(t<<2|n>>>6)]+r[n>>>1&31]+r[31&(n<<4|i>>>4)]+r[31&(i<<1|o>>>7)]+r[o>>>2&31]+r[o<<3&31]+"="),s}(e):function(e){var t,n,i,a,s,u,c,l=!1,d="",f=0,p=0,h=e.length;do{for(o[0]=o[5],o[1]=o[6],o[2]=o[7],c=p;f<h&&c<5;++f)(u=e.charCodeAt(f))<128?o[c++]=u:u<2048?(o[c++]=192|u>>6,o[c++]=128|63&u):u<55296||u>=57344?(o[c++]=224|u>>12,o[c++]=128|u>>6&63,o[c++]=128|63&u):(u=65536+((1023&u)<<10|1023&e.charCodeAt(++f)),o[c++]=240|u>>18,o[c++]=128|u>>12&63,o[c++]=128|u>>6&63,o[c++]=128|63&u);p=c-5,f===h&&++f,f>h&&c<6&&(l=!0),t=o[0],d+=c>4?r[t>>>3]+r[31&(t<<2|(n=o[1])>>>6)]+r[n>>>1&31]+r[31&(n<<4|(i=o[2])>>>4)]+r[31&(i<<1|(a=o[3])>>>7)]+r[a>>>2&31]+r[31&(a<<3|(s=o[4])>>>5)]+r[31&s]:1===c?r[t>>>3]+r[t<<2&31]+"======":2===c?r[t>>>3]+r[31&(t<<2|(n=o[1])>>>6)]+r[n>>>1&31]+r[n<<4&31]+"====":3===c?r[t>>>3]+r[31&(t<<2|(n=o[1])>>>6)]+r[n>>>1&31]+r[31&(n<<4|(i=o[2])>>>4)]+r[i<<1&31]+"===":r[t>>>3]+r[31&(t<<2|(n=o[1])>>>6)]+r[n>>>1&31]+r[31&(n<<4|(i=o[2])>>>4)]+r[31&(i<<1|(a=o[3])>>>7)]+r[a>>>2&31]+r[a<<3&31]+"="}while(!l);return d}(e)},decode:s};s.asBytes=a,n?e.exports=u:t.base32=u}()}),CSSEncoder;function getCSSPrefix(e,t,n){if(e===CSSEncoder.EncodeObfu){for(var r=(""+t/100).split("").map(function(e){return parseInt(e,10)}).reverse(),i=[],o=0;o<4;o+=1)i.push(b64enc[(r[o]+n)%52]);return i.join("")}return"x"}function isTrue(e){if("string"==typeof e){var t=(e||"").toLowerCase();return"true"===t||"1"===t}return!0===e||1===e}function isFalse(e){if("string"==typeof e){var t=(e||"").toLowerCase();return"false"===t||"0"===t}return!1===e||0===e}function parseNum(e,t){var n=+e;return isNaN(n)?t:n}function parseFunc(e,t){try{if(!e||"string"!=typeof e)return t;var n=new Function("return "+e)();if("function"==typeof n)return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];try{return n.apply(null,e)}catch(e){}return t.apply(null,e)}}catch(e){}return t}function httpsProto(e){return(e||[]).map(function(e){return 0===e.indexOf("//")?"https:"+e:e.replace("http:","https:")})}function updateCDNURL(e){Array.isArray(e.non_cf_cdn_urls)||(e.non_cf_cdn_urls=e.cdn_urls),e.cdn_urls=httpsProto(e.cdn_urls),e.non_cf_cdn_urls=httpsProto(e.non_cf_cdn_urls);var t=-1;return Object.defineProperties(e,{cdn_url:{get:function(){return e.cdn_urls[(t+=1)%e.cdn_urls.length]}},next_cdn_url:{get:function(){return e.cdn_urls[(t+1)%e.cdn_urls.length]}},non_cf_cdn_url:{get:function(){return e.non_cf_cdn_urls[(t+=1)%e.non_cf_cdn_urls.length]}},next_non_cf_cdn_url:{get:function(){return e.non_cf_cdn_urls[(t+1)%e.non_cf_cdn_urls.length]}}})}function parseOutputType(e){return"ima3"===e?2:1}function generateAdunitMeta(e,t,n){var r={},i=e.adUnitMeta[t];i&&["divID","loadcss","videoID"].forEach(function(e){r[e]=i[e]}),e.adUnitMeta[t]=Object.assign(r,n)}function generateAppMeta(e,t,n){var r=Object.assign({action:"",css_prefix:getCSSPrefix(t.css_encoder,t.time,t.site_id),ignoreObfuAttr:"mYxK",proxyFuncName:"$pxy",proxyOnlyAttr:"tUqi",pxyClass:"$ore",stack:"$JabK"},n);return Object.keys(r).forEach(function(t){try{switch(t){case"proxyReferrer":var n=new url.URL(r.proxyReferrer);r.proxyReferrer=n.origin+n.pathname+n.search;break;case"proxyLocation":r.proxyLocation=new url.URL(r.proxyLocation,e.location.href);break;case"ancestorOrigins":r.ancestorOrigins=parseAncestorOrigins(r.ancestorOrigins)}}catch(e){}}),r}function transformJSAppOptions(e){(e=updateCDNURL(e)).b=parseNum(e.b,0),e.boostrap_version=strings.truncate(getBootstrapVersion(window,e.site_uuid),255),e.debug=isTrue(e.debug),e.qy=isTrue(e.qy),e.subscription_type=+e.subscription_type,e.start_onload=isTrue(e.start_onload),e.scripts_onload=isTrue(e.scripts_onload),e.display_onload=isTrue(e.display_onload),e.pagehref_watcher_type=+e.pagehref_watcher_type,e.pagehref_watcher_func=parseFunc(e.pagehref_watcher_func,function(e){return!1}),e.test_mode=parseTestMode(""+e.test_mode),e.no_tiny=isTrue(e.no_tiny),e.site_id=+e.site_id,e.path_encode=parseFunc(e.path_encode,function(e,t){return t}),e.domain_id=+e.domain_id,e.pxy_write_buffer=isTrue(e.pxy_write_buffer),e.console_disable=isTrue(e.console_disable),e.css_encoder=parseNum(e.css_encoder,2);var t={"www.facebook.com":!0};return(e.cdn_urls||[]).forEach(function(e){var n=url.extractDomain(e);n&&(t[n]=!0)}),(e.non_cf_cdn_urls||[]).forEach(function(e){var n=url.extractDomain(e);n&&(t[n]=!0)}),e.domains=Object.keys(t),e}function getIJSAppOptions(e){return transformJSAppOptions(Object.assign({b:'1',cdn_urls:["//rtbbixt.oby.journaldugeek.com","//rocvruuwq.oby.journaldugeek.com","//trzrhdp.oby.journaldugeek.com"],non_cf_cdn_urls:null,debug:'0',qy:'0',js_app_version:'2018.07.28-11.00-0b2ffa3',publisher_uuid:'a0b50b33-f4c0-4434-98b3-339718cbcb57',site_uuid:'af50c907-263b-4d95-9fa7-492d4fe7fd23',subscription_type:'2',start_onload:'1',scripts_onload:'1',display_onload:'1',pagehref_watcher_type:'0',pagehref_watcher_func:"",test_mode:"##TEST_MODE##",no_tiny:'0',site_id:'490',path_encode:0,favicons:'apple.com facebook.com linkedin.com google.com microsoft.com adblockplus.org',bundle_type:1,domain_id:241,pxy_write_buffer:'0',console_disable:'1',css_encoder:'2',time:1532923200},e||{}))}function getIAdUnitOptions(){return([{"adunit_id":893,"ad_player":{"allow_fullscreen":false,"click_to_play":false,"css":"//rtbbixt.oby.journaldugeek.com/af50c907-263b-4d95-9fa7-492d4fe7fd23.css","height":0,"muted":true,"timeupdate_timeout":5000,"vpaid_controls":true,"vpaid_errorad_timeout":4000,"vpaid_initad_timeout":10000,"width":0},"adunit_uuid":"9bc098d7-1049-4f6c-a220-47ec5e834166","debug":false,"fb_placement_id":"","focus_check":false,"name":"","onload":"","position":202,"recovery_percentage":100,"selector":"","site_player":{"height":"","hide":"","pause":"","play":"","show":"","swap":"","type":"display-manual","width":""},"viewport_check":false,"watcher_func":"","waterfall":true,"selector_video":"","selector_adcontainer":"","custom_params_func":"","auto_ad":1,"play_ad_func":""}]||[]).map(function(e){return{adunit_id:parseNum(e.adunit_id,0),adunit_uuid:e.adunit_uuid,name:e.name,debug:isTrue(e.debug),fb_placement_id:e.fb_placement_id,onload:parseFunc(e.onload,function(){return!0}),position:parseNum(e.position,0),qy:isTrue(e.qy),recovery_percentage:parseNum(e.recovery_percentage,100),selector:e.selector,selector_video:(e.selector_video||"").trim(),selector_adcontainer:e.selector_adcontainer,viewport_check:isTrue(e.viewport_check),focus_check:isTrue(e.focus_check),waterfall:isTrue(e.waterfall),watcher_func:parseFunc(e.watcher_func,function(e){return!1}),custom_params_func:parseFunc(e.custom_params_func,function(e,t,n){return n}),play_ad_func:parseFunc(e.play_ad_func,function(e,t,n,r){r()}),output_type:parseOutputType(e.site_player.type),auto_ad:!isFalse(e.auto_ad),site_player:{height:e.site_player.height,hide:e.site_player.hide,pause:e.site_player.pause,swap:e.site_player.swap,play:e.site_player.play,show:e.site_player.show,type:e.site_player.type,width:e.site_player.width},ad_player:{click_to_play:isTrue(e.ad_player.click_to_play),width:e.ad_player.width||"",height:e.ad_player.height||"",muted:isTrue(e.ad_player.muted),allow_fullscreen:isTrue(e.ad_player.allow_fullscreen),vpaid_controls:isTrue(e.ad_player.vpaid_controls),timeupdate_timeout:parseNum(e.ad_player.timeupdate_timeout,1e4),vpaid_initad_timeout:parseNum(e.ad_player.vpaid_initad_timeout,1e4)},$adscript:e.$adscript,$backfillscript:e.$backfillscript}})}function getBootstrapVersion(e,t){return e.pAPI&&e.pAPI.$bs?e.pAPI.$bs:e[t+"-bs"]||"##BOOTSTRAP_VERSION##"}function initAppCache(e){if(!e[APP_CACHE]){var t=getIJSAppOptions(),n=getIAdUnitOptions();e[APP_CACHE]={adUnitOptions:n,adUnitMeta:{},options:t};var r=parseCfg(e)||{};if(r.domain&&-1===r.domain.indexOf("cloudfront"))try{e.document.domain=r.domain}catch(e){}e[APP_CACHE].appMeta=generateAppMeta(e,t,r),n.forEach(function(t){generateAdunitMeta(e[APP_CACHE],t.adunit_uuid)})}return e[APP_CACHE]}function parseAncestorOrigins(e){if(Array.isArray(e))return e;try{return JSON.parse(e)}catch(e){}return[]}!function(e){e[e.EncodeUndefined=0]="EncodeUndefined",e[e.EncodePlain=1]="EncodePlain",e[e.EncodeBase32=2]="EncodeBase32",e[e.EncodeBase64=3]="EncodeBase64",e[e.EncodeObfu=4]="EncodeObfu"}(CSSEncoder||(CSSEncoder={}));var APP_CACHE="$BxTy",ATTR_CFG="data-cYap",Debug;function parseCfg(e){try{var t=(e.document.querySelector("["+ATTR_CFG+"]")||e.document.head).getAttribute(ATTR_CFG);if(t)return JSON.parse(atob(t))}catch(e){}return null}function getAppCache(e){var t=getWin(e,function(e){if(e[APP_CACHE])return!0;if(e&&e.document&&parseCfg(e))return!0;try{if(e.parent&&e.parent.location.href)return!1}catch(e){return!0}return!1});return{cache:initAppCache(t),win:t}}function getPrefix(e){return e?"[PB] ["+e.adunit_uuid+"]":"[PB]"}function getMsg(e){return"function"==typeof e?e():e}function randomSort(){return~~(100*Math.random())-~~(100*Math.random())}!function(e){function t(e){var t=getAppCache(window).cache.options;return!!t&&t.debug||!!e&&e.debug}e.log=function n(e,r){t(r)&&console.log(getPrefix(r),getMsg(e))},e.warn=function r(e,n){t(n)&&console.warn(getPrefix(n),getMsg(e))},e.trace=function i(e,n){t(n)&&console.trace(getPrefix(n),getMsg(e))}}(Debug||(Debug={}));var MIN_IMAGE_FAILURE=2,MAX_IMAGE_LOAD_RETRY=5;function cachebusting(e){var t=inject(btoa(""+(new Date).getTime()).replace(/=/g,"").split("").sort(randomSort).join(""));return-1===e.indexOf("?")?e+"?"+t:e+"&"+t}function findSources(e,t){if(!e)return[];for(var n=[],r=0;r<e.length;r+=1){var i=e[r];"img"===(i.tagName||"").toLowerCase()?i.src&&("naturalHeight"in i?i.naturalHeight>0&&n.push(i.src):n.push(i.src)):"source"===(i.tagName||"").toLowerCase()&&i.srcset&&i.srcset.split(",").fortEach(function(e){(e=e.trim().split(" ")[0].trim())&&n.push(e)})}return n.sort(randomSort).concat(t)}function inject(e){var t=2+~~(Math.random()*(e.length-4));return e.substr(0,t)+"="+e.substr(t+1)}function findSource(e,t,n,r){if(t>e.length-1)r();else{var i=new Image;i.onload=function(){n(e[t])},i.onerror=function(){findSource(e,t+1,n,r)},i.src=cachebusting(e[t])}}function assertEvents(e,t,n,r,i,o){o>=MIN_IMAGE_FAILURE?n(i,o):i+o!==MAX_IMAGE_LOAD_RETRY?assertFlakyConnection(e,t,n,r+1,i,o):t(i,o)}function assertFlakyConnection(e,t,n,r,i,o){var a=new Image;a.onload=function(){assertEvents(e,t,n,r,i+1,o)},a.onerror=function(){assertEvents(e,t,n,r,i,o+1)},a.src=cachebusting(e)}var MSG_SUCCESS="network was successful",MSG_ERROR_NETWORK_FLAKY="error network is flaky",MSG_ERROR_NETWORK_DOWN="error network is down";function checkValidNetwork(e,t){findSource(e,0,function(e){assertFlakyConnection(e,function(e,n){t(!1,MSG_SUCCESS,e,n)},function(e,n){t(!0,MSG_ERROR_NETWORK_FLAKY,e,n)},0,0,0)},function(){t(!0,MSG_ERROR_NETWORK_DOWN,-1,-1)})}function parseHeartBeats(e){try{var t=JSON.parse(e);return Array.isArray(t)?t:t.data||[]}catch(e){}return[]}function checkCtrlAPI(e,t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.onreadystatechange=function(){if(4===n.readyState){var e=parseHeartBeats(n.responseText);if(!e||0===e.length)return t(new Error("Failed to check API status"),!1);for(var r=!0,i=0;i<e.length;i+=1)r=r&&!!e[i].healthy;return t(null,r)}},n.send()}function throttle(e,t){var n=0;return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];n||(t.apply(void 0,r),n=window.setTimeout(function(){window.clearTimeout(n),n=0},e))}}function execOn(e,t){e<0&&(e=1);var n=0;return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];(n+=1)===e&&t&&t.apply(void 0,r)}}function execOnce(e){return execOn(1,e)}function makeRandomId(e){for(var t="",n="abcdefghijklmnopqrstuvwxyz",r=0;r<e;r++)t+=n.charAt(Math.floor(Math.random()*n.length));return t}function setInterval$1(e,t){var n=window.setInterval(e,t);return function(){window.clearInterval(n)}}function hideElement(e){e.style.width="1px",e.style.height="1px",e.style.position="absolute",e.style.top="-100px",e.style.left="-100px"}var baitClass="pub_300x250 pub_300x250m pub_728x90 text-ad textAd text_ad text_ads text-ads text-ad-links",baitStyle="width: 1px !important; height: 1px !important; position: absolute !important; left: -10000px !important; top: -1000px !important;",baitId="google_ads_iframe_/12345678/mobile_top_300x250_0",MAX_ELEMENT_BAIT_LOOP=5;function generateIFrame(e){var t=e.document.createElement("iframe");return hideElement(t),e.document.body.appendChild(t),t}function checkHTMLElementBaitStyles(e,t){if(null!==e.document.body.getAttribute("abp")||null===t.offsetParent||0===t.offsetHeight||0===t.offsetLeft||0===t.offsetTop||0===t.offsetWidth||0===t.clientHeight||0===t.clientWidth)return!0;if(void 0!==e.getComputedStyle){var n=e.getComputedStyle(t);if(n&&("none"===n.getPropertyValue("display")||"hidden"===n.getPropertyValue("visibility")))return!0}return!1}function checkHTMLElementBait(e,t){var n=e.document.createElement("div");n.setAttribute("class",baitClass),n.setAttribute("style",baitStyle),e.document.body.appendChild(n);var r=0,i=setInterval(function(){try{if(checkHTMLElementBaitStyles(e,n))return clearInterval(i),n.parentElement&&n.parentElement.removeChild(n),void t(null,!0);(r+=1)>=MAX_ELEMENT_BAIT_LOOP&&(clearInterval(i),n.parentElement&&n.parentElement.removeChild(n),t(null,!1))}catch(e){clearInterval(i),n.parentElement&&n.parentElement.removeChild(n),t(e,!1)}},50)}function checkHTMLIframeElementBait(e,t){var n=e.document.createElement("iframe");n.setAttribute("id",baitId),e.document.body.appendChild(n);var r=0,i=setInterval(function(){try{if("none"===e.getComputedStyle(n).display)return clearInterval(i),n.parentElement&&n.parentElement.removeChild(n),void t(null,!0);(r+=1)>=MAX_ELEMENT_BAIT_LOOP&&(clearInterval(i),n.parentElement&&n.parentElement.removeChild(n),t(null,!1))}catch(e){clearInterval(i),n.parentElement&&n.parentElement.removeChild(n),t(e,!1)}},50)}function tryURL(e,t,n,r){void 0===n&&(n=0);var i=e.document.createElement("script");i.onload=function(){r(!1)},i.onerror=function(){n>=2?r(!0):tryURL(e,t,n+1,r)},i.src=cachebusting(t),e.document.body.appendChild(i)}function checkNetworkBait(e,t){var n=["https://static.doubleclick.net/instream/ad_status.js","https://imasdk.googleapis.com/js/sdkloader/ima3.js"],r=0,i=execOnce(t);n.forEach(function(t){try{tryURL(e,t,0,function(e){r+=1,e&&i(null,!0),r===n.length&&i(null,!1)})}catch(e){(r+=1)===n.length&&i(null,!1)}})}function waitForBody(e,t){e.document.body?t():setTimeout(function(){waitForBody(e,t)},100)}function detectAdblock(e,t){var n=execOnce(t);waitForBody(e,function(){var t=generateIFrame(e),r=0;function i(e,t){t&&n(null,t),3===(r+=1)&&n(e,t)}checkNetworkBait(t.contentWindow,function(e,n){t.parentElement&&t.parentElement.removeChild(t),i(e,n)}),checkHTMLElementBait(e,i),checkHTMLIframeElementBait(t.contentWindow,i)})}var js_cookie=createCommonjsModule(function(e,t){e.exports=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}return function t(n){function r(t,i,o){var a;if("undefined"!=typeof document){if(arguments.length>1){if("number"==typeof(o=e({path:"/"},r.defaults,o)).expires){var s=new Date;s.setMilliseconds(s.getMilliseconds()+864e5*o.expires),o.expires=s}o.expires=o.expires?o.expires.toUTCString():"";try{a=JSON.stringify(i),/^[\{\[]/.test(a)&&(i=a)}catch(e){}i=n.write?n.write(i,t):encodeURIComponent(String(i)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=(t=(t=encodeURIComponent(String(t))).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape);var u="";for(var c in o)o[c]&&(u+="; "+c,!0!==o[c]&&(u+="="+o[c]));return document.cookie=t+"="+i+u}t||(a={});for(var l=document.cookie?document.cookie.split("; "):[],d=/(%[0-9A-Z]{2})+/g,f=0;f<l.length;f++){var p=l[f].split("="),h=p.slice(1).join("=");this.json||'"'!==h.charAt(0)||(h=h.slice(1,-1));try{var g=p[0].replace(d,decodeURIComponent);if(h=n.read?n.read(h,g):n(h,g)||h.replace(d,decodeURIComponent),this.json)try{h=JSON.parse(h)}catch(e){}if(t===g){a=h;break}t||(a[g]=h)}catch(e){}}return a}}return r.set=r,r.get=function(e){return r.call(r,e)},r.getJSON=function(){return r.apply({json:!0},[].slice.call(arguments))},r.defaults={},r.remove=function(t,n){r(t,"",e(n,{expires:-1}))},r.withConverter=t,r}(function(){})}()}),cookies_=Object.freeze({default:js_cookie,__moduleExports:js_cookie}),cookies=js_cookie||cookies_,Cookies={EXPIRE_USER_ID:1,get:function(e){return cookies.get("publica_"+e)},remove:function(e,t){cookies.remove("publica_"+e,t)},set:function(e,t,n){cookies.set("publica_"+e,t,n)}};function isElementVisible(e,t){if(void 0===t&&(t=.5),!window||"none"===window.getComputedStyle(e).display)return!1;var n=e.getBoundingClientRect(),r=n.top,i=n.right,o=n.bottom,a=n.left,s=window.innerHeight||document.documentElement.clientHeight,u=window.innerWidth||document.documentElement.clientWidth,c=(n.height||o-r)*t,l=(n.width||i-a)*t;return(r>=-c&&r<=s-c||o>=c&&o<=s)&&(a>=-l&&a<=u-l||i>=l&&i<=u)}function exec(e,t,n){try{var r=Object.keys(t);return(new(Function.bind.apply(Function,[void 0].concat(r,[e])))).apply(void 0,r.map(function(e){return t[e]}))}catch(e){n&&n(e)}}function isFunc(e){return"function"==typeof e}function isString(e){return"function"==typeof e}function isObject(e){return"object"==typeof e&&!isArray$1(e)}function isArray$1(e){return Array.isArray(e)}function execFunc(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];try{e.apply(void 0,t)}catch(e){console.error(e)}}function checkDocStates(e){return(e||[]).indexOf(document.readyState)>-1}function on$1(e,t,n){return e.addEventListener(t,n,!1),function(){e.removeEventListener(t,n)}}function once$1(e,t,n){e.addEventListener(t,function(r){e.removeEventListener(t,n),n(r)},!1)}var docCallbacks=[],removeDocListener;function docReady(e){var t=["interactive","complete"];if(checkDocStates(t))execFunc(e);else{var n=execOnce(function(){execFunc(e)});docCallbacks.push(n),removeDocListener||(removeDocListener=on$1(document,"readystatechange",function(){checkDocStates(t)&&(docCallbacks.forEach(function(e){e&&e()}),removeDocListener())})),pageReady(n)}}var loadCallbacks=[],removeLoadListener;function pageReady(e){checkDocStates(["complete"])?e():(loadCallbacks.push(e),removeLoadListener||(removeLoadListener=on$1(window,"load",function(){loadCallbacks.forEach(function(e){e&&e()}),removeLoadListener()})))}var TYP_TO_EPATH_ROUTES={"post-to-storage":"a","js-client-app":"b","proxy-js":"c",css:"d"},ROUTE_ID={"post-to-storage":"site_id","js-app":"site_id","proxy-js":"site_id",css:"site_id",ad:"adunit_id",ping:"site_id",click:"adunit_id",tracker:"adunit_id",media:"adunit_id",pxy:"adunit_id","pxy-iframe":"adunit_id","pxy-xhr":"adunit_id","pxy-resource":"adunit_id",health:"adunit_id"},BASE64_ROUTES={"post-to-storage":"a","js-app":"b","proxy-js":"c",css:"d",ad:"0",ping:"1",click:"2",tracker:"3",media:"4",pxy:"5","pxy-iframe":"6","pxy-xhr":"7","pxy-resource":"8",health:"9"},COOKIE_KEY={SESSION_ID:"session_id",USER_ID:"user_id"},TU_PARAMS={ADBLOCKER:"adblocker",ADUNIT_UUID:"adunit_uuid",ANCESTOR_ORIGINS:"ancestor_origins",BACKFILL_SCRIPT:"backfill_script",BODY:"body",BOOTSTRAP_VERSION:"bootstrap_version",CUSTOM_PARAMS:"custom_params",CSS_ENCODER:"css_encoder",DEBUG:"debug",JS_APP_VERSION:"js_app_version",LOGGER_ERROR:"logger_error",LOGGER_EVENT:"logger_event",METHOD:"method",OUTPUT_TYPE:"output_type",PAGE_ID:"page_id",PAGE_URL:"page_url",PASS_THROUGH:"pass_through",PLAYER_TYPE:"player_type",PREDICTABLE:"predictable",PUBLISHER_UUID:"publisher_uuid",REQUEST_ID:"request_id",SELECTOR:"selector",SESSION_ID:"session_id",SITE_UUID:"site_uuid",SUBSCRIPTION:"subscription",TEST_MODE:"test_mode",TIME:"time",TYPE:"type",URLS:"urls",USER_ID:"user_id",UUID:"uuid"},domain;function EventHandlers(){}function EventEmitter(){EventEmitter.init.call(this)}function $getMaxListeners(e){return void 0===e._maxListeners?EventEmitter.defaultMaxListeners:e._maxListeners}function emitNone(e,t,n){if(t)e.call(n);else for(var r=e.length,i=arrayClone(e,r),o=0;o<r;++o)i[o].call(n)}function emitOne(e,t,n,r){if(t)e.call(n,r);else for(var i=e.length,o=arrayClone(e,i),a=0;a<i;++a)o[a].call(n,r)}function emitTwo(e,t,n,r,i){if(t)e.call(n,r,i);else for(var o=e.length,a=arrayClone(e,o),s=0;s<o;++s)a[s].call(n,r,i)}function emitThree(e,t,n,r,i,o){if(t)e.call(n,r,i,o);else for(var a=e.length,s=arrayClone(e,a),u=0;u<a;++u)s[u].call(n,r,i,o)}function emitMany(e,t,n,r){if(t)e.apply(n,r);else for(var i=e.length,o=arrayClone(e,i),a=0;a<i;++a)o[a].apply(n,r)}function _addListener(e,t,n,r){var i,o,a;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((o=e._events)?(o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),a=o[t]):(o=e._events=new EventHandlers,e._eventsCount=0),a){if("function"==typeof a?a=o[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),!a.warned&&(i=$getMaxListeners(e))&&i>0&&a.length>i){a.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=e,s.type=t,s.count=a.length,emitWarning(s)}}else a=o[t]=n,++e._eventsCount;return e}function emitWarning(e){"function"==typeof console.warn?console.warn(e):console.log(e)}function _onceWrap(e,t,n){var r=!1;function i(){e.removeListener(t,i),r||(r=!0,n.apply(e,arguments))}return i.listener=n,i}function listenerCount(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function spliceOne(e,t){for(var n=t,r=n+1,i=e.length;r<i;n+=1,r+=1)e[n]=e[r];e.pop()}function arrayClone(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}function unwrapListeners(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}function computePageLoadTime(){var e=-1;return window.performance&&window.performance.timing&&window.performance.timing.domComplete>0&&(e=(window.performance.timing.domComplete-window.performance.timing.navigationStart)/1e3),e}EventHandlers.prototype=Object.create(null),EventEmitter.EventEmitter=EventEmitter,EventEmitter.usingDomains=!1,EventEmitter.prototype.domain=void 0,EventEmitter.prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0,EventEmitter.defaultMaxListeners=10,EventEmitter.init=function(){this.domain=null,EventEmitter.usingDomains&&(!domain.active||this instanceof domain.Domain||(this.domain=domain.active)),this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new EventHandlers,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},EventEmitter.prototype.setMaxListeners=function e(t){if("number"!=typeof t||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this},EventEmitter.prototype.getMaxListeners=function e(){return $getMaxListeners(this)},EventEmitter.prototype.emit=function e(t){var n,r,i,o,a,s,u,c="error"===t;if(s=this._events)c=c&&null==s.error;else if(!c)return!1;if(u=this.domain,c){if(n=arguments[1],!u){if(n instanceof Error)throw n;var l=new Error('Uncaught, unspecified "error" event. ('+n+")");throw l.context=n,l}return n||(n=new Error('Uncaught, unspecified "error" event')),n.domainEmitter=this,n.domain=u,n.domainThrown=!1,u.emit("error",n),!1}if(!(r=s[t]))return!1;var d="function"==typeof r;switch(i=arguments.length){case 1:emitNone(r,d,this);break;case 2:emitOne(r,d,this,arguments[1]);break;case 3:emitTwo(r,d,this,arguments[1],arguments[2]);break;case 4:emitThree(r,d,this,arguments[1],arguments[2],arguments[3]);break;default:for(o=new Array(i-1),a=1;a<i;a++)o[a-1]=arguments[a];emitMany(r,d,this,o)}return!0},EventEmitter.prototype.addListener=function e(t,n){return _addListener(this,t,n,!1)},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.prependListener=function e(t,n){return _addListener(this,t,n,!0)},EventEmitter.prototype.once=function e(t,n){if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');return this.on(t,_onceWrap(this,t,n)),this},EventEmitter.prototype.prependOnceListener=function e(t,n){if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');return this.prependListener(t,_onceWrap(this,t,n)),this},EventEmitter.prototype.removeListener=function e(t,n){var r,i,o,a,s;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if(!(i=this._events))return this;if(!(r=i[t]))return this;if(r===n||r.listener&&r.listener===n)0==--this._eventsCount?this._events=new EventHandlers:(delete i[t],i.removeListener&&this.emit("removeListener",t,r.listener||n));else if("function"!=typeof r){for(o=-1,a=r.length;a-- >0;)if(r[a]===n||r[a].listener&&r[a].listener===n){s=r[a].listener,o=a;break}if(o<0)return this;if(1===r.length){if(r[0]=void 0,0==--this._eventsCount)return this._events=new EventHandlers,this;delete i[t]}else spliceOne(r,o);i.removeListener&&this.emit("removeListener",t,s||n)}return this},EventEmitter.prototype.removeAllListeners=function e(t){var n,r;if(!(r=this._events))return this;if(!r.removeListener)return 0===arguments.length?(this._events=new EventHandlers,this._eventsCount=0):r[t]&&(0==--this._eventsCount?this._events=new EventHandlers:delete r[t]),this;if(0===arguments.length){for(var i,o=Object.keys(r),a=0;a<o.length;++a)"removeListener"!==(i=o[a])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=new EventHandlers,this._eventsCount=0,this}if("function"==typeof(n=r[t]))this.removeListener(t,n);else if(n)do{this.removeListener(t,n[n.length-1])}while(n[0]);return this},EventEmitter.prototype.listeners=function e(t){var n,r=this._events;return r&&(n=r[t])?"function"==typeof n?[n.listener||n]:unwrapListeners(n):[]},EventEmitter.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):listenerCount.call(e,t)},EventEmitter.prototype.listenerCount=listenerCount,EventEmitter.prototype.eventNames=function e(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var focusBlurEventEmitter=new EventEmitter,blurEventsInitialized=!1,blurring=!1,Position;function initFocusBlurEventEmitter(){if(!blurEventsInitialized){blurEventsInitialized=!0;var e=window.top?window.top:window;(e===window?[window]:[e,window]).forEach(function(e){try{e.addEventListener("focus",onFocus),e.addEventListener("blur",onBlur),e.addEventListener("beforeunload",function(){e.removeEventListener("focus",onFocus),e.removeEventListener("blur",onBlur)})}catch(e){}})}}function onFocus(){blurring||focusBlurEventEmitter.emit("focus"),blurring=!1}function onBlur(){blurring=!0,setTimeout(function(){blurring&&focusBlurEventEmitter.emit("blur"),blurring=!1})}function onPageBlur(e){return initFocusBlurEventEmitter(),focusBlurEventEmitter.on("blur",e),function(){focusBlurEventEmitter.removeListener("blur",e)}}function onPageFocus(e){return initFocusBlurEventEmitter(),focusBlurEventEmitter.on("focus",e),function(){focusBlurEventEmitter.removeListener("focus",e)}}function _s4(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function uuid4(){return _s4()+_s4()+"-"+_s4()+"-"+_s4()+"-"+_s4()+"-"+_s4()+_s4()+_s4()}function uuidNoDashes(){return _s4()+_s4()+_s4()+_s4()+_s4()+_s4()+_s4()+_s4()}!function(e){e[e.NOT_KNOWN=0]="NOT_KNOWN",e[e.INSTREAM=100]="INSTREAM",e[e.PREROLL=101]="PREROLL",e[e.OUTSTREAM=200]="OUTSTREAM",e[e.SCRIPT=201]="SCRIPT",e[e.DISPLAY=202]="DISPLAY",e[e.INVENTORY=300]="INVENTORY"}(Position||(Position={}));var REGEX_UUID=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function isValidUUID(e){return REGEX_UUID.test(e)}var PAGE_ID="";function initPageID(){PAGE_ID=uuid4()}function getPageID(){return PAGE_ID||initPageID(),PAGE_ID}function findAdunit(e,t){for(var n=e.adUnitOptions||[],r=0;r<n.length;r+=1)if(t(n[r],r))return n[r];throw new Error("adunit was not found")}function findAdunitByID(e,t){return findAdunit(e,function(e){return e.adunit_id===t||e.adunit_uuid===t})}function getAdunitsByPosition(e,t){return e.adUnitOptions.filter(function(e){return e&&e.position===t})}function getInstreamOutstreamAdunits(e){return e.adUnitOptions.filter(function(e){return e&&e.position>=Position.INSTREAM&&e.position<=Position.OUTSTREAM})}function isDebug(e,t){return e.debug||t&&t.debug}function isQuery(e,t){return e.qy||t&&t.qy}function PPath(e){for(var t=[BASE64_ROUTES[e.action],""+e.id,e.user_id,e.session_id,e.request_id||"",b64Encode(e.url),b64Encode(e.logger_event),b64Encode(e.logger_error),b64Encode(JSON.stringify(e.custom_params)),b64Encode(JSON.stringify(e.ancestor_origins)),b64Encode(e.page_url),e.backfill_script?"true":"",e.test_mode?""+e.test_mode:"",e.time?""+e.time:""],n=t.length-1;n>=0&&!(t[n]&&t[n].length>0);n--)t=t.slice(0,n);return t.join("|")}var ErrBlockedByAdblock=new Error("an adblock has blocked our XHR request"),ErrURLTooBig=new Error("the url is too big, please set sendAsBodyIfTooBig to true"),ErrDataNotEmpty=new Error("the data is not empty and cannot use the rawquery"),ErrDisabledByCORS=new Error("the request may have been blocked by CORS"),ErrInsecureCall=new Error("the request was made over an insecure channel on a secure site"),ErrUnknownStatusZero=new Error("the request received an status zero but was not identified as neither an adblock or cors"),ErrStatus=new Error("the request received an error status"),timeToAllow=500,URLSizeLimit=2e3;function insecureCallFromSecureSite(e){return 0!==e.indexOf("//")&&"https:"===window.location.protocol&&"https:"!==url.Protocol(e)}function XHRRequest(e,t,n,r){return new Promise(function(i,o){XHR(Object.assign(n,{method:e,url:t,callback:function(e,t){e?o(e):i(t)}}),r)})}function noop$1(){}function XHR(e,t){var n=(new Date).getTime(),r=new XMLHttpRequest;if(e.timeout&&(Debug.log("[XHR] set the timeout to "+e.timeout,t),r.timeout=e.timeout),e.withCredentials&&(Debug.log("[XHR] set withCredentials to "+e.withCredentials,t),r.withCredentials=e.withCredentials),r.overrideMimeType&&e.overrideMimeType&&(Debug.log("[XHR] set overrideMimeType to "+e.overrideMimeType,t),r.overrideMimeType(e.overrideMimeType)),e.rawQuery&&e.rawQuery.length>0){var i=e.url;if(e.obfuscateRawQuery&&!0===e.obfuscateRawQuery?(Debug.log("[XHR] obfuscating the rawQuery "+e.rawQuery,t),i+="?"+obfuscate(e.rawQuery)):(Debug.log("[XHR] not obfuscating the rawQuery "+e.rawQuery,t),i+="?"+e.rawQuery),i.length>URLSizeLimit){if(Debug.log("[XHR] the URL of size "+i.length+" is bigger than the max size allowed "+URLSizeLimit,t),"GET"!==e.method||!e.sendRawQueryAsBodyIfURLTooBig)return(e.callback||noop$1)(ErrURLTooBig,r),r;if(e.body&&e.body.length>0)return Debug.log("[XHR] conditions not met, not sending the RawQuery as a Body",t),(e.callback||noop$1)(ErrDataNotEmpty,r),r;i=e.url,e.body=e.rawQuery,e.method="POST"}e.url=i}if(r.open(e.method,e.url,!0),e.headers)for(var o=0,a=e.headers;o<a.length;o++){var s=a[o];r.setRequestHeader(s[0],s[1])}return r.onreadystatechange=function(){if(4===r.readyState)if(Debug.log("[XHR] got a "+r.status+" reply for the XHRRequest to "+e.url,t),0===r.status){var i=(new Date).getTime();Debug.log("[XHR] Request blocked after "+(i-n)+"ms",t),insecureCallFromSecureSite(e.url)?(Debug.log("[XHR] insecure call under a secure website",t),(e.callback||noop$1)(ErrInsecureCall,r)):canBlockRequest(r,e.method,e.headers)?(Debug.log("[XHR] CORS blocked our request",t),(e.callback||noop$1)(ErrDisabledByCORS,r)):i-n<timeToAllow?(Debug.log("[XHR] an adblock blocked our request",t),(e.callback||noop$1)(ErrBlockedByAdblock,r)):(e.callback||noop$1)(ErrUnknownStatusZero,r)}else(e.callback||noop$1)(r.status>=200&&r.status<300?null:ErrStatus,r)},e.body&&e.body.length>0?(Debug.log("[XHR] sending the request using "+e.method+" with a body attached",t),r.send(e.body)):(Debug.log("[XHR] sending the request using "+e.method+" with no body attached",t),r.send()),r}function canBlockRequest(e,t,n){if("withCredentials"in e&&!0===e.withCredentials)return!0;if("GET"!==t&&"HEAD"!==t&&"POST"!==t)return!0;if(n&&n.length>0)for(var r=0;r<n.length;r++){var i=n[r][1];switch(n[r][0]){case"Accept":case"Accept-Language":case"Content-Language":break;case"Content-Type":if(!isSimpleContentType(i))return!0;break;default:return!0}}return!1}function isSimpleContentType(e){return"application/x-www-form-urlencoded"!==e&&"multipart/form-data"!==e&&"text/plain"!==e}var ErrRouteNotFound=Error("route was not found in the EPath routes");function utcHour(){var e=new Date,t=Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours());return Math.floor(t/1e3)}function utcDay(){var e=new Date,t=Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate());return Math.floor(t/1e3)}var crypt=createCommonjsModule(function(e){var t,n;t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e.exports=n={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&n.rotl(e,8)|4278255360&n.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=n.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],n=0,r=0;n<e.length;n++,r+=8)t[r>>>5]|=e[n]<<24-r%32;return t},wordsToBytes:function(e){for(var t=[],n=0;n<32*e.length;n+=8)t.push(e[n>>>5]>>>24-n%32&255);return t},bytesToHex:function(e){for(var t=[],n=0;n<e.length;n++)t.push((e[n]>>>4).toString(16)),t.push((15&e[n]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(parseInt(e.substr(n,2),16));return t},bytesToBase64:function(e){for(var n=[],r=0;r<e.length;r+=3)for(var i=e[r]<<16|e[r+1]<<8|e[r+2],o=0;o<4;o++)n.push(8*r+6*o<=8*e.length?t.charAt(i>>>6*(3-o)&63):"=");return n.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var n=[],r=0,i=0;r<e.length;i=++r%4)0!=i&&n.push((t.indexOf(e.charAt(r-1))&Math.pow(2,-2*i+8)-1)<<2*i|t.indexOf(e.charAt(r))>>>6-2*i);return n}}}),charenc={utf8:{stringToBytes:function(e){return charenc.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(charenc.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t},bytesToString:function(e){for(var t=[],n=0;n<e.length;n++)t.push(String.fromCharCode(e[n]));return t.join("")}}},charenc_1=charenc,isBuffer_1=function(e){return null!=e&&(isBuffer$1(e)||isSlowBuffer$1(e)||!!e._isBuffer)};function isBuffer$1(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function isSlowBuffer$1(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&isBuffer$1(e.slice(0,0))}var md5=createCommonjsModule(function(e){var t,n,r,i,o;t=crypt,n=charenc_1.utf8,r=isBuffer_1,i=charenc_1.bin,(o=function(e,a){e.constructor==String?e=a&&"binary"===a.encoding?i.stringToBytes(e):n.stringToBytes(e):r(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||(e=e.toString());for(var s=t.bytesToWords(e),u=8*e.length,c=1732584193,l=-271733879,d=-1732584194,f=271733878,p=0;p<s.length;p++)s[p]=16711935&(s[p]<<8|s[p]>>>24)|4278255360&(s[p]<<24|s[p]>>>8);s[u>>>5]|=128<<u%32,s[14+(u+64>>>9<<4)]=u;var h=o._ff,g=o._gg,E=o._hh,y=o._ii;for(p=0;p<s.length;p+=16){var m=c,_=l,v=d,A=f;l=y(l=y(l=y(l=y(l=E(l=E(l=E(l=E(l=g(l=g(l=g(l=g(l=h(l=h(l=h(l=h(l,d=h(d,f=h(f,c=h(c,l,d,f,s[p+0],7,-680876936),l,d,s[p+1],12,-389564586),c,l,s[p+2],17,606105819),f,c,s[p+3],22,-1044525330),d=h(d,f=h(f,c=h(c,l,d,f,s[p+4],7,-176418897),l,d,s[p+5],12,1200080426),c,l,s[p+6],17,-1473231341),f,c,s[p+7],22,-45705983),d=h(d,f=h(f,c=h(c,l,d,f,s[p+8],7,1770035416),l,d,s[p+9],12,-1958414417),c,l,s[p+10],17,-42063),f,c,s[p+11],22,-1990404162),d=h(d,f=h(f,c=h(c,l,d,f,s[p+12],7,1804603682),l,d,s[p+13],12,-40341101),c,l,s[p+14],17,-1502002290),f,c,s[p+15],22,1236535329),d=g(d,f=g(f,c=g(c,l,d,f,s[p+1],5,-165796510),l,d,s[p+6],9,-1069501632),c,l,s[p+11],14,643717713),f,c,s[p+0],20,-373897302),d=g(d,f=g(f,c=g(c,l,d,f,s[p+5],5,-701558691),l,d,s[p+10],9,38016083),c,l,s[p+15],14,-660478335),f,c,s[p+4],20,-405537848),d=g(d,f=g(f,c=g(c,l,d,f,s[p+9],5,568446438),l,d,s[p+14],9,-1019803690),c,l,s[p+3],14,-187363961),f,c,s[p+8],20,1163531501),d=g(d,f=g(f,c=g(c,l,d,f,s[p+13],5,-1444681467),l,d,s[p+2],9,-51403784),c,l,s[p+7],14,1735328473),f,c,s[p+12],20,-1926607734),d=E(d,f=E(f,c=E(c,l,d,f,s[p+5],4,-378558),l,d,s[p+8],11,-2022574463),c,l,s[p+11],16,1839030562),f,c,s[p+14],23,-35309556),d=E(d,f=E(f,c=E(c,l,d,f,s[p+1],4,-1530992060),l,d,s[p+4],11,1272893353),c,l,s[p+7],16,-155497632),f,c,s[p+10],23,-1094730640),d=E(d,f=E(f,c=E(c,l,d,f,s[p+13],4,681279174),l,d,s[p+0],11,-358537222),c,l,s[p+3],16,-722521979),f,c,s[p+6],23,76029189),d=E(d,f=E(f,c=E(c,l,d,f,s[p+9],4,-640364487),l,d,s[p+12],11,-421815835),c,l,s[p+15],16,530742520),f,c,s[p+2],23,-995338651),d=y(d,f=y(f,c=y(c,l,d,f,s[p+0],6,-198630844),l,d,s[p+7],10,1126891415),c,l,s[p+14],15,-1416354905),f,c,s[p+5],21,-57434055),d=y(d,f=y(f,c=y(c,l,d,f,s[p+12],6,1700485571),l,d,s[p+3],10,-1894986606),c,l,s[p+10],15,-1051523),f,c,s[p+1],21,-2054922799),d=y(d,f=y(f,c=y(c,l,d,f,s[p+8],6,1873313359),l,d,s[p+15],10,-30611744),c,l,s[p+6],15,-1560198380),f,c,s[p+13],21,1309151649),d=y(d,f=y(f,c=y(c,l,d,f,s[p+4],6,-145523070),l,d,s[p+11],10,-1120210379),c,l,s[p+2],15,718787259),f,c,s[p+9],21,-343485551),c=c+m>>>0,l=l+_>>>0,d=d+v>>>0,f=f+A>>>0}return t.endian([c,l,d,f])})._ff=function(e,t,n,r,i,o,a){var s=e+(t&n|~t&r)+(i>>>0)+a;return(s<<o|s>>>32-o)+t},o._gg=function(e,t,n,r,i,o,a){var s=e+(t&r|n&~r)+(i>>>0)+a;return(s<<o|s>>>32-o)+t},o._hh=function(e,t,n,r,i,o,a){var s=e+(t^n^r)+(i>>>0)+a;return(s<<o|s>>>32-o)+t},o._ii=function(e,t,n,r,i,o,a){var s=e+(n^(t|~r))+(i>>>0)+a;return(s<<o|s>>>32-o)+t},o._blocksize=16,o._digestsize=16,e.exports=function(e,n){if(void 0===e||null===e)throw new Error("Illegal argument "+e);var r=t.wordsToBytes(o(e,n));return n&&n.asBytes?r:n&&n.asString?i.bytesToString(r):t.bytesToHex(r)}}),md5_=Object.freeze({default:md5,__moduleExports:md5}),md5$1=md5||md5_,secret="f4caf8c6d2",salt="72857b6cd5795861a353ddbd4a3be80fae282dc4598937ae8a4ae5fc8b0aa488",indexes={route:8,secret:[2,4,6,7,21,23,24,26,28,30],number:[9,10,11,12,13,14,15,16,17,18,19]},ErrNumberTooLarge=Error("number is too large"),ErrRouteTooLarge=Error("route is too large"),EPath=function(){function e(e){this.seed=Math.floor(e/7)}return e.prototype.setNumber=function(e){var t=""+e;if(t.length>11)throw ErrNumberTooLarge;this.computed="",this.number=t},e.prototype.setRoute=function(e){if(e.length>1)throw ErrRouteTooLarge;this.computed="",this.route=e},e.prototype.toString=function(){return this.computed||(this.computed=this.compute()),this.computed},e.prototype.compute=function(){var e=md5$1(salt+this.seed).split("");return indexes.secret.forEach(function(t,n){e[t]=secret[n]}),this.route&&(e[indexes.route]=this.route),this.number&&(this.number.split("").forEach(function(t,n){e[indexes.number[n]]=t}),e[indexes.number[this.number.length-1]+1]=this.numberTermination()),e.join("")},e.prototype.numberTermination=function(){return String.fromCharCode("a".charCodeAt(0)+this.seed%6)},e.Random=function(){return new e((new Date).getTime())},e.Daily=function(){return new e(utcDay())},e.Hourly=function(){return new e(utcHour())},e}(),create_buffer=createCommonjsModule(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=_buffer.Buffer.from&&_buffer.Buffer.alloc&&_buffer.Buffer.allocUnsafe&&_buffer.Buffer.allocUnsafeSlow?_buffer.Buffer.from:function(e){return new _buffer.Buffer(e)}});unwrapExports(create_buffer);var define_crc=createCommonjsModule(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=function e(n,r){return t(n,r)>>>0};return n.signed=t,n.unsigned=n,n.model=e,n}});unwrapExports(define_crc);var crc1=createCommonjsModule(function(e){var t=r(create_buffer),n=r(define_crc);function r(e){return e&&e.__esModule?e:{default:e}}e.exports=(0,n.default)("crc1",function(e,n){_buffer.Buffer.isBuffer(e)||(e=(0,t.default)(e));for(var r=~~n,i=0,o=0;o<e.length;o++)i+=e[o];return(r+=i%256)%256})});unwrapExports(crc1);var crc8=createCommonjsModule(function(e){var t=r(create_buffer),n=r(define_crc);function r(e){return e&&e.__esModule?e:{default:e}}var i=[0,7,14,9,28,27,18,21,56,63,54,49,36,35,42,45,112,119,126,121,108,107,98,101,72,79,70,65,84,83,90,93,224,231,238,233,252,251,242,245,216,223,214,209,196,195,202,205,144,151,158,153,140,139,130,133,168,175,166,161,180,179,186,189,199,192,201,206,219,220,213,210,255,248,241,246,227,228,237,234,183,176,185,190,171,172,165,162,143,136,129,134,147,148,157,154,39,32,41,46,59,60,53,50,31,24,17,22,3,4,13,10,87,80,89,94,75,76,69,66,111,104,97,102,115,116,125,122,137,142,135,128,149,146,155,156,177,182,191,184,173,170,163,164,249,254,247,240,229,226,235,236,193,198,207,200,221,218,211,212,105,110,103,96,117,114,123,124,81,86,95,88,77,74,67,68,25,30,23,16,5,2,11,12,33,38,47,40,61,58,51,52,78,73,64,71,82,85,92,91,118,113,120,127,106,109,100,99,62,57,48,55,34,37,44,43,6,1,8,15,26,29,20,19,174,169,160,167,178,181,188,187,150,145,152,159,138,141,132,131,222,217,208,215,194,197,204,203,230,225,232,239,250,253,244,243];"undefined"!=typeof Int32Array&&(i=new Int32Array(i)),e.exports=(0,n.default)("crc-8",function(e,n){_buffer.Buffer.isBuffer(e)||(e=(0,t.default)(e));for(var r=~~n,o=0;o<e.length;o++)r=255&i[255&(r^e[o])];return r})});unwrapExports(crc8);var crc8_1wire=createCommonjsModule(function(e){var t=r(create_buffer),n=r(define_crc);function r(e){return e&&e.__esModule?e:{default:e}}var i=[0,94,188,226,97,63,221,131,194,156,126,32,163,253,31,65,157,195,33,127,252,162,64,30,95,1,227,189,62,96,130,220,35,125,159,193,66,28,254,160,225,191,93,3,128,222,60,98,190,224,2,92,223,129,99,61,124,34,192,158,29,67,161,255,70,24,250,164,39,121,155,197,132,218,56,102,229,187,89,7,219,133,103,57,186,228,6,88,25,71,165,251,120,38,196,154,101,59,217,135,4,90,184,230,167,249,27,69,198,152,122,36,248,166,68,26,153,199,37,123,58,100,134,216,91,5,231,185,140,210,48,110,237,179,81,15,78,16,242,172,47,113,147,205,17,79,173,243,112,46,204,146,211,141,111,49,178,236,14,80,175,241,19,77,206,144,114,44,109,51,209,143,12,82,176,238,50,108,142,208,83,13,239,177,240,174,76,18,145,207,45,115,202,148,118,40,171,245,23,73,8,86,180,234,105,55,213,139,87,9,235,181,54,104,138,212,149,203,41,119,244,170,72,22,233,183,85,11,136,214,52,106,43,117,151,201,74,20,246,168,116,42,200,150,21,75,169,247,182,232,10,84,215,137,107,53];"undefined"!=typeof Int32Array&&(i=new Int32Array(i)),e.exports=(0,n.default)("dallas-1-wire",function(e,n){_buffer.Buffer.isBuffer(e)||(e=(0,t.default)(e));for(var r=~~n,o=0;o<e.length;o++)r=255&i[255&(r^e[o])];return r})});unwrapExports(crc8_1wire);var crc16=createCommonjsModule(function(e){var t=r(create_buffer),n=r(define_crc);function r(e){return e&&e.__esModule?e:{default:e}}var i=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];"undefined"!=typeof Int32Array&&(i=new Int32Array(i)),e.exports=(0,n.default)("crc-16",function(e,n){_buffer.Buffer.isBuffer(e)||(e=(0,t.default)(e));for(var r=~~n,o=0;o<e.length;o++)r=65535&(i[255&(r^e[o])]^r>>8);return r})});unwrapExports(crc16);var crc16_ccitt=createCommonjsModule(function(e){var t=r(create_buffer),n=r(define_crc);function r(e){return e&&e.__esModule?e:{default:e}}var i=[0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920];"undefined"!=typeof Int32Array&&(i=new Int32Array(i)),e.exports=(0,n.default)("ccitt",function(e,n){_buffer.Buffer.isBuffer(e)||(e=(0,t.default)(e));for(var r=void 0!==n?~~n:65535,o=0;o<e.length;o++)r=65535&(i[255&(r>>8^e[o])]^r<<8);return r})});unwrapExports(crc16_ccitt);var crc16_modbus=createCommonjsModule(function(e){var t=r(create_buffer),n=r(define_crc);function r(e){return e&&e.__esModule?e:{default:e}}var i=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];"undefined"!=typeof Int32Array&&(i=new Int32Array(i)),e.exports=(0,n.default)("crc-16-modbus",function(e,n){_buffer.Buffer.isBuffer(e)||(e=(0,t.default)(e));for(var r=void 0!==n?~~n:65535,o=0;o<e.length;o++)r=65535&(i[255&(r^e[o])]^r>>8);return r})});unwrapExports(crc16_modbus);var crc16_xmodem=createCommonjsModule(function(e){var t=r(create_buffer),n=r(define_crc);function r(e){return e&&e.__esModule?e:{default:e}}e.exports=(0,n.default)("xmodem",function(e,n){_buffer.Buffer.isBuffer(e)||(e=(0,t.default)(e));for(var r=void 0!==n?~~n:0,i=0;i<e.length;i++){var o=r>>>8&255;o^=255&e[i],r=r<<8&65535,r^=o^=o>>>4,r^=o=o<<5&65535,r^=o=o<<7&65535}return r})});unwrapExports(crc16_xmodem);var crc16_kermit=createCommonjsModule(function(e){var t=r(create_buffer),n=r(define_crc);function r(e){return e&&e.__esModule?e:{default:e}}var i=[0,4489,8978,12955,17956,22445,25910,29887,35912,40385,44890,48851,51820,56293,59774,63735,4225,264,13203,8730,22181,18220,30135,25662,40137,36160,49115,44626,56045,52068,63999,59510,8450,12427,528,5017,26406,30383,17460,21949,44362,48323,36440,40913,60270,64231,51324,55797,12675,8202,4753,792,30631,26158,21685,17724,48587,44098,40665,36688,64495,60006,55549,51572,16900,21389,24854,28831,1056,5545,10034,14011,52812,57285,60766,64727,34920,39393,43898,47859,21125,17164,29079,24606,5281,1320,14259,9786,57037,53060,64991,60502,39145,35168,48123,43634,25350,29327,16404,20893,9506,13483,1584,6073,61262,65223,52316,56789,43370,47331,35448,39921,29575,25102,20629,16668,13731,9258,5809,1848,65487,60998,56541,52564,47595,43106,39673,35696,33800,38273,42778,46739,49708,54181,57662,61623,2112,6601,11090,15067,20068,24557,28022,31999,38025,34048,47003,42514,53933,49956,61887,57398,6337,2376,15315,10842,24293,20332,32247,27774,42250,46211,34328,38801,58158,62119,49212,53685,10562,14539,2640,7129,28518,32495,19572,24061,46475,41986,38553,34576,62383,57894,53437,49460,14787,10314,6865,2904,32743,28270,23797,19836,50700,55173,58654,62615,32808,37281,41786,45747,19012,23501,26966,30943,3168,7657,12146,16123,54925,50948,62879,58390,37033,33056,46011,41522,23237,19276,31191,26718,7393,3432,16371,11898,59150,63111,50204,54677,41258,45219,33336,37809,27462,31439,18516,23005,11618,15595,3696,8185,63375,58886,54429,50452,45483,40994,37561,33584,31687,27214,22741,18780,15843,11370,7921,3960];"undefined"!=typeof Int32Array&&(i=new Int32Array(i)),e.exports=(0,n.default)("kermit",function(e,n){_buffer.Buffer.isBuffer(e)||(e=(0,t.default)(e));for(var r=void 0!==n?~~n:0,o=0;o<e.length;o++)r=65535&(i[255&(r^e[o])]^r>>8);return r})});unwrapExports(crc16_kermit);var crc24=createCommonjsModule(function(e){var t=r(create_buffer),n=r(define_crc);function r(e){return e&&e.__esModule?e:{default:e}}var i=[0,8801531,9098509,825846,9692897,1419802,1651692,10452759,10584377,2608578,2839604,11344079,3303384,11807523,12104405,4128302,12930697,4391538,5217156,13227903,5679208,13690003,14450021,5910942,6606768,14844747,15604413,6837830,16197969,7431594,8256604,16494759,840169,9084178,8783076,18463,10434312,1670131,1434117,9678590,11358416,2825259,2590173,10602790,4109873,12122826,11821884,3289031,13213536,5231515,4409965,12912278,5929345,14431610,13675660,5693559,6823513,15618722,14863188,6588335,16513208,8238147,7417269,16212302,1680338,10481449,9664223,1391140,9061683,788936,36926,8838341,12067563,4091408,3340262,11844381,2868234,11372785,10555655,2579964,14478683,5939616,5650518,13661357,5180346,13190977,12967607,4428364,8219746,16457881,16234863,7468436,15633027,6866552,6578062,14816117,1405499,9649856,10463030,1698765,8819930,55329,803287,9047340,11858690,3325945,4072975,12086004,2561507,10574104,11387118,2853909,13647026,5664841,5958079,14460228,4446803,12949160,13176670,5194661,7454091,16249200,16476294,8201341,14834538,6559633,6852199,15647388,3360676,11864927,12161705,4185682,10527045,2551230,2782280,11286707,9619101,1346150,1577872,10379115,73852,8875143,9172337,899466,16124205,7357910,8182816,16421083,6680524,14918455,15678145,6911546,5736468,13747439,14507289,5968354,12873461,4334094,5159928,13170435,4167245,12180150,11879232,3346363,11301036,2767959,2532769,10545498,10360692,1596303,1360505,9604738,913813,9157998,8856728,92259,16439492,8164415,7343561,16138546,6897189,15692510,14936872,6662099,5986813,14488838,13733104,5750795,13156124,5174247,4352529,12855018,2810998,11315341,10498427,2522496,12124823,4148844,3397530,11901793,9135439,862644,110658,8912057,1606574,10407765,9590435,1317464,15706879,6940164,6651890,14889737,8145950,16384229,16161043,7394792,5123014,13133629,12910283,4370992,14535975,5997020,5707818,13718737,2504095,10516836,11329682,2796649,11916158,3383173,4130419,12143240,8893606,129117,876971,9121104,1331783,9576124,10389322,1625009,14908182,6633453,6925851,15721184,7380471,16175372,16402682,8127489,4389423,12891860,13119266,5137369,13704398,5722165,6015427,14517560];"undefined"!=typeof Int32Array&&(i=new Int32Array(i)),e.exports=(0,n.default)("crc-24",function(e,n){_buffer.Buffer.isBuffer(e)||(e=(0,t.default)(e));for(var r=void 0!==n?~~n:11994318,o=0;o<e.length;o++)r=16777215&(i[255&(r>>16^e[o])]^r<<8);return r})});unwrapExports(crc24);var crc32=createCommonjsModule(function(e){var t=r(create_buffer),n=r(define_crc);function r(e){return e&&e.__esModule?e:{default:e}}var i=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];"undefined"!=typeof Int32Array&&(i=new Int32Array(i)),e.exports=(0,n.default)("crc-32",function(e,n){_buffer.Buffer.isBuffer(e)||(e=(0,t.default)(e));for(var r=0===n?0:-1^~~n,o=0;o<e.length;o++)r=i[255&(r^e[o])]^r>>>8;return-1^r})});unwrapExports(crc32);var crcjam=createCommonjsModule(function(e){var t=r(create_buffer),n=r(define_crc);function r(e){return e&&e.__esModule?e:{default:e}}var i=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];"undefined"!=typeof Int32Array&&(i=new Int32Array(i)),e.exports=(0,n.default)("jam",function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;_buffer.Buffer.isBuffer(e)||(e=(0,t.default)(e));for(var r=0===n?0:~~n,o=0;o<e.length;o++)r=i[255&(r^e[o])]^r>>>8;return r})});unwrapExports(crcjam);var lib={crc1:crc1,crc8:crc8,crc81wire:crc8_1wire,crc16:crc16,crc16ccitt:crc16_ccitt,crc16modbus:crc16_modbus,crc16xmodem:crc16_xmodem,crc16kermit:crc16_kermit,crc24:crc24,crc32:crc32,crcjam:crcjam},lib_10=lib.crc32,md5$2=md5||md5_;function requestURL(e,t){if(t&&t.url&&url.isSameDomain(t.url,t.options.domains))return t.url;t.url&&(t.url=url.normalizeURL(t.url));try{t.page_url=""+window.top.location.href}catch(e){}if("css"===e||"proxy-js"===e)return getAssetURL(e,t);if("ping"===e||!0===t.options.no_tiny){var n=getShortURL(e,t);return"tracker"===e&&t.pass_through&&firePixel(n),n}return getTinyURL(e,t)}function firePixel(e){(new Image).src=e}var max_url_length=8150,Logger;function getShortURL(e,t){var n,r=t.options.site_id;t.adUnitOptions&&"adunit_id"===ROUTE_ID[e]&&(r=t.adUnitOptions.adunit_id),"vmap"!==e&&"ad"!==e||!t.custom_params||(n=t.custom_params);var i="",o="",a="";t.cacheable||(a=t.request_id||"",o=t.session_id||Cookies.get(COOKIE_KEY.SESSION_ID),i=t.user_id||Cookies.get(COOKIE_KEY.USER_ID));var s=PPath({action:e,ancestor_origins:t.ancestorOrigins,backfill_script:t.backfill_script,custom_params:n,id:r,logger_error:t.logger_error,logger_event:t.logger_event,page_url:t.page_url,request_id:a,session_id:o,test_mode:t.options.test_mode,time:t.options.time,url:t.url,user_id:i}),u=appendDebug(e,t,getStableCdnURL(t.options.cdn_url,t.url||void 0,t.user_id||Cookies.get(COOKIE_KEY.USER_ID))+"/"+obfuscate(s,t.cacheable));return u.length>max_url_length?getTinyURL(e,t):u}function getStableCdnURL(e,t,n){if(-1!==e.indexOf("cloudfront.net"))return e;if(-1!==e.indexOf("publica"))return e;var r=e.split(".");if(r[0]="",t&&isValidURL(t))r[0]=GetCnameForUrl(t,n);else for(var i="abcdefghiklmnopqrstuvwxyz",o=0;o<8;o++){var a=Math.floor(Math.random()*i.length);r[0]+=i.substring(a,a+1)}return httpsProto(["//"+r.join(".")])[0]}function isValidURL(e){try{return!!new url.URL(e)}catch(e){return!1}}function GetCnameForUrl(e,t){var n=getSimpleTLDPlusOne(new url.URL(e).host),r=""+utcDay()+n+t,i=lib_10(r).toString(16).split("");return i.forEach(function(e,t){isAlpha(e)||(i[t]="abcdefghijklmnopqrstuvwxyz".charAt(parseInt(e,10)))}),i.join("")}function isAlpha(e){return/^[A-Z]$/i.test(e)}function getSimpleTLDPlusOne(e){var t=e.split(".");return t.length<2?e:t[t.length-2]+"."+t[t.length-1]}function getAssetURL(e,t){return appendDebug(e,t,generateURL(t,getEPath(e,t)))}function appendDebug(e,t,n,r,i){var o=t.options,a=t.adUnitOptions;if(isDebug(o,a)||isQuery(o,a))try{n+="?typ="+e,r&&(n+="&method="+r),i&&(n+="&key="+i),a&&(n+="&adunit_uuid="+a.adunit_uuid)}catch(e){}return n}function getEPath(e,t){var n,r=TYP_TO_EPATH_ROUTES[e];if(!r)throw ErrRouteNotFound;return(n=r===TYP_TO_EPATH_ROUTES["post-to-storage"]?EPath.Random():EPath.Hourly()).setRoute(r),n.setNumber(t.options.site_id),n.toString()}function getTinyBody(e,t){var n,r=t.options,i=t.adUnitOptions,o=isDebug(r,i)||isQuery(r,i),a=((n={})[TU_PARAMS.ADBLOCKER]=!!t.adblock_detected,n[TU_PARAMS.BOOTSTRAP_VERSION]=t.options.bootstrap_version,n[TU_PARAMS.JS_APP_VERSION]=r.js_app_version,n[TU_PARAMS.PAGE_ID]=getPageID(),n[TU_PARAMS.PUBLISHER_UUID]=r.publisher_uuid,n[TU_PARAMS.SESSION_ID]=Cookies.get(COOKIE_KEY.SESSION_ID)||"",n[TU_PARAMS.SITE_UUID]=r.site_uuid,n[TU_PARAMS.TYPE]=e,n[TU_PARAMS.USER_ID]=Cookies.get(COOKIE_KEY.USER_ID)||"",n[TU_PARAMS.SUBSCRIPTION]=r.subscription_type,n);i&&(a[TU_PARAMS.ADUNIT_UUID]=i.adunit_uuid);try{a[TU_PARAMS.PAGE_URL]=window.top.location.href}catch(e){}if(t.backfill_script&&(a[TU_PARAMS.BACKFILL_SCRIPT]=t.backfill_script),t.url&&(a[TU_PARAMS.URLS]=[t.url]),t.logger_event&&(a[TU_PARAMS.LOGGER_EVENT]=t.logger_event),t.logger_error&&(a[TU_PARAMS.LOGGER_ERROR]=t.logger_error),t.pass_through&&(a[TU_PARAMS.PASS_THROUGH]=t.pass_through),t.request_id&&(a[TU_PARAMS.REQUEST_ID]=t.request_id),r.test_mode&&(a[TU_PARAMS.TEST_MODE]=r.test_mode,i&&(a[TU_PARAMS.SELECTOR]=i.selector)),t.method&&(a[TU_PARAMS.METHOD]=t.method),t.body&&""!==t.body&&(a[TU_PARAMS.BODY]=t.body),"vmap"!==e&&"ad"!==e||!t.custom_params||(a[TU_PARAMS.CUSTOM_PARAMS]=JSON.stringify(t.custom_params)),o&&(a[TU_PARAMS.DEBUG]=o,a[TU_PARAMS.CSS_ENCODER]=r.css_encoder),a[TU_PARAMS.TIME]=r.time,"media"===e&&t.url)a[TU_PARAMS.UUID]=md5$2(t.url),t.cacheable=!0;else if("pxy-resource"===e&&t.url&&url.isFixedResource(t.url)){var s=t.url;s+="?&_="+~~((new Date).getTime()/18e5)+"&v="+r.js_app_version,i&&(s+="&a="+i.adunit_uuid),a[TU_PARAMS.UUID]=md5$2(s),t.cacheable=!0}else a[TU_PARAMS.UUID]=uuidNoDashes();return t.cacheable&&(a[TU_PARAMS.PREDICTABLE]=!0),a}function getTinyURL(e,t){var n=t.tiny_body?t.tiny_body:getTinyBody(e,t),r=n[TU_PARAMS.UUID],i=getEPath("post-to-storage",t),o=(new Date).getTime(),a=appendDebug(e,t,generateURL(t,i),"POST",o),s=appendDebug(e,t,generateURL(t,r),"GET",o);return t.ignoreTinyURL||sendTinyBody(t,a,JSON.stringify(n)),s}function sendTinyBody(e,t,n){XHRRequest("POST",t,{body:n},e.adUnitOptions)}function generateURL(e,t){var n=e.options,r="";try{r=window.location.href}catch(e){}return""+getStableCdnURL(n.cdn_url,e.url||void 0,e.user_id||Cookies.get(COOKIE_KEY.USER_ID))+n.path_encode(new url.URL(r),"/"+t)}!function(e){function t(e,t,n){var r=getAppCache(window).cache,i=r.options,o=r.appMeta,a=n?r.adUnitMeta[n.adunit_uuid]:void 0;t&&String(t.message||"").length>2e3&&(t.message=String(t.message||"").substring(0,2e3)),t.publisher_uuid=i.publisher_uuid,t.site_uuid=i.site_uuid,n&&n.adunit_uuid&&(t.adunit_uuid=n.adunit_uuid),t.bootstrap_version=i.bootstrap_version,t.js_app_version=i.js_app_version,t.position=n?n.position:Position.NOT_KNOWN,t.subscription=i.subscription_type;var s=computePageLoadTime();s>0&&(t.load_time=s.toString()+"s"),t.bid_request||(t.bid_request={}),t.bid_request.id||(t.bid_request.id="-1"),t.bid_request.site||(t.bid_request.site={}),t.bid_request.site.page=window.location.href,t.bid_response&&!t.bid_response.id&&(t.bid_response.id="-1"),o.adblock_detected&&(t.adblocker=o.adblock_detected),t.page_id=getPageID(),t.session_id=Cookies.get(COOKIE_KEY.SESSION_ID),t.user_id=Cookies.get(COOKIE_KEY.USER_ID),t.cb=(new Date).getTime(),a&&a.adsource_id&&(t.adsource_id=a.adsource_id),a&&a.request_id&&(t.debug_info||(t.debug_info={}),t.debug_info.vmap_request_id=a.request_id);try{!function u(e,t,n,r){var i={adUnitOptions:r,options:n};"event"===e||"adevent"===e?i.logger_event=JSON.stringify(t):i.logger_error=JSON.stringify(t),"adevent"===e?(i.pass_through=!0,requestURL("tracker",i)):(new Image).src=getShortURL("tracker",i)}(e,t,r.options,n)}catch(e){}}e.LogEvent=function n(e,r){t("event",e,r)},e.LogAdEvent=function r(e,n){t("adevent",e,n)},e.LogError=function i(e,n){t("error",e,n)}}(Logger||(Logger={}));var REGEX_UUID$1=/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i,validators,Site;function getOverrideOptions(e,t){var n=getAppCache(e).cache.options,r=strings.split(e.location.hash.substring(1)).publica_override_uuid;r&&validators.isValidUUID(r)?XHR({method:"GET",url:n.cdn_url+"/v1/jsapp/get_override?uuid="+n.site_uuid+"&token="+r,callback:function(r,i){if(Debug.log("override response: "+i.responseText),r)t();else try{var o=JSON.parse(i.responseText);o&&"override"in o&&(n=getIJSAppOptions(o.override),getAppCache(e).cache.options=n,Debug.log(function(){return"options w/ override: "+JSON.stringify(n)}))}catch(e){var a={code:"HTTP_CALL",message:"error parsing the reponse as JSON "+i.responseText+", status: "+i.statusText};Debug.log(function(){return JSON.stringify(a)}),Logger.LogError(a)}finally{t()}}}):t()}function parseHeader(e,t,n){var r="";if(t instanceof XMLHttpRequest)try{r=t.getResponseHeader(e)||""}catch(e){}if(t instanceof Response)try{r=t.headers.get(e)||""}catch(e){}return Debug.log("[ADS] header "+e+": '"+r+"'",n),r}!function(e){e.isValidUUID=REGEX_UUID$1.test.bind(REGEX_UUID$1)}(validators||(validators={})),function(e){e.disable=function t(e,n,r,i){return new Promise(function(t){if(!0!==e||r&&1===r.b)return Logger.LogError({code:"BLOCKED_BY_ADBLOCK",message:n,site_disabled:!1},i),void t(!1);Debug.log("[PUBLICA] checking internet connection"),checkValidNetwork(findSources(document.querySelectorAll("img,picture source"),r.favicons),function(e,r){t(!e),e?(Debug.log("[SITE] site disable failed: "+r),Logger.LogError({code:"BLOCKED_BY_ADBLOCK",message:n,site_disabled:!1},i)):(Debug.log("[SITE] site disable success: "+r),Logger.LogError({code:"BLOCKED_BY_ADBLOCK",message:n,site_disabled:!0},i))})})}}(Site||(Site={}));var parseRequestID=parseHeader.bind(null,"Request-Id"),parseUserID=parseHeader.bind(null,"User-Id"),parseFillStatus=parseHeader.bind(null,"JjSBEjLaMkPuCQTR"),parseAdsourceID=parseHeader.bind(null,"Adsource-Id");function requestConfig(e,t,n,r){return void 0===n&&(n={}),t=Object.assign(t,{options:e}),r&&(t=Object.assign(t,{adUnitOptions:r.adUnitOptions,adblock_detected:r.appMeta.adblock_detected,ancestorOrigins:r.appMeta.ancestorOrigins,request_id:r.adUnitMeta.request_id}),r.hasCustomParams()&&(t=Object.assign(t,{custom_params:r.getCustomParams()}))),Object.assign(t,n)}function proxySiteAsset(e,t,n){return requestURL(t,requestConfig(e,{},n))}function proxy(e,t,n){return requestURL("pxy",requestConfig(e.options,{url:t},n,e))}function proxyVPaid(e,t,n){return proxyResource(e,t,n)}function proxyAdsource(e,t){if(e.options.no_tiny)return{method:"GET",url:requestURL("ad",requestConfig(e.options,{},t,e))};var n=requestConfig(e.options,{ignoreTinyURL:!0,method:"GET",pass_through:!0},t,e);return n.tiny_body=getTinyBody("ad",n),{body:JSON.stringify(n.tiny_body),method:"POST",url:requestURL("ad",n)}}function proxyResource(e,t,n){return requestURL("pxy-resource",requestConfig(e.options,{url:t},n,e))}function proxyTracker(e,t,n){return requestURL("tracker",requestConfig(e.options,{url:t},n,e))}function checkAPI(e){var t=requestURL("health",requestConfig(e.options,{cacheable:!0,cb:36e5*~~((new Date).getTime()/36e5)},{},e));return new Promise(function(e,n){checkCtrlAPI(t,function(t,r){t?n(t):e(r)})})}function fallbackAdsourceCB(e,t,n){var r=t.options,i=t.adUnitOptions;return function(o,a){o?o===ErrBlockedByAdblock?checkAPI(t).then(function(t){t?Site.disable(!0,"method: "+e.method+", url: "+e.url,r,i).then(function(e){e||n(o,a)}):(Debug.log("[ADS] API is not healthy",i),n(o,a))},function(){Debug.log("[ADS] API is not healthy",i),n(o,a)}):(Debug.log("[ADS] API responded with error",i),n(o,a)):n(null,a)}}function requestAdsource(e,t,n){Debug.log("[ADS] starting loadVMAP(), calling the ADCTRL at "+new url.URL(e.url).host+", withCredentials: "+e.withCredentials,t),e.callback=n,XHR(e,t)}function loadAdsource(e,t,n){var r=e.options,i=e.adUnitOptions;isValidUUID(Cookies.get(COOKIE_KEY.USER_ID))||Cookies.remove(COOKIE_KEY.USER_ID);var o=proxyAdsource(e,{backfill_script:t}),a=o.url,s={body:o.body,method:o.method,timeout:1e4,url:a,withCredentials:!Cookies.get(COOKIE_KEY.USER_ID)};requestAdsource(s,i,function(t,o){var u=parseUserID(o,i);if(u&&Cookies.set(COOKIE_KEY.USER_ID,u,{expires:Cookies.EXPIRE_USER_ID}),t){var c=fallbackAdsourceCB(s,e,n);t===ErrBlockedByAdblock?checkAPI(e).then(function(e){e?Site.disable(!0,"method: "+s.method+", url: "+a,r,i).then(function(e){e?n(t,o):requestAdsource(s,i,c)}):(Debug.log("[ADS] API is not healthy"),n(t,o))},function(){Debug.log("[ADS] API is not healthy"),n(t,o)}):t===ErrDisabledByCORS?requestAdsource(s,i,c):n(t,o)}else n(null,o)})}function loadAdsourcePromise(e,t){return new Promise(function(n,r){loadAdsource(e,t,function(e,t){e?r(e):n(t)})})}function facebookTokenPromise(e){var t=e.options,n=e.adUnitOptions;return n.fb_placement_id?new Promise(function(t){Debug.log("[ADS][FB] placement ID set to "+n.fb_placement_id+", querying facebook for a token",n);var r=function(){var e=document.querySelector(n.selector);return new window.AudienceNetworkPrebid(n.fb_placement_id,e).getProfile(function(e){return t(e.token)})};if("AudienceNetworkPrebid"in window)r();else{var i=document.createElement("script");i.async=!0,i.src=proxy(e,"//connect.facebook.com/en_US/AudienceNetworkPrebid.js"),i.onload=function(){var e;e=window.setInterval(function(){"AudienceNetworkPrebid"in window&&(clearInterval(e),r())},10)},i.onerror=function(){t()},(document.head||document.body).appendChild(i)}}).then(function(e){e&&(Debug.log("[ADS][FB] got the token "+e,n),t.site_custom.fbToken=e,t.site_custom.fbPlacementID=n.fb_placement_id)}):(Debug.log("[ADS][FB] no placement ID found, not querying facebook for a token",n),Promise.resolve())}var AdsCache=function(){function e(e,t){this.ctxWin=e;var n=getAppCache(e),r=n.cache;this.win=n.win,this.options=r.options,this.appMeta=r.appMeta,this.adUnitOptions=findAdunitByID(r,t),this.adUnitMeta=r.adUnitMeta[this.adUnitOptions.adunit_uuid]}return e.prototype.hasCustomParams=function(){return!!this.options.test_mode||Object.keys(this.getCustomParams()).length>0},e.prototype.getCustomParams=function(){var e=Object.assign({},this.options.site_custom,this.adUnitOptions.adunit_custom);try{return this.adUnitOptions.custom_params_func(this.options,this.adUnitOptions,e)||e}catch(t){return e||{}}},e.prototype.isDebug=function(){return this.options.debug||this.adUnitOptions.debug},e.prototype.isQuery=function(){return this.options.qy||this.adUnitOptions.qy},e}(),adsCacheMap={};function getAdsCache(e){return adsCacheMap[e]}function setAdsCache(e){adsCacheMap[e.adUnitOptions.adunit_uuid]=e}function removeAdsCache(e){delete adsCacheMap[e]}var MAX_SITE_EVENTS=10,EVENT_COMPLETE="event_complete",EVENT_END="event_end",EVENT_RESUME="event_resume",EVENT_FILLED="event_filled",EVENT_UNFILLED="event_unfilled",EVENT_VIEWABLE="event_viewable",EVENT_CLICK="event_click",EVENT_ERROR="event_error",EVENT_IMPRESSION="event_impression",EVENT_SITE_RELOAD="event_site_reload",EVENT_ADUNITS_RELOAD="event_adunits_reload",EVENT_IMA3_LOADED="event_ima3_loaded",EVENT_FULLSCREEN="event_fullscreen",EVENT_EXIT_FULLSCREEN="event_exit_fullscreen",EVENT_RESUMED="event_resumed",EVENT_PAUSED="event_paused",EVENT_REQUEST="event_request",EVENT_START="event_start",EVENT_SKIP="event_skip",EVENT_QUARTILE1="event_quartile1",EVENT_QUARTILE2="event_quartile2",EVENT_QUARTILE3="event_quartile3",EVENT_DURATION_CHANGE="event_duration_change",TAG_READY="tag_ready",TAG_ERROR="tag_error",DISPLAY_READY="display_ready",DISPLAY_ERROR="display_error",ADSLOT_DETECTED="adslot_detected",SITE_EVENTS=(_a={},_a[EVENT_COMPLETE]=[],_a[EVENT_END]=[],_a[EVENT_RESUME]=[],_a[EVENT_FILLED]=[],_a[EVENT_UNFILLED]=[],_a[EVENT_VIEWABLE]=[],_a[EVENT_CLICK]=[],_a[EVENT_ERROR]=[],_a[EVENT_IMPRESSION]=[],_a[EVENT_SITE_RELOAD]=[],_a[EVENT_ADUNITS_RELOAD]=[],_a[EVENT_IMA3_LOADED]=[],_a[EVENT_FULLSCREEN]=[],_a[EVENT_EXIT_FULLSCREEN]=[],_a[EVENT_RESUMED]=[],_a[EVENT_PAUSED]=[],_a[EVENT_START]=[],_a[EVENT_SKIP]=[],_a[EVENT_QUARTILE1]=[],_a[EVENT_QUARTILE2]=[],_a[EVENT_QUARTILE3]=[],_a[EVENT_DURATION_CHANGE]=[],_a[TAG_READY]=[],_a[TAG_ERROR]=[],_a[DISPLAY_READY]=[],_a[DISPLAY_ERROR]=[],_a[ADSLOT_DETECTED]=[],_a),cache=getAppCache(window).cache,CMDEvents,BundleType;function getOpts(e){if(isString(e))return{adunit_uuid:e};if(isObject(e))return e;throw new Error("")}function join(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return[].concat.apply([],e).filter(function(e){return!!e})}function initPAPI(e,t){e.pAPI||(e.pAPI=function(e,t){n.$cmd.push([e,t])});var n=e.pAPI;if(n.$s)return!1;n.$s=!0,n.$win=e;var r=getAppCache(n.$win).cache;return n.$cmd=e[t.site_uuid+"-cmd"]||n.$cmd||[],n.$evd=join(e.pAPI.handlers,e.pAPI.$evd),n.$evr=e.pAPI.$evr||[],n.adslotDetected=function(e){n.$evd.push(e)},n.ready=function(e){n.$evr.push(e)},n.proxyResource=function(e,n){try{var i=getOpts(n),o=getAdsCache((findAdunit(r,function(e){return t.bundle_type===BundleType.IMA3||e.adunit_uuid===n.adunit_uuid})||r.adUnitOptions[0]).adunit_uuid);if(o)return proxyResource(o,e,i)}catch(e){}return e},n.on=CMDEvents.on,n.one=CMDEvents.one,n.off=CMDEvents.off,n.removeAllEvents=CMDEvents.removeAll,n.logEvent=function(e,n){var i;try{i=getAdsCache(findAdunitByID(r,n||0).adunit_uuid)}catch(e){Debug.log("[pAPI.logEvent] error running findAdunitByID(cache, adunit || 0): "+JSON.stringify(e))}finally{i||(i=getAdsCache(r.adUnitOptions[0].adunit_uuid))}"string"!=typeof e&&(e=JSON.stringify(e)),requestURL("tracker",requestConfig(t,{logger_event:e,pass_through:!0},{},i))},n.logError=function(e,n){var i;try{i=getAdsCache(findAdunitByID(r,n||0).adunit_uuid)}catch(e){Debug.log("[pAPI.logError] error running findAdunitByID(cache, adunit || 0): "+JSON.stringify(e))}finally{i||(i=getAdsCache(r.adUnitOptions[0].adunit_uuid))}"string"!=typeof e&&(e=JSON.stringify(e)),requestURL("tracker",requestConfig(t,{logger_error:e,pass_through:!0},{},i))},!0}function getPAPI(){return window.pAPI}function execPAPIReady(){var e=getPAPI(),t=getAppCache(e.$win).cache,n={adblock_detected:t.appMeta.adblock_detected,site_uuid:t.options.site_uuid};e.ready=function(e){execFunc(e,n)};for(var r=0,i=e.$evr;r<i.length;r++)execFunc(i[r],n)}!function(e){function t(e){return SITE_EVENTS.hasOwnProperty(e)}function n(e,n){isFunc(n)&&t(e)&&(SITE_EVENTS[e].length>MAX_SITE_EVENTS&&SITE_EVENTS[e].shift(),SITE_EVENTS[e].push(n))}function r(e,n){if(isFunc(n)&&t(e))for(var r=0;r<SITE_EVENTS[e].length;r+=1)SITE_EVENTS[e][r]===n&&SITE_EVENTS[e].splice(r,1)}e.contains=t,e.pop=function i(e){if(t(e))return SITE_EVENTS[e].pop()},e.on=n,e.one=function o(e,i){if(isFunc(i)&&t(e)){var o=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];r(e,o),i.apply(void 0,t)};n(e,o)}},e.off=r,e.removeAll=function a(e){if(t(e))for(;SITE_EVENTS[e].length>0;)SITE_EVENTS[e].shift()},e.exec=function s(e,t,n){Debug.log("[pAPI] Execute event: "+e,t),(SITE_EVENTS[e]||[]).forEach(function(r){execFunc(r,function i(e,t,n){var r={adblock_detected:cache.appMeta.adblock_detected,name:e,site_uuid:cache.options.site_uuid};return t&&(r.adunit_uuid=t.adunit_uuid),"object"==typeof n?Object.assign({},n,r):r}(e,t,n))})}}(CMDEvents||(CMDEvents={})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.JSAPP=1]="JSAPP",e[e.IMA3=2]="IMA3"}(BundleType||(BundleType={}));var execPAPIAdslotDetected=execOnce(function(e){var t=getPAPI();t.adslotDetected=function(t){execFunc(t,e)};for(var n=0,r=t.$evd;n<r.length;n++)execFunc(r[n],e)}),Subscription;function hasFeatures(){var e={atob:!!atob&&!!btoa,proxy:!!Proxy,xhr:!!XMLHttpRequest,xhrCreds:!1};if(e.xhr){var t=new XMLHttpRequest;e.xhrCreds="withCredentials"in t}return e}function canRecover(e){var t=+e.recovery_percentage;if(t>=0){var n=Math.round(100*Math.random());if(Debug.log("[STARTAPP] got the dice "+n+", recovering "+t+"%"),n>t)return Logger.LogEvent({type:"NOTRECOVERED_REQUEST"}),Debug.log("[STARTAPP] dice-roll did not match the recovery_percentage, not running ads"),!1}return Debug.log("[STARTAPP] dice-roll matched the recovery_percentage, running ads"),!0}function isValidSubscription(e){return e.subscription_type<Subscription.DIRECT_RECOVERY?(Debug.log("[STARTAPP] Subscription: "+Subscription[e.subscription_type]+", recovery not allowed"),!1):(Debug.log("[STARTAPP] Subscription: "+Subscription[e.subscription_type]+", recovery allowed"),!0)}function canLoad(e,t){return"function"!=typeof t.onload||t.onload(e,t)?(Debug.log("[STARTAPP] adunit.onload passed, running ad",t),!0):(Debug.log("[STARTAPP] adunit.onload failed, not running ad",t),!1)}function setup(e,t){var n=initAppCache(e);if(initPAPI(e,n.options)){var r=hasFeatures();if(!r.xhr||!r.xhrCreds||!r.atob)return Logger.LogError({code:"SCRIPT_LOADING",message:"Missing browser features: "+JSON.stringify(r)}),n.appMeta.adblock_detected=!1,void t();Cookies.set(COOKIE_KEY.SESSION_ID,Cookies.get(COOKIE_KEY.SESSION_ID)||uuid4(),{expires:1/24}),pageReady(function(){Logger.LogEvent({type:"PAGE_VIEW"})}),n.appMeta.adblock_detected=!1;var i=execOn(2,function(){execPAPIReady(),Logger.LogEvent({type:"SCRIPT_LOADED"}),t()}),o=execOnce(function(e){n.appMeta.adblock_detected=e,Debug.log(e?"[STARTAPP] an adblocker was detected":"[STARTAPP] an adblocker was not detected"),i()});setTimeout(function(){o(!1)},3e4),detectAdblock(e,function(e,t){o(!e&&t)}),getOverrideOptions(e,function(){i()})}}!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.ANALYTICS=1]="ANALYTICS",e[e.DIRECT_RECOVERY=2]="DIRECT_RECOVERY",e[e.PUBLICA_RECOVERY=3]="PUBLICA_RECOVERY"}(Subscription||(Subscription={}));var invPlayers={};function initInventory(e){var t=getAdunitsByPosition(e,Position.INVENTORY);t.length>0&&(Debug.log("[STARTAPP] trying to load position inventory"),t.forEach(function(t){invPlayers[t.adunit_uuid]&&(Debug.log("[INV] cleaning up inventory check",t),window.clearInterval(invPlayers[t.adunit_uuid]));var n=function(){Debug.log("[INV] starting inventory check ('"+t.selector+"')",t)};n();var r=!0;invPlayers[t.adunit_uuid]=window.setInterval(function(){if(r){var i=document.querySelector(t.selector);i&&(!t.viewport_check||t.viewport_check&&isElementVisible(i,.5))&&canLoad(e.options,t)&&(Debug.log("[INV] found inventory: '"+t.selector+"'",t),Logger.LogEvent({type:"REQUEST"}),r=!1)}else t.watcher_func(t)&&(n(),r=!0)},250)}))}var isEnabled=/(Chrom(e|ium)|Safari)\//;function checkToString(e){if(!isEnabled.test(e.navigator.userAgent))return!1;var t=/./,n=!1;return t.toString=function(){n=!0},console.log("%c",t),n}function hasFirebug(e){return e.Firebug&&e.Firebug.chrome&&e.Firebug.chrome.isInitialized}function checkDimensions(e,t){var n=e.outerWidth-e.innerWidth>t,r=e.outerHeight-e.innerHeight>t;return!(r&&n)&&(hasFirebug(e)||n||r)}function isDevtoolsOpen(e,t){return void 0===t&&(t=160),!!checkToString(e)||checkDimensions(e,t)}function checkDevtoolsOpen(e){try{var t=isDevtoolsOpen(e);return t&&e.localStorage.setItem(getUserID()+".tools","true"),t}catch(e){}return!1}function isDevtoolsEnabled(){try{return!!window.localStorage.getItem(getUserID()+".tools")}catch(e){}return!1}function getUserID(){var e=Cookies.get(COOKIE_KEY.USER_ID);return e||(e="anonymous_"+utcHour()),e}function throttleCommands(e,t){return Object.keys(e).forEach(function(n){if(n in e&&!t(n)){var r=e[n];e[n]=throttle(2e3,function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];window.setTimeout(function(){r.apply(e,t)},1)}.bind(e))}}),e}function getPageHrefWatcherLocation(e){function t(){return 1===e.pagehref_watcher_type?window.location.pathname+window.location.search:window.location.href}var n=t();return function(){var e=t();return n!==e&&(n=e,!0)}}function getSiteStateChange(e){return 1===e.pagehref_watcher_type||2===e.pagehref_watcher_type?getPageHrefWatcherLocation(e):3===e.pagehref_watcher_type?function(){return e.pagehref_watcher_func(e)}:function(){return!1}}function getICustomParams(e){if(Array.isArray(e)){var t={};return e.forEach(function(e){e&&e.adunit_uuid&&(t[e.adunit_uuid]=e)}),{adunits:t,site:{}}}return{adunits:{},site:e}}function passthru(e){return"log_event"===e||"ad"===e}function initCMDQueue(e){var t=getAppCache(window).cache;if(t.options.console_disable&&isDevtoolsEnabled())return!1;e=throttleCommands(e,function(e){return"log_event"===e});var n=getPAPI(),r=getSiteStateChange(t.options);return docReady(function(){var i=window.setInterval(function(){if(t.options.console_disable&&!isDevtoolsEnabled()&&checkDevtoolsOpen(window)){n.logEvent('{"type": "CONSOLE_DISABLED"}'),window.clearInterval(i);try{window.top.location.reload()}catch(e){try{var o=getWritableWin(window);o&&o.location.reload()}catch(e){}}}else{if(r())n.$cmd.push(["init"]),CMDEvents.exec(EVENT_SITE_RELOAD,void 0);else{var a=getInstreamOutstreamAdunits(t).filter(function(e){return e.watcher_func(e)});a.length>0&&(CMDEvents.exec(EVENT_ADUNITS_RELOAD,void 0,{adunit_uuids:a.map(function(e){return e.adunit_uuid})}),n.$cmd.push(["init",a.map(function(e){return{adunit_uuid:e.adunit_uuid}})]))}for(;n.$cmd.length>0;){var s=n.$cmd.shift();if(Array.isArray(s)){var u=("string"==typeof s[0]?s[0]:"").toLowerCase(),c=e[u];c?c(passthru(u)?s[1]:getICustomParams(s[1])):CMDEvents.one(u,s[1])}}}},250)}),!0}var blaclistedAttrs={async:!0,defer:!0,href:!0,src:!0},scripts,pr;function cloneAttrs(e,t){if((e||e.attributes)&&t)for(var n=0,r=e.attributes;n<r.length;n++){var i=r[n];if(!blaclistedAttrs.hasOwnProperty(i.name))try{t.setAttribute(i.name,i.value||"")}catch(e){}}}function loadProxy(e,t){return Debug.log("[STARTAPP] trying to load proxy-js",t.adUnitOptions),pr||(pr=new Promise(function(n,r){var i=getWritableWin(e);i.proxy&&n(),scripts.load(i,proxySiteAsset(t.options,"proxy-js"),function(e){if(e)return r(new Error("unable to load proxy-js"));n()})})),pr}!function(e){function t(e,t,n,r){var i=document.createElement("script");return i.src=t,i.defer=!0,n&&(i.onload=n.bind(e,!1),i.onerror=n.bind(e,!0)),r&&Object.keys(r).forEach(function(e){r.hasOwnProperty(e)&&i.setAttribute(e,r[e])}),e.document.body.appendChild(i),i}e.load=t,e.loadTags=function n(e,r,i,o){!function e(n,r,i,o,a){for(var s=!1,u=[],c=i,l=function(){var e=r[c];if(!e)return"break";if(e.src)s=!0,u.push(new Promise(function(r,i){cloneAttrs(e,t(n,e.src,function(e){(e?i:r)()}))}));else{if(s)return"break";var i=document.createElement("script");cloneAttrs(e,i),i.innerHTML=e.innerHTML,n.document.body.appendChild(i)}};c<r.length&&"break"!==l();c+=1);s?Promise.all(u).then(function(){e(n,r,c,o,a)},function(){a()}):o()}(e,r.querySelectorAll("script"),0,i,o)}}(scripts||(scripts={}));var AdsDisplay=function(e){function t(t,n){var r=e.call(this,t,n.adunit_uuid)||this;return r.type="display",r}return __extends(t,e),t.prototype.load=function(){var e=this,t=getWritableWin(this.win);Promise.all([this.fetchScript(),loadProxy(t,this)]).then(function(){return new Promise(function(n,r){var i=document.createElement("div");t.proxy(i,"innerHTML",e.adUnitOptions.adunit_id).innerHTML=e.displayScript,scripts.loadTags(e.win,i,n,r)})}).then(function(){setTimeout(function(){CMDEvents.exec(DISPLAY_READY,e.adUnitOptions)},10)},function(){setTimeout(function(){CMDEvents.exec(DISPLAY_ERROR,e.adUnitOptions),Debug.log("[ADS] failed to execute the display script.",e.adUnitOptions)},10)})},t.prototype.fetchScript=function(){var e=this;return loadAdsourcePromise(this,!1).then(function(t){return e.adUnitMeta.request_id=parseRequestID(t,e.adUnitOptions),"string"==typeof e.adUnitOptions.$adscript?(e.displayScript=e.adUnitOptions.$adscript,Promise.resolve()):(e.displayScript=t.responseText,Promise.resolve())},function(){return Debug.log("[ADS] error retrieving the display script.",e.adUnitOptions),Logger.LogError({code:"HTTP_CALL",message:"error retrieving the outstream script"},e.adUnitOptions),Promise.reject(void 0)})},t}(AdsCache);function getDimensions(e){if(!e)return{height:0,width:0};var t=e.getBoundingClientRect();return{height:t.height,width:t.width}}function cssText(e){return e?Object.keys(e).sort().map(function(t){return t+": "+e[t]+" !important"}).join(";"):""}var IMA3EVENTS={events:{IMPRESSION:"IMPRESSION",STARTED:"START",SKIP:"SKIP",CLICK:"CLICK",FIRST_QUARTILE:"QUARTILE1",MIDPOINT:"QUARTILE2",THIRD_QUARTILE:"QUARTILE3",COMPLETE:"COMPLETE",ALL_ADS_COMPLETED:"ALL_ADS_COMPLETED",CONTENT_PAUSE_REQUESTED:"CONTENT_PAUSE_REQUESTED",CONTENT_RESUME_REQUESTED:"CONTENT_RESUME_REQUESTED",VOLUME_MUTED:"MUTE",LOADED:"LOADED",PAUSED:"PAUSE",RESUMED:"RESUME",AD_BREAK_READY:"AD_BREAK_READY",AD_METADATA:"AD_METADATA",DURATION_CHANGE:"DURATION_CHANGE",INTERACTION:"INTERACTION",SKIPPABLE_STATE_CHANGED:"SKIPPABLE_STATE_CHANGED",SKIPPED:"SKIPPED",USER_CLOSE:"USER_CLOSE",VOLUME_CHANGED:"VOLUME_CHANGED",FULLSCREEN:"FULLSCREEN",EXIT_FULLSCREEN:"EXIT_FULLSCREEN"},errors:{AD_ERROR:"ERROR"}},IMA3AdType;function xmlToString(e){return(new XMLSerializer).serializeToString(e)}function forEach(e,t){for(var n=0;n<e.length;n+=1)e[n]&&t(e[n],n,e)}function parseAdTrackers(e,t){forEach(e.querySelectorAll("TrackingEvents>Tracking"),function(e){var n=e.getAttribute("event")||"";n&&(t.events[n]||(t.events[n]=[]),t.events[n].push((e.textContent||"").trim()))})}function getAttr(e,t){return e&&t?(e.getAttribute(t)||"").trim():""}function parseIMA3AdXML(e,t){var n={type:IMA3AdType.UNKNOWN,data:"",events:{}};if(e.querySelector("VMAP")){if(t){var r=!1;return forEach(e.querySelectorAll("AdBreak"),function(e){if(!r&&("preroll"===t&&"start"===getAttr(e,"timeOffset")||"postroll"===t&&"end"===getAttr(e,"timeOffset")||getAttr(e,"breakId")===t)){var i=e.querySelector("VAST");if(i)return parseAdTrackers(e,n={type:IMA3AdType.VAST_XML,data:xmlToString(i),events:{}}),void(r=!0);var o=e.querySelector("AdTagURI");o&&(parseAdTrackers(e,n={type:IMA3AdType.VAST_URL,data:o.textContent||"",events:{}}),r=!0)}}),n}return{type:IMA3AdType.VMAP,data:xmlToString(e),events:{}}}return e.querySelector("VAST")?{type:IMA3AdType.VAST_XML,data:xmlToString(e),events:{}}:n}function parseIMA3AdString(e){var t={type:IMA3AdType.UNKNOWN,data:"",events:{}};if(e){var n=(new DOMParser).parseFromString(e,"application/xml");if(n.querySelector("VMAP"))return{type:IMA3AdType.VMAP,data:e,events:{}};if(n.querySelector("VAST"))return{type:IMA3AdType.VAST_XML,data:e,events:{}}}return t}function fallthrough(e){return e}function trackEvent(e,t,n){void 0===n&&(n=fallthrough),e&&e.events&&Array.isArray(e.events[t])&&e.events[t].forEach(function(e){try{(new Image).src=n(e)}catch(e){}})}function flexWrapper(e){var t=document.createElement("div");return t.style.cssText=cssText({flex:"0"}),t.appendChild(e),t}function largeButtonWrapper(e){var t=document.createElement("div");return t.appendChild(e),t.style.cssText=cssText({position:"absolute",left:"50%",top:"50%",width:"100px",height:"100px","margin-top":"-50px","margin-left":"-50px","z-index":"100"}),t}function createSpacer(){var e=document.createElement("div");return e.style.cssText=cssText({flex:"1"}),e}function createSvgIconButton(e){var t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.innerHTML=e,t.style.cssText=cssText({height:"100%",width:"100%"});var n=document.createElement("a");return n.style.cssText=cssText({color:"white",cursor:"pointer",display:"block",fill:"currentColor",height:"38px",width:"38px"}),n.appendChild(t),n}function createLargePlayButton(){var e=createSvgIconButton('<g><polygon points="25,18 80,48 25,78"/></g');return e.style.backgroundColor="rgba(0, 0, 0, 0.5)",e.style.borderRadius="10px",e.style.width=e.style.height="100px",e}function createVolumeBar(){var e=document.createElement("div");e.style.cssText=cssText({"background-color":"rgba(255, 255, 255, 0.2)",cursor:"pointer",display:"block",height:"10px",margin:"14px 10px 14px 0",position:"relative",width:"80px"});var t=document.createElement("div");return t.style.cssText=cssText({"background-color":"goldenrod",height:"100%",left:"0",position:"absolute",top:"0",width:"100%"}),e.appendChild(t),e}!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.VMAP=1]="VMAP",e[e.VAST_XML=2]="VAST_XML",e[e.VAST_URL=3]="VAST_URL"}(IMA3AdType||(IMA3AdType={}));var IMA3IFramePlayerControls=function(){function e(e){this.isPausedByControls=!1,this.onEvent=e.onEvent,this.adsManager=e.adsManager,this.containerEl=e.containerEl,this.imasdk=e.imasdk}return e.prototype.init=function(){this.buildUI(),this.addStateEvents()},e.prototype.destroy=function(){this.adsManager=null},e.prototype.addStateEvents=function(){var e=this;this.adsManager.addEventListener(this.imasdk.AdEvent.Type.PAUSED,function(){e.ui.pauseButton.style.display="none",e.ui.playButton.style.display="block",e.ui.largePlayButtonWrap.style.display="block"}),this.adsManager.addEventListener(this.imasdk.AdEvent.Type.RESUMED,function(){e.ui.pauseButton.style.display="block",e.ui.playButton.style.display="none",e.ui.largePlayButtonWrap.style.display="none",e.isPausedByControls=!1}),this.adsManager.addEventListener(this.imasdk.AdEvent.Type.VOLUME_CHANGED,function(){var t=e.adsManager.getVolume();e.ui.mutedButton.style.display="none",e.ui.volumeLowButton.style.display="none",e.ui.volumeHighButton.style.display="none",0===t?e.ui.mutedButton.style.display="block":t<.5?e.ui.volumeLowButton.style.display="block":e.ui.volumeHighButton.style.display="block",e.ui.volumeBar.firstElementChild.style.width=100*t+"%"}),["webkitfullscreenchange","mozfullscreenchange","fullscreenchange"].forEach(function(t){on$1(document,t,function(){setTimeout(function(){var t=e.containerEl.getBoundingClientRect();e.adsManager.resize(t.width,t.height,e.imasdk.ViewMode.NORMAL);var n=document;n.fullscreenElement||n.webkitFullscreenElement||n.mozFullscreenElement||n.fullscreenElement||n.webkitFullscreenElement||n.mozFullscreenElement?(e.ui.fullscreenButton.style.display="none",e.ui.smallScreenButton.style.display="block",e.onEvent(IMA3EVENTS.events.FULLSCREEN)):(e.ui.fullscreenButton.style.display="block",e.ui.smallScreenButton.style.display="none",e.onEvent(IMA3EVENTS.events.EXIT_FULLSCREEN))},600)})})},e.prototype.buildUI=function(){var e=this,t=document.createElement("div");this.containerEl.appendChild(t);var n=document.createElement("div");n.style.cssText=cssText({"background-color":"rgba(0, 0, 0, 0.2)",bottom:"0",display:"flex",height:"38px",position:"absolute",width:"100%","z-index":"100","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none"}),t.appendChild(n);var r=createLargePlayButton();this.ui={largePlayButtonWrap:largeButtonWrapper(r),largePlayButton:r,fullscreenButton:createSvgIconButton('<g><path d="m 10,16 2,0 0,-4 4,0 0,-2 L 10,10 l 0,6 0,0 z"></path></g><g><path d="m 20,10 0,2 4,0 0,4 2,0 L 26,10 l -6,0 0,0 z"></path></g><g><path d="m 24,24 -4,0 0,2 L 26,26 l 0,-6 -2,0 0,4 0,0 z"></path></g><g><path d="M 12,20 10,20 10,26 l 6,0 0,-2 -4,0 0,-4 0,0 z"></path></g>'),mutedButton:createSvgIconButton('<g><path d="m 21.48,17.98 c 0,-1.77 -1.02,-3.29 -2.5,-4.03 v 2.21 l 2.45,2.45 c .03,-0.2 .05,-0.41 .05,-0.63 z m 2.5,0 c 0,.94 -0.2,1.82 -0.54,2.64 l 1.51,1.51 c .66,-1.24 1.03,-2.65 1.03,-4.15 0,-4.28 -2.99,-7.86 -7,-8.76 v 2.05 c 2.89,.86 5,3.54 5,6.71 z M 9.25,8.98 l -1.27,1.26 4.72,4.73 H 7.98 v 6 H 11.98 l 5,5 v -6.73 l 4.25,4.25 c -0.67,.52 -1.42,.93 -2.25,1.18 v 2.06 c 1.38,-0.31 2.63,-0.95 3.69,-1.81 l 2.04,2.05 1.27,-1.27 -9,-9 -7.72,-7.72 z m 7.72,.99 -2.09,2.08 2.09,2.09 V 9.98 z"></path></g>'),pauseButton:createSvgIconButton('<g><path d="M11,10 L17,10 17,26 11,26 M20,10 L26,10 26,26 20,26"/></path></g>'),playButton:createSvgIconButton('<g><path d="M11,10 L18,13.74 18,22.28 11,26 M18,13.74 L26,18 26,18 18,22.28"/></path></g>'),smallScreenButton:createSvgIconButton('<g><path d="m 14,14 -4,0 0,2 6,0 0,-6 -2,0 0,4 0,0 z"></path></g><g><path d="m 22,14 0,-4 -2,0 0,6 6,0 0,-2 -4,0 0,0 z"></path></g><g><path d="m 20,26 2,0 0,-4 4,0 0,-2 -6,0 0,6 0,0 z"></path></g><g><path d="m 10,22 4,0 0,4 2,0 0,-6 -6,0 0,2 0,0 z"></path></g>'),volumeBar:createVolumeBar(),volumeHighButton:createSvgIconButton('<g><path d="M8,21 L12,21 L17,26 L17,10 L12,15 L8,15 L8,21 Z M19,14 L19,22 C20.48,21.32 21.5,19.77 21.5,18 C21.5,16.26 20.48,14.74 19,14 ZM19,11.29 C21.89,12.15 24,14.83 24,18 C24,21.17 21.89,23.85 19,24.71 L19,26.77 C23.01,25.86 26,22.28 26,18 C26,13.72 23.01,10.14 19,9.23 L19,11.29 Z"/></path></g>'),volumeLowButton:createSvgIconButton('<g><path d="M8,21 L12,21 L17,26 L17,10 L12,15 L8,15 L8,21 Z M19,14 L19,22 C20.48,21.32 21.5,19.77 21.5,18 C21.5,16.26 20.48,14.74 19,14 Z"/></path></g>')},t.appendChild(this.ui.largePlayButtonWrap),n.appendChild(flexWrapper(this.ui.pauseButton)),n.appendChild(flexWrapper(this.ui.playButton)),n.appendChild(createSpacer()),n.appendChild(flexWrapper(this.ui.mutedButton)),n.appendChild(flexWrapper(this.ui.volumeLowButton)),n.appendChild(flexWrapper(this.ui.volumeHighButton)),n.appendChild(flexWrapper(this.ui.volumeBar)),n.appendChild(flexWrapper(this.ui.fullscreenButton)),n.appendChild(flexWrapper(this.ui.smallScreenButton)),this.ui.largePlayButtonWrap.style.display="none",this.ui.playButton.style.display="none",this.ui.mutedButton.style.display="none",this.ui.volumeLowButton.style.display="none",this.ui.volumeHighButton.style.display="none";var i=this.adsManager.getVolume();0===i?this.ui.mutedButton.style.display="block":i<.5?this.ui.volumeLowButton.style.display="block":this.ui.volumeHighButton.style.display="block",this.ui.volumeBar.firstElementChild.style.width=100*i+"%",this.ui.smallScreenButton.style.display="none",on$1(this.ui.pauseButton,"click",function(){e.adsManager.pause(),e.isPausedByControls=!0}),[this.ui.playButton,this.ui.largePlayButton].forEach(function(t){on$1(t,"click",function(){e.adsManager.resume(),e.isPausedByControls=!1})}),on$1(this.ui.mutedButton,"click",function(){e.adsManager.setVolume(i)}),on$1(this.ui.volumeLowButton,"click",function(){i=e.adsManager.getVolume(),e.adsManager.setVolume(0)}),on$1(this.ui.volumeHighButton,"click",function(){i=e.adsManager.getVolume(),e.adsManager.setVolume(0)}),on$1(this.ui.volumeBar,"click",function(t){t.currentTarget&&e.adsManager.setVolume(i=t.offsetX/e.ui.volumeBar.offsetWidth)}),on$1(this.ui.fullscreenButton,"click",function(){var t=e.containerEl,n=t.requestFullscreen||t.webkitRequestFullscreen||t.mozRequestFullscreen||t.requestFullscreen||t.webkitRequestFullscreen||t.mozRequestFullscreen;n&&n.call(t)}),on$1(this.ui.smallScreenButton,"click",function(){var e=document,t=e.exitFullscreen||e.webkitExitFullscreen||e.webkitCancelFullscreen||e.mozCancelFullscreen;t&&t.call(e)})},e}(),AUDIO=new Blob([new Uint8Array([255,227,24,196,0,0,0,3,72,1,64,0,0,4,132,16,31,227,192,225,76,255,67,12,255,221,27,255,228,97,73,63,255,195,131,69,192,232,223,255,255,207,102,239,255,255,255,101,158,206,70,20,59,255,254,95,70,149,66,4,16,128,0,2,2,32,240,138,255,36,106,183,255,227,24,196,59,11,34,62,80,49,135,40,0,253,29,191,209,200,141,71,7,255,252,152,74,15,130,33,185,6,63,255,252,195,70,203,86,53,15,255,255,247,103,76,121,64,32,47,255,34,227,194,209,138,76,65,77,69,51,46,57,55,170,170,170,170,170,170,170,170,170,170,255,227,24,196,73,13,153,210,100,81,135,56,0,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170])],{type:"audio/mpeg"}),VIDEO=new Blob([new Uint8Array([0,0,0,28,102,116,121,112,105,115,111,109,0,0,2,0,105,115,111,109,105,115,111,50,109,112,52,49,0,0,0,8,102,114,101,101,0,0,2,239,109,100,97,116,33,16,5,32,164,27,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,55,167,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,112,33,16,5,32,164,27,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,55,167,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,112,0,0,2,194,109,111,111,118,0,0,0,108,109,118,104,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,232,0,0,0,47,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,1,236,116,114,97,107,0,0,0,92,116,107,104,100,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,47,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,36,101,100,116,115,0,0,0,28,101,108,115,116,0,0,0,0,0,0,0,1,0,0,0,47,0,0,0,0,0,1,0,0,0,0,1,100,109,100,105,97,0,0,0,32,109,100,104,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,172,68,0,0,8,0,85,196,0,0,0,0,0,45,104,100,108,114,0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0,0,0,1,15,109,105,110,102,0,0,0,16,115,109,104,100,0,0,0,0,0,0,0,0,0,0,0,36,100,105,110,102,0,0,0,28,100,114,101,102,0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1,0,0,0,211,115,116,98,108,0,0,0,103,115,116,115,100,0,0,0,0,0,0,0,1,0,0,0,87,109,112,52,97,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,2,0,16,0,0,0,0,172,68,0,0,0,0,0,51,101,115,100,115,0,0,0,0,3,128,128,128,34,0,2,0,4,128,128,128,20,64,21,0,0,0,0,1,244,0,0,1,243,249,5,128,128,128,2,18,16,6,128,128,128,1,2,0,0,0,24,115,116,116,115,0,0,0,0,0,0,0,1,0,0,0,2,0,0,4,0,0,0,0,28,115,116,115,99,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,2,0,0,0,1,0,0,0,28,115,116,115,122,0,0,0,0,0,0,0,0,0,0,0,2,0,0,1,115,0,0,1,116,0,0,0,20,115,116,99,111,0,0,0,0,0,0,0,1,0,0,0,44,0,0,0,98,117,100,116,97,0,0,0,90,109,101,116,97,0,0,0,0,0,0,0,33,104,100,108,114,0,0,0,0,0,0,0,0,109,100,105,114,97,112,112,108,0,0,0,0,0,0,0,0,0,0,0,0,45,105,108,115,116,0,0,0,37,169,116,111,111,0,0,0,29,100,97,116,97,0,0,0,1,0,0,0,0,76,97,118,102,53,54,46,52,48,46,49,48,49])],{type:"video/mp4"});function setupDefaultValues(e){return Object.assign({inline:!1,muted:!1,timeout:250},e)}function startPlayback(e,t){var n=e.muted,r=e.timeout,i=e.inline,o=t(),a=o.element,s=o.source;return a.muted=n,n&&a.setAttribute("muted","muted"),i&&a.setAttribute("playsinline","playsinline"),a.src=s,new Promise(function(e){var t=a.play(),n=setTimeout(function(){i(!1,new Error("Timeout "+r+" ms has been reached"))},r),i=function(t,r){clearTimeout(n),e({result:t,error:r})};void 0!==t?t.then(function(){return i(!0)}).catch(function(e){return i(!1,e)}):i(!0)})}function video(e){return startPlayback(setupDefaultValues(e),function(){return{element:document.createElement("video"),source:URL.createObjectURL(VIDEO)}})}function audio(e){return startPlayback(setupDefaultValues(e),function(){return{element:document.createElement("audio"),source:URL.createObjectURL(AUDIO)}})}var canAutoplay={audio:audio,video:video},PlayerState;!function(e){e[e.INITIALIZING=0]="INITIALIZING",e[e.PLAYING=1]="PLAYING",e[e.PAUSED=2]="PAUSED",e[e.PAUSED_INTERNAL=3]="PAUSED_INTERNAL",e[e.DESTROYED=4]="DESTROYED"}(PlayerState||(PlayerState={}));var IMA3IFramePlayer=function(){function e(e,t){this.win=e,this.height=320,this.width=180,this.vpaid_initad_timeout=1e4,this.muted=!1,this.reqMuted=!1,this.isInViewport=!0,this.viewportCheck=!1,this.isInFocus=!0,this.focusCheck=!1,this.vpaidControls=!1,t.height>0&&(this.height=t.height),t.width>0&&(this.width=t.width),t.vpaid_initad_timeout>0&&(this.vpaid_initad_timeout=t.vpaid_initad_timeout),t.muted&&(this.reqMuted=t.muted),this.viewportCheck=t.viewportCheck,this.focusCheck=t.focusCheck,this.divId=t.divID,this.divEl=this.win.document.getElementById(this.divId),this.videoEl=t.videoEl?t.videoEl:e.document.getElementById(t.videoID),this.origCfg={muted:this.videoEl.muted,volume:this.videoEl.volume},this.vpaidControls=t.vpaidControls,this.resumeContent=t.resumeContent,this.onEvent=t.onEvent,this.ads=t.ads;var n=this;["destroy","init","playAd","onAdError","onAdsManagerLoaded"].forEach(function(e){n[e]&&(n[e]=n[e].bind(n))})}return e.prototype.reset=function(){this.videoEl.volume=this.origCfg.volume,this.videoEl.muted=this.origCfg.muted,this.adsManager&&(this.adsManager.destroy(),this.adsManager=null),this.unbindChecks&&this.unbindChecks(),this.iframePlayerControls&&(this.iframePlayerControls.destroy(),delete this.iframePlayerControls)},e.prototype.destroy=function(){clearTimeout(this.loadAdsManagerTimeout),this.state=PlayerState.DESTROYED,this.reset(),this.resumeContent&&this.resumeContent(!0)},e.prototype.init=function(e){var t=this;Debug.log("[IMA] waiting for ima3 to load",this.ads.adUnitOptions),this.state=PlayerState.INITIALIZING;var n=0,r=setInterval$1(function(){if(n+=1,t.win.google){r(),Debug.log("[IMA] initializing ima3 player",t.ads.adUnitOptions);var i=t.win.google.ima;i.settings.setVpaidMode(i.ImaSdkSettings.VpaidMode.INSECURE),t.adDisplayContainer=new i.AdDisplayContainer(t.divEl,t.videoEl),t.adDisplayContainer.initialize(),t.adsLoader=new i.AdsLoader(t.adDisplayContainer),t.adsLoader.addEventListener(i.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,t.onAdsManagerLoaded,!1),t.adsLoader.addEventListener(i.AdErrorEvent.Type.AD_ERROR,function(e){Debug.log("[IMA] fired event "+IMA3EVENTS.errors.AD_ERROR+": "+e.getError(),t.ads.adUnitOptions),t.onEvent(IMA3EVENTS.errors.AD_ERROR,e.getError()),t.destroy()},!1),e()}else n>25&&(Debug.log("[IMA] failed to load ima3 sdk",t.ads.adUnitOptions),r(),e(new Error("failed to load ima3 sdk")))},200);this.loadAdsManagerTimeout=setTimeout(function(){Debug.log("[IMA] initializing ima3 player timed out",t.ads.adUnitOptions),t.destroy()},this.vpaid_initad_timeout)},e.prototype.playAd=function(e){var t=this;if(e&&e.type!==IMA3AdType.UNKNOWN){this.ima3Ad=e;var n=new this.win.google.ima.AdsRequest;switch(e.type){case IMA3AdType.VMAP:Debug.log("[IMA] playing VMAP XML",this.ads.adUnitOptions),n.adsResponse=e.data;break;case IMA3AdType.VAST_XML:Debug.log("[IMA] playing VAST XML",this.ads.adUnitOptions),n.adsResponse=e.data;break;case IMA3AdType.VAST_URL:Debug.log("[IMA] playing VAST URL",this.ads.adUnitOptions),n.adTagUrl=e.data}n.linearAdSlotWidth=this.width,n.linearAdSlotHeight=this.height,n.nonLinearAdSlotWidth=this.width,n.nonLinearAdSlotHeight=150,n.setAdWillAutoPlay(!0),(this.reqMuted?Promise.resolve({result:!1}):canAutoplay.video({inline:!0,muted:!1,timeout:100})).then(function(e){var r=e.error;t.muted=!e.result,r&&(t.muted=!0),Debug.log("[IMA] ad will start muted: "+t.muted,t.ads.adUnitOptions),n.setAdWillPlayMuted(t.muted),t.adsLoader.requestAds(n)}),this.reset()}else this.resumeContent&&this.resumeContent(!0)},e.prototype.onAdsManagerLoaded=function(e){var t=this;clearTimeout(this.loadAdsManagerTimeout);var n=this.win.google.ima,r=new n.AdsRenderingSettings;r.loadVideoTimeout=this.vpaid_initad_timeout,this.adsManager=e.getAdsManager(this.videoEl,r),Object.keys(IMA3EVENTS.events).forEach(function(e){n.AdEvent.Type[e]&&t.adsManager.addEventListener(n.AdEvent.Type[e],function(n){Debug.log("[IMA] fired event "+IMA3EVENTS.events[e]),t.onEvent(IMA3EVENTS.events[e],n)})}),Object.keys(IMA3EVENTS.errors).forEach(function(e){n.AdErrorEvent.Type[e]&&t.adsManager.addEventListener(n.AdErrorEvent.Type[e],function(n){Debug.log("[IMA] fired event "+IMA3EVENTS.errors[e]),t.onEvent(IMA3EVENTS.errors[e],n)})}),this.adsManager.addEventListener(n.AdErrorEvent.Type.AD_ERROR,function(){Debug.log("[IMA] adsmanager threw an error",t.ads.adUnitOptions),t.destroy()}),this.adsManager.addEventListener(n.AdEvent.Type.ALL_ADS_COMPLETED,this.destroy),this.adsManager.addEventListener(n.AdEvent.Type.STARTED,function(){t.state=PlayerState.PLAYING}),this.adsManager.addEventListener(n.AdEvent.Type.PAUSED,function(){t.state!==PlayerState.PAUSED_INTERNAL&&(t.state=PlayerState.PAUSED)}),this.adsManager.addEventListener(n.AdEvent.Type.RESUMED,function(){t.state=PlayerState.PLAYING}),this.adsManager.addEventListener(n.AdEvent.Type.CONTENT_PAUSE_REQUESTED,function(){t.divEl.style.display="inline-block",t.isInViewport=!0,t.isInFocus=!0,trackEvent(t.ima3Ad,"breakStart",function(e){return proxyTracker(t.ads,e)})}),this.adsManager.addEventListener(n.AdEvent.Type.CONTENT_RESUME_REQUESTED,function(){t.divEl.style.display="none",trackEvent(t.ima3Ad,"breakEnd",function(e){return proxyTracker(t.ads,e)}),t.resumeContent&&t.resumeContent(!1),t.ads.adUnitOptions.auto_ad||t.adsLoader.contentComplete()}),this.adsManager.addEventListener(n.AdEvent.Type.CLICK,function(){t.adsManager.pause()});try{this.adsManager.init(this.width,this.height,n.ViewMode.NORMAL),this.muted&&(this.videoEl.volume=0,this.adsManager.setVolume(0)),this.adsManager.start();var i=[];this.unbindChecks=function(){return i.forEach(function(e){return e()})},i.push(setInterval$1(function(){t.adsManager&&(t.isInViewport&&t.isInFocus?t.state===PlayerState.PAUSED_INTERNAL&&t.adsManager.resume():t.state===PlayerState.PLAYING&&(t.adsManager.pause(),t.state=PlayerState.PAUSED_INTERNAL))},200)),this.viewportCheck&&i.push(setInterval$1(function(){t.isInViewport=!!t.divEl&&isElementVisible(t.divEl)},200)),this.focusCheck&&(i.push(onPageBlur(function(){document.activeElement&&document.activeElement.tagName&&"iframe"===document.activeElement.tagName.toLowerCase()?window.focus():t.isInFocus=!1})),i.push(onPageFocus(function(){t.isInFocus=!document.hidden}))),this.vpaidControls&&(this.iframePlayerControls=new IMA3IFramePlayerControls({adsManager:this.adsManager,containerEl:this.divEl,imasdk:n,onEvent:this.onEvent}),this.iframePlayerControls.init())}catch(e){this.resumeContent&&this.resumeContent(!0)}},e}(),Viewability=function(){function e(e){this.cb=e,this.time=0,this.idx=0}return e.prototype.reset=function(){this.stop(),this.time=0},e.prototype.start=function(){var e=this;this.time>=0&&(this.stop(),this.time=Date.now(),this.idx=window.setInterval(function(){e.time>0&&Date.now()-e.time>=2e3&&(e.stop(),e.time=-1,e.cb())},250))},e.prototype.stop=function(){window.clearInterval(this.idx),this.time>=0&&(this.time=0)},e}();function transformScript(e,t){return"<script type='text/javascript' src='"+(url.isSameDomain(t,e.options.domains)?t:proxyVPaid(e,t))+"' orig-src='"+strings.reverse(t)+"'><\/script>"}function generateVPAIDHTML(e,t,n){var r,i=e.appMeta.pxyClass,o=JSON.stringify({adunits:(r={},r[e.adUnitOptions.adunit_uuid]={proxyLocation:window.location.href,request_id:e.adUnitMeta.request_id},r)}),a=proxySiteAsset(e.options,"proxy-js");return"<!DOCTYPE html>\n<html lang='en'>\n<head data-cYap='"+btoa(o)+"'><meta charset='UTF-8'></head>\n<body style='margin:0;padding:0'>\n"+n+"\n<script type='text/javascript' class='"+i+"' src='"+a+"' orig-src='"+strings.reverse(a)+"'><\/script>\n"+t.map(function(t){return transformScript(e,url.resolveURL(t,e.win.location.href))})+"\n</body>\n</html>"}function loadIFrame(e,t,n){once$1(e,"load",n),e.contentDocument&&(e.contentDocument.open(),e.contentDocument.write(t),e.contentDocument.close())}var REGEX_TRACKED_EVENTS=new RegExp([IMA3EVENTS.events.IMPRESSION,IMA3EVENTS.events.START,IMA3EVENTS.events.SKIP,IMA3EVENTS.events.CLICK,IMA3EVENTS.events.QUARTILE1,IMA3EVENTS.events.QUARTILE2,IMA3EVENTS.events.QUARTILE3,IMA3EVENTS.events.COMPLETE,IMA3EVENTS.events.VOLUME_MUTED,IMA3EVENTS.events.PAUSE,IMA3EVENTS.events.RESUME].join("|"),"i"),PlayerState$1,PlayerState$$1;PlayerState$$1=PlayerState$1||(PlayerState$1={}),PlayerState$$1[PlayerState$$1.INITIALIZING=0]="INITIALIZING",PlayerState$$1[PlayerState$$1.PLAYING=1]="PLAYING",PlayerState$$1[PlayerState$$1.RESUMING=2]="RESUMING",PlayerState$$1[PlayerState$$1.DESTROYED=3]="DESTROYED";var IMA3PlayerAutoType="ima3auto",IMA3PlayerAuto=function(e){function t(t,n,r){var i=e.call(this,t,n.adunit_uuid)||this;i.site_player=r,i.state=PlayerState$1.INITIALIZING,i.filled=!1;var o=i;return["load","loadScripts","messageHandler","onEvent"].forEach(function(e){"function"==typeof o[e]&&(o[e]=o[e].bind(o))}),i.type=IMA3PlayerAutoType,i.resumeContent=execOnce(i.resumeContent.bind(i)),i.viewability=new Viewability(function(){CMDEvents.exec(EVENT_VIEWABLE,i.adUnitOptions)}),i}return __extends(t,e),t.prototype.load=function(){var e=this;facebookTokenPromise(this).then(function(){CMDEvents.exec(EVENT_REQUEST,e.adUnitOptions),loadAdsource(e,!1,function(t,n){if(t)return Debug.warn("[IMA3] failed to load adsource",e.adUnitOptions),void e.resumeContent(!0);var r=parseUserID(n,"");r&&Cookies.set(COOKIE_KEY.USER_ID,r,{expires:Cookies.EXPIRE_USER_ID}),e.adsResponse=parseIMA3AdString(n.responseText),e.adUnitMeta.request_id=parseRequestID(n,e.adUnitOptions),e.adsResponse.type===IMA3AdType.VMAP&&(e.adUnitMeta.adsource_id=parseAdsourceID(n,e.adUnitOptions),e.adUnitMeta.track_ad_event_clientside=!0),e.loadScripts()})})},t.prototype.loadScripts=function(){var e=this;loadProxy(window,this).then(function(){if(e.isOutstream())var t=e.site_player.getDOMElement(),n=setInterval(function(){isElementVisible(t,.1)&&(clearInterval(n),e.forcePause())},250);else e.forcePause()}).catch(function(){Debug.warn("[IMA3] failed to load proxy-js",e.adUnitOptions),e.resumeContent(!0)})},t.prototype.forcePause=function(){var e=this,t=this.isDebug();Debug.log("[ADS] loading the ima3 "+(t?"debug":"")+" sdk",this.adUnitOptions);var n="//imasdk.googleapis.com/js/sdkloader/ima3"+(t?"_debug":"")+".js";Debug.log("[ADS] trying to force pause the site player: "+this.adUnitOptions.site_player.type,this.adUnitOptions),this.site_player.forcePause({adsplayer:this}).then(function(){var t=e.site_player.height(),r=e.site_player.width(),i=e.site_player.getDOMElement(),o=document.createElement("div");o.id=e.adUnitMeta.divID,o.style.cssText=cssText({display:"none",height:t+"px",position:"relative",transition:"opacity 0.4s ease-in-out, max-height 0.7s ease-in-out",width:r+"px","z-index":"10000"}),e.adUnitOptions.position===Position.OUTSTREAM&&(o.style.maxHeight="0",o.style.opacity="0"),i.parentElement&&i.parentElement.insertBefore(o,i);var a=cssText({border:"0 none",bottom:"0",height:"100%",left:"0",margin:"0px",padding:"0px",position:"absolute",right:"0",top:"0",width:"100%"}),s=document.createElement("iframe");s.setAttribute("scrolling","no"),s.setAttribute("allow","autoplay"),e.fr=s,s.style.cssText=a,o.appendChild(s),e.site_player.hide({adsplayer:e});var u=!0,c=e.site_player.getVideoEl();c&&c.parentElement&&(u=!1);var l="<div style='"+a+"'>";u&&(l+="<video id='"+e.adUnitMeta.videoID+"' style='"+a+"'></video>"),loadIFrame(s,generateVPAIDHTML(e,[n],l+="<div id='"+e.adUnitMeta.divID+"' style='"+a+"'></div></div>"),function(){CMDEvents.exec(EVENT_IMA3_LOADED,e.adUnitOptions),Debug.log("[ADS] swapping the "+(e.isOutstream()?"outstream":"instream")+" player",e.adUnitOptions),o.style.display="inline-block",e.isOutstream()&&setTimeout(function(){o.style.maxHeight=o.style.height,o.style.opacity="1"},100),e.site_player.swap({adsplayer:e}),e.iframePlayer=new IMA3IFramePlayer(s.contentWindow,{ads:e,divID:e.adUnitMeta.divID,focusCheck:e.adUnitOptions.focus_check,height:t,muted:e.adUnitOptions.ad_player.muted,resumeContent:e.resumeContent,onEvent:e.onEvent,videoEl:c,videoID:e.adUnitMeta.videoID,viewportCheck:e.adUnitOptions.viewport_check,vpaidControls:e.adUnitOptions.ad_player.vpaid_controls,vpaid_initad_timeout:e.adUnitOptions.ad_player.vpaid_initad_timeout,width:r}),e.iframePlayer.init(function(t){if(t)return Debug.log(t.message,e.adUnitOptions),Logger.LogError({code:"ERROR",message:String(t.message)}),void e.resumeContent(!0);e.state=PlayerState$1.PLAYING,e.playAd()})})},function(t){Debug.log("site_player: player pause exception",e.adUnitOptions),Logger.LogError({code:"PLAYER_PAUSE_EXCEPTION",message:String(t)}),e.resumeContent(!0)})},t.prototype.onEvent=function(e,t){switch(this.adUnitMeta.track_ad_event_clientside&&REGEX_TRACKED_EVENTS.test(e)&&Logger.LogAdEvent({type:e},this.adUnitOptions),e){case IMA3EVENTS.events.CLICK:CMDEvents.exec(EVENT_CLICK,this.adUnitOptions,t);break;case IMA3EVENTS.events.COMPLETE:CMDEvents.exec(EVENT_COMPLETE,this.adUnitOptions,t);case IMA3EVENTS.events.CONTENT_PAUSE_REQUESTED:this.filled=!1,this.viewability.reset();break;case IMA3EVENTS.events.RESUMED:CMDEvents.exec(EVENT_RESUMED,this.adUnitOptions,t),this.viewability.start();break;case IMA3EVENTS.events.PAUSED:CMDEvents.exec(EVENT_PAUSED,this.adUnitOptions,t),this.viewability.stop();break;case IMA3EVENTS.events.IMPRESSION:this.filled=!0,CMDEvents.exec(EVENT_FILLED,this.adUnitOptions,t),CMDEvents.exec(EVENT_IMPRESSION,this.adUnitOptions,t),this.viewability.start();break;case IMA3EVENTS.errors.AD_ERROR:this.filled||CMDEvents.exec(EVENT_UNFILLED,this.adUnitOptions,t),CMDEvents.exec(EVENT_ERROR,this.adUnitOptions,t);break;case IMA3EVENTS.events.STARTED:CMDEvents.exec(EVENT_START,this.adUnitOptions,t);break;case IMA3EVENTS.events.SKIPPED:CMDEvents.exec(EVENT_SKIP,this.adUnitOptions,t);break;case IMA3EVENTS.events.FIRST_QUARTILE:CMDEvents.exec(EVENT_QUARTILE1,this.adUnitOptions,t);break;case IMA3EVENTS.events.MIDPOINT:CMDEvents.exec(EVENT_QUARTILE2,this.adUnitOptions,t);break;case IMA3EVENTS.events.THIRD_QUARTILE:CMDEvents.exec(EVENT_QUARTILE3,this.adUnitOptions,t);break;case IMA3EVENTS.events.DURATION_CHANGE:CMDEvents.exec(EVENT_DURATION_CHANGE,this.adUnitOptions,t);break;case IMA3EVENTS.events.FULLSCREEN:CMDEvents.exec(EVENT_FULLSCREEN,this.adUnitOptions,t);break;case IMA3EVENTS.events.EXIT_FULLSCREEN:CMDEvents.exec(EVENT_EXIT_FULLSCREEN,this.adUnitOptions,t)}},t.prototype.playAd=function(){var e=this;if(!this.iframePlayer)return this.resumeContent(!0);Debug.log("[ADS] playing the ad",this.adUnitOptions),this.site_player.swap({adsplayer:this});var t=function(){e.iframePlayer.playAd(e.adsResponse),e.state=PlayerState$1.PLAYING};try{this.adUnitOptions.play_ad_func(this.options,this.adUnitOptions,this.getCustomParams(),t)}catch(e){t()}},t.prototype.isOutstream=function(){return this.adUnitOptions.position===Position.OUTSTREAM},t.prototype.destroy=function(e){Debug.log("[ADS] destroy called on the ima ads player",this.adUnitOptions),this.state===PlayerState$1.RESUMING||this.state===PlayerState$1.DESTROYED?e&&e():this.resumeContent(!1,e)},t.prototype.resumeContent=function(e,t){var n=this;if(this.state=PlayerState$1.RESUMING,e&&this.isOutstream()&&!this.adUnitMeta.no_backfill_script){this.adUnitMeta.no_backfill_script=!0;var r=getPAPI();r&&r("backfill_script",[{adunit_uuid:this.adUnitOptions.adunit_uuid}])}var i=document.getElementById(this.adUnitMeta.divID),o=function(){setTimeout(function(){CMDEvents.exec(EVENT_END,n.adUnitOptions),n.iframePlayer&&(n.iframePlayer.destroy(),n.iframePlayer=null),i&&i.parentElement&&i.parentElement.removeChild(i),n.site_player.show({adsplayer:n}),n.site_player.play({adsplayer:n}),t&&t(),n.state=PlayerState$1.DESTROYED},500)};i&&this.isOutstream()?(once$1(i,"transitionend",o),i.style.maxHeight="0",i.style.opacity="0"):o()},t}(AdsCache),PlayerState$2;!function(e){e[e.INITIALIZING=0]="INITIALIZING",e[e.INITIALIZED=1]="INITIALIZED",e[e.PLAYING=2]="PLAYING",e[e.WAITING=3]="WAITING",e[e.RESUMING=4]="RESUMING",e[e.DESTROYING=5]="DESTROYING",e[e.DESTROYED=6]="DESTROYED"}(PlayerState$2||(PlayerState$2={}));var IMA3PlayerManualType="ima3manual",IMA3PlayerManual=function(e){function t(t,n,r){var i=e.call(this,t,n.adunit_uuid)||this;i.site_player=r,i.state=PlayerState$2.INITIALIZING,i.filled=!1,i.backfill=!0,i.resumeSiteCallbacks=[];var o=i;return["load","loadScripts","messageHandler","resumeSiteVideo","onEvent"].forEach(function(e){"function"==typeof o[e]&&(o[e]=o[e].bind(o))}),i.type=IMA3PlayerManualType,i.resumeContent=execOnce(i.resumeContent.bind(i)),i.viewability=new Viewability(function(){CMDEvents.exec(EVENT_VIEWABLE,i.adUnitOptions)}),i}return __extends(t,e),t.prototype.load=function(){var e=this;loadProxy(window,this).then(function(){e.loadIFrame()}).catch(function(){Debug.warn("[IMA3] failed to load proxy-js",e.adUnitOptions),e.resumeContent(!0)})},t.prototype.loadIFrame=function(e){var t=this,n=this.isDebug();Debug.log("[ADS] loading the ima3 "+(n?"debug":"")+" sdk",this.adUnitOptions);var r="//imasdk.googleapis.com/js/sdkloader/ima3"+(n?"_debug":"")+".js",i=this.site_player.height(),o=this.site_player.width(),a=this.site_player.getDOMElement(),s=document.createElement("div");s.id=this.adUnitMeta.divID,s.style.cssText=cssText({display:"none",height:i+"px",position:"relative",transition:"opacity 0.4s ease-in-out, max-height 0.7s ease-in-out",width:o+"px","z-index":"10000"}),this.adUnitOptions.position===Position.OUTSTREAM&&(s.style.maxHeight="0",s.style.opacity="0"),a.parentElement&&a.parentElement.insertBefore(s,a);var u=cssText({border:"0 none",bottom:"0",height:"100%",left:"0",margin:"0px",padding:"0px",position:"absolute",right:"0",top:"0",width:"100%"}),c=document.createElement("iframe");c.setAttribute("scrolling","no"),c.setAttribute("allow","autoplay"),this.fr=c,c.style.cssText=u,s.appendChild(c);var l=!0,d=this.site_player.getVideoEl();d&&d.parentElement&&(l=!1);var f="<div style='"+u+"'>";l&&(f+="<video id='"+this.adUnitMeta.videoID+"' style='"+u+"'></video>"),loadIFrame(c,generateVPAIDHTML(this,[r],f+="<div id='"+this.adUnitMeta.divID+"' style='"+u+"'></div></div>"),function(){t.adUnitOptions.auto_ad&&(Debug.log("[ADS] swapping the "+(t.isOutstream()?"outstream":"instream")+" player",t.adUnitOptions),s.style.display="inline-block",t.isOutstream()&&setTimeout(function(){s.style.maxHeight=s.style.height,s.style.opacity="1"},100)),t.iframePlayer=new IMA3IFramePlayer(c.contentWindow,{ads:t,divID:t.adUnitMeta.divID,focusCheck:t.adUnitOptions.focus_check,height:i,muted:t.adUnitOptions.ad_player.muted,onEvent:t.onEvent,resumeContent:t.resumeContent,videoEl:d,videoID:t.adUnitMeta.videoID,viewportCheck:t.adUnitOptions.viewport_check,vpaidControls:t.adUnitOptions.ad_player.vpaid_controls,vpaid_initad_timeout:t.adUnitOptions.ad_player.vpaid_initad_timeout,width:o}),t.iframePlayer.init(function(n){if(n)return Debug.log("[ADS] ads player failed to intialized: "+n.message,t.adUnitOptions),Logger.LogError({code:"ERROR",message:String(n.message)}),void t.resumeContent(!0);t.state=PlayerState$2.INITIALIZED,Debug.log("[ADS] ads player intialized",t.adUnitOptions),e&&e()})})},t.prototype.forcePause=function(e){var t=this;Debug.log("[ADS] trying to force pause the site player: "+this.adUnitOptions.site_player.type,this.adUnitOptions),this.site_player.forcePause({adsplayer:this}).then(function(){t.site_player.hide({adsplayer:t}),e()},function(e){Debug.log("site_player: player pause exception",t.adUnitOptions),Logger.LogError({code:"PLAYER_PAUSE_EXCEPTION",message:String(e)}),t.resumeContent(!0)})},t.prototype.onEvent=function(e,t){switch(this.adUnitMeta.track_ad_event_clientside&&REGEX_TRACKED_EVENTS.test(e)&&Logger.LogAdEvent({type:e},this.adUnitOptions),e){case IMA3EVENTS.events.CLICK:CMDEvents.exec(EVENT_CLICK,this.adUnitOptions,t);break;case IMA3EVENTS.events.COMPLETE:CMDEvents.exec(EVENT_COMPLETE,this.adUnitOptions,t);case IMA3EVENTS.events.CONTENT_PAUSE_REQUESTED:this.filled=!1,this.viewability.reset();break;case IMA3EVENTS.events.RESUMED:CMDEvents.exec(EVENT_RESUMED,this.adUnitOptions,t),this.viewability.start();break;case IMA3EVENTS.events.PAUSED:CMDEvents.exec(EVENT_PAUSED,this.adUnitOptions,t),this.viewability.stop();break;case IMA3EVENTS.events.IMPRESSION:this.filled=!0,this.backfill=!1,CMDEvents.exec(EVENT_FILLED,this.adUnitOptions,t),CMDEvents.exec(EVENT_IMPRESSION,this.adUnitOptions,t),this.viewability.start();break;case IMA3EVENTS.errors.AD_ERROR:this.filled||CMDEvents.exec(EVENT_UNFILLED,this.adUnitOptions,t),CMDEvents.exec(EVENT_ERROR,this.adUnitOptions,t);break;case IMA3EVENTS.events.STARTED:CMDEvents.exec(EVENT_START,this.adUnitOptions,t);break;case IMA3EVENTS.events.SKIPPED:CMDEvents.exec(EVENT_SKIP,this.adUnitOptions,t);break;case IMA3EVENTS.events.FIRST_QUARTILE:CMDEvents.exec(EVENT_QUARTILE1,this.adUnitOptions,t);break;case IMA3EVENTS.events.MIDPOINT:CMDEvents.exec(EVENT_QUARTILE2,this.adUnitOptions,t);break;case IMA3EVENTS.events.THIRD_QUARTILE:CMDEvents.exec(EVENT_QUARTILE3,this.adUnitOptions,t);break;case IMA3EVENTS.events.DURATION_CHANGE:CMDEvents.exec(EVENT_DURATION_CHANGE,this.adUnitOptions,t);break;case IMA3EVENTS.events.FULLSCREEN:CMDEvents.exec(EVENT_FULLSCREEN,this.adUnitOptions,t);break;case IMA3EVENTS.events.EXIT_FULLSCREEN:CMDEvents.exec(EVENT_EXIT_FULLSCREEN,this.adUnitOptions,t)}},t.prototype.isStartable=function(){return this.state===PlayerState$2.INITIALIZED||this.state===PlayerState$2.WAITING},t.prototype.loadAd=function(e){var t=this;facebookTokenPromise(this).then(function(){CMDEvents.exec(EVENT_REQUEST,t.adUnitOptions),loadAdsource(t,!1,function(n,r){if(n)return Debug.warn("[IMA3] failed to load adsource",t.adUnitOptions),void t.resumeContent(!0);var i=parseUserID(r,"");i&&Cookies.set(COOKIE_KEY.USER_ID,i,{expires:Cookies.EXPIRE_USER_ID}),t.adsResponse=r.responseXML,t.adUnitMeta.request_id=parseRequestID(r,t.adUnitOptions),-1!==r.responseText.indexOf("<vmap:VMAP xmlns:vmap=")&&(t.adUnitMeta.adsource_id=parseAdsourceID(r,t.adUnitOptions),t.adUnitMeta.track_ad_event_clientside=!0),e()})})},t.prototype.startAd=function(e){var t=this,n=function(){t.forcePause(function(){if(t.isStartable())document.querySelector("#"+t.adUnitMeta.divID).style.display="inline-block",Debug.log("[ADS] player initalized, starting ad",t.adUnitOptions),t.playAd(e);else{Debug.log("[ADS] player not initalized, waiting to start ad",t.adUnitOptions);var n=setInterval(function(){t.isStartable()&&(clearInterval(n),t.playAd(e))},200)}})};"preroll"===e?this.loadAd(n):n()},t.prototype.playAd=function(e){var t=this;if(!this.iframePlayer)return this.resumeContent(!0);Debug.log("[ADS] playing the ad "+(e?"breakId: "+e:""),this.adUnitOptions),this.site_player.swap({adsplayer:this});var n=function(){t.iframePlayer.playAd(parseIMA3AdXML(t.adsResponse,e)),t.state=PlayerState$2.PLAYING};try{this.adUnitOptions.play_ad_func(this.options,this.adUnitOptions,this.getCustomParams(),n)}catch(e){n()}},t.prototype.isOutstream=function(){return this.adUnitOptions.position===Position.OUTSTREAM},t.prototype.getAdunitDiv=function(){return document.getElementById(this.adUnitMeta.divID)},t.prototype.destroy=function(e){Debug.log("[ADS] destroy called on the ima ads player",this.adUnitOptions),this.state===PlayerState$2.RESUMING||this.state===PlayerState$2.DESTROYED?e&&e():this.cleanup(e)},t.prototype.resumeSitePlayer=function(e){var t=this;this.resumeSiteCallbacks.push(e);var n=function(){setTimeout(function(){for(var e=0,n=t.resumeSiteCallbacks;e<n.length;e++){var r=n[e];r&&r()}t.resumeSiteCallbacks=[]},500)},r=this.getAdunitDiv();r&&this.isOutstream()?(once$1(r,"transitionend",n),r.style.maxHeight="0",r.style.opacity="0"):n()},t.prototype.resumeContent=function(e,t){this.resumeSiteVideo(t)},t.prototype.cleanup=function(e){var t=this;if(this.state!==PlayerState$2.DESTROYING&&this.state!==PlayerState$2.DESTROYED){if(this.backfill&&this.isOutstream()&&!this.adUnitMeta.no_backfill_script){this.adUnitMeta.no_backfill_script=!0;var n=getPAPI();n&&n("backfill_script",[{adunit_uuid:this.adUnitOptions.adunit_uuid}])}var r=function(){t.state=PlayerState$2.DESTROYED,CMDEvents.exec(EVENT_END,t.adUnitOptions),t.iframePlayer&&(t.iframePlayer.destroy(),t.iframePlayer=null);var n=t.getAdunitDiv();n&&n.parentElement&&n.parentElement.removeChild(n),e&&e()};this.state===PlayerState$2.WAITING?r():this.state===PlayerState$2.RESUMING?this.resumeSitePlayer(r):this.resumeSiteVideo(r)}},t.prototype.resumeSiteVideo=function(e){var t=this;this.state=PlayerState$2.RESUMING,this.resumeSitePlayer(function(){t.state=PlayerState$2.WAITING,CMDEvents.exec(EVENT_RESUME,t.adUnitOptions),t.site_player.show({adsplayer:t}),t.site_player.play({adsplayer:t}),e&&e()})},t}(AdsCache),AdsScript=function(e){function t(t,n,r){void 0===r&&(r=!1);var i=e.call(this,t,n.adunit_uuid)||this;return i.backfillScript=r,i.type="script",i}return __extends(t,e),t.prototype.load=function(){var e=this,t=getWritableWin(this.win);Promise.all([this.fetchScript(),loadProxy(t,this)]).then(function(){return new Promise(function(n,r){var i=document.createElement("div");t.proxy(i,"innerHTML",e.adUnitOptions.adunit_id).innerHTML=e.adScript,scripts.loadTags(e.win,i,n,r)})}).then(function(){setTimeout(function(){CMDEvents.exec(TAG_READY,e.adUnitOptions)},10)},function(){setTimeout(function(){CMDEvents.exec(TAG_ERROR,e.adUnitOptions),Debug.log("[ADS] failed to execute the outstream script.",e.adUnitOptions)},10)})},t.prototype.fetchScript=function(){var e=this;return loadAdsourcePromise(this,this.backfillScript).then(function(t){return e.adUnitMeta.request_id=parseRequestID(t,e.adUnitOptions),e.backfillScript&&"string"==typeof e.adUnitOptions.$backfillscript?(e.adScript=e.adUnitOptions.$backfillscript,Promise.resolve()):"string"==typeof e.adUnitOptions.$adscript?(e.adScript=e.adUnitOptions.$adscript,Promise.resolve()):(e.adScript=t.responseText,Promise.resolve())},function(){return Debug.log("[ADS] error retrieving the outstream script.",e.adUnitOptions),Logger.LogError({code:"HTTP_CALL",message:"error retrieving the outstream script"},e.adUnitOptions),Promise.reject(void 0)})},t}(AdsCache);function findEl(e){var t=document.querySelector(e);if(!t)throw new Error("was not able to find the element using neither provided CSS Selector "+e);return t}function wrapFunc(e){return"(function() { "+(e||"")+" })();"}var SitePlayer=function(){function SitePlayer(e,t){this.adUnitOptions=e,this.adUnitMeta=t,this.findElementInterval=this.findElementInterval.bind(this)}return SitePlayer.prototype.play=function(e){var t=this;exec(wrapFunc(this.adUnitOptions.site_player.play),this.execParams(e),function(e){Debug.warn(e.name+": "+e.message,t.adUnitOptions)})},SitePlayer.prototype.forcePause=function(e){var t=this;return this.adUnitOptions.site_player.pause?this.ready().then(function(){return new Promise(function(n,r){exec(wrapFunc(t.adUnitOptions.site_player.pause),t.execParams({resolve:n},e),function(e){Debug.warn(e.name+": "+e.message,t.adUnitOptions),r(e)})})}):this.ready()},SitePlayer.prototype.hide=function(e){var t=this;exec(wrapFunc(this.adUnitOptions.site_player.hide),this.execParams(e),function(e){Debug.warn(e.name+": "+e.message,t.adUnitOptions)})},SitePlayer.prototype.show=function(e){var t=this;exec(wrapFunc(this.adUnitOptions.site_player.show),this.execParams(e),function(e){Debug.warn(e.name+": "+e.message,t.adUnitOptions)})},SitePlayer.prototype.swap=function(e){var t=this;exec(wrapFunc(this.adUnitOptions.site_player.swap),this.execParams(e),function(e){Debug.warn(e.name+": "+e.message,t.adUnitOptions)})},SitePlayer.prototype.ready=function(){return new Promise(function(e){window.setTimeout(function(){e()},250)})},SitePlayer.prototype.getDOMElement=function(){return findEl(this.adUnitOptions.selector)},SitePlayer.prototype.getVideoEl=function(){return this.adUnitOptions.selector_video?findEl(this.adUnitOptions.selector_video):this.getDOMElement().querySelector("video")},SitePlayer.prototype.getAdContainer=function(){return this.adUnitOptions.selector_adcontainer?findEl(this.adUnitOptions.selector_adcontainer):this.getDOMElement()},SitePlayer.prototype.dim=function(statement,defval,cb){statement=(""+statement).trim();try{var value=+exec(statement,this.execParams());if(!isNaN(value))return value}catch(e){cb(e)}try{var value=+eval(statement);if(!isNaN(value))return value}catch(e){cb(e)}return defval},SitePlayer.prototype.width=function(){var e=this.getDOMElement(),t=this.dim(this.adUnitOptions.site_player.width,e.offsetWidth||getDimensions(e).width,function(e){Debug.warn(e.name+": "+e.message)});return t>window.innerWidth?window.innerWidth:t},SitePlayer.prototype.height=function(){var e=this.dim(this.adUnitOptions.site_player.height,.5625*this.width(),function(e){Debug.warn(e.name+": "+e.message)});return e>window.innerHeight?window.innerHeight:e},SitePlayer.prototype.findElement=function(){var e=this;return new Promise(function(t,n){e.findElementInterval(0,t,n)})},SitePlayer.prototype.tagName=function(e){return e&&e.tagName?e.tagName.toLowerCase():""},SitePlayer.prototype.execParams=function(e,t){return Object.assign({adUnitOptions:this.adUnitOptions,adUnitMeta:this.adUnitMeta,siteplayer:this,player:this},e,t)},SitePlayer.prototype.findElementInterval=function(e,t,n){if(e>=SitePlayer.findElemMaxTime)n("Site player type:"+this.adUnitOptions.site_player.type+", selector: "+this.adUnitOptions.selector);else{try{if(null!==this.getDOMElement())return void t()}catch(e){}setTimeout(this.findElementInterval,SitePlayer.findElemIntervalTime,e+SitePlayer.findElemIntervalTime,t,n)}},SitePlayer}();SitePlayer.findElemMaxTime=6e4,SitePlayer.findElemIntervalTime=150;var SitePlayerDM=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.pausePlayer=function(){var e=r.getPlayer();e.paused||e.pause()},r}return __extends(t,e),t.prototype.play=function(){e.prototype.play.call(this),this.getPlayer().play()},t.prototype.forcePause=function(){var e=this;return this.ready().then(function(){var t=e.getPlayer();t.pause(),t.addEventListener("play",e.pausePlayer)})},t.prototype.hide=function(){e.prototype.hide.call(this),this.display=this.getPlayer().style.display,this.getPlayer().style.display="none"},t.prototype.show=function(){e.prototype.show.call(this),this.getPlayer().style.display=this.display,this.getPlayer().removeEventListener("play",this.pausePlayer)},t.prototype.ready=function(){var e=this;return new Promise(function(t){var n=window.setInterval(function(){e.getPlayer()&&(window.clearInterval(n),t())},250)})},t.prototype.getPlayer=function(){try{if(!DM||!DM.Player||!DM.Player._INSTANCES)return null;var e=this.getDOMElement();if(!e)return null;var t="iframe"===this.tagName(e)?e:e.querySelector("iframe");if(t)return DM.Player._INSTANCES[t.id]}catch(e){}return null},t}(SitePlayer),SitePlayerIFrame=function(e){function t(t,n){return e.call(this,t,n)||this}return __extends(t,e),t.prototype.play=function(){e.prototype.play.call(this)},t.prototype.forcePause=function(){var e=this;return new Promise(function(t){e.ready().then(function(){e.siteElem=e.getDOMElement();var n=document.createElement("div");n.style.height=e.height()+"px",n.style.width=e.width()+"px",e.placeholder=n,e.siteElem.parentElement.insertBefore(n,e.siteElem),e.siteElem.parentNode.removeChild(e.siteElem),setTimeout(t,250)})})},t.prototype.hide=function(){e.prototype.hide.call(this);var t=this.getDOMElement();this.display=t.style.display,t.style.display="none"},t.prototype.show=function(){e.prototype.show.call(this),this.getDOMElement().style.display=this.display,this.placeholder.parentElement.insertBefore(this.siteElem,this.placeholder),this.placeholder.parentNode.removeChild(this.placeholder)},t.prototype.getDOMElement=function(){return this.placeholder?this.placeholder:e.prototype.getDOMElement.call(this)},t.prototype.ready=function(){var e=this;return new Promise(function(t){var n=window.setInterval(function(){e.getPlayer()&&(window.clearInterval(n),t())},250)})},t.prototype.getPlayer=function(){try{var e=this.getDOMElement();if(!e)return null;var t="iframe"===this.tagName(e)?e:e.querySelector("iframe");if(t)return t}catch(e){}return null},t}(SitePlayer),SitePlayerIMA3=function(e){function t(t,n){return e.call(this,t,n)||this}return __extends(t,e),t}(SitePlayer),SitePlayerJWPlayerHTML5=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.pausePlayer=function(){r.getPlayer().pause(!0)},r}return __extends(t,e),t.prototype.play=function(){e.prototype.play.call(this),this.getPlayer().play()},t.prototype.forcePause=function(){var e=this;return this.ready().then(function(){e.getPlayer().on("play",e.pausePlayer),e.pausePlayer()})},t.prototype.hide=function(){e.prototype.hide.call(this),this.getPlayer().getContainer().style.setProperty("display","none","")},t.prototype.show=function(){e.prototype.show.call(this),this.getPlayer().getContainer().style.setProperty("display","block",""),this.getPlayer().off("play",this.pausePlayer)},t.prototype.width=function(){var t=this.getPlayer();return t?t.getWidth():e.prototype.width.call(this)},t.prototype.height=function(){var t=this.getPlayer();return t?t.getHeight():e.prototype.height.call(this)},t.prototype.ready=function(){var e=this;return new Promise(function(t){e.findPlayer(function(e){e.getContainer().innerHTML?setTimeout(t,200):e.on("ready",function(){setTimeout(t,200)})})})},t.prototype.findPlayer=function(e){var t=this,n=0,r=window.setInterval(function(){var i=t.getPlayer();i&&(window.clearInterval(r),e(i)),(n+=1)>100&&window.clearInterval(r)},100)},t.prototype.getPlayer=function(){try{var e=this.getDOMElement(),t=e.id?jwplayer(e.id):null;return t&&"id"in t?t:null}catch(e){return null}},t}(SitePlayer),SitePlayerJWPlayerFlash=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.MAX_PLAY_TRY=20,r.pausePlayer=function(){r.getPlayer().pause(!0)},r}return __extends(t,e),t.prototype.play=function(){var t=this,n=0,r=window.setInterval(function(){(n+=1)>t.MAX_PLAY_TRY||"playing"===t.getPlayer().getState()?(window.clearInterval(r),e.prototype.play.call(t)):t.getPlayer().play()},100)},t.prototype.forcePause=function(){var e=this;return this.ready().then(function(){e.getPlayer().on("play",e.pausePlayer),e.pausePlayer()})},t.prototype.hide=function(){e.prototype.hide.call(this);var t=this.getPlayer().getContainer();this.origStyles={left:t.style.left||"",position:t.style.position||"",top:t.style.top||""},t.style.position="fixed",t.style.top="-10000px",t.style.left="-10000px"},t.prototype.show=function(){e.prototype.show.call(this);var t=this.getPlayer().getContainer();t.style.position=this.origStyles.position,t.style.top=this.origStyles.top,t.style.left=this.origStyles.left,this.getPlayer().off("play",this.pausePlayer)},t.prototype.width=function(){var t=this.getPlayer();return t?t.getWidth():e.prototype.width.call(this)},t.prototype.height=function(){var t=this.getPlayer();return t?t.getHeight():e.prototype.height.call(this)},t.prototype.ready=function(){var e=this;return new Promise(function(t){e.findPlayer(function(e){e.getContainer().innerHTML?setTimeout(t,200):e.on("ready",function(){setTimeout(t,200)})})})},t.prototype.findPlayer=function(e){var t=this,n=0,r=window.setInterval(function(){var i=t.getPlayer();i&&(window.clearInterval(r),e(i)),(n+=1)>100&&window.clearInterval(r)},100)},t.prototype.getPlayer=function(){try{var e=this.getDOMElement(),t=e&&e.id?jwplayer(e.id):null;return t&&"id"in t?t:null}catch(e){return null}},t}(SitePlayer),SitePlayerVideojs=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.pausePlayer=function(){r.getPlayer().paused()||r.getPlayer().pause()},r}return __extends(t,e),t.prototype.play=function(){e.prototype.play.call(this),this.getPlayer().play()},t.prototype.forcePause=function(){var e=this;return this.ready().then(function(){e.getPlayer().autoplay(!1),e.getPlayer().on("play",e.pausePlayer),e.pausePlayer()})},t.prototype.hide=function(){e.prototype.hide.call(this),this.getPlayer().hide()},t.prototype.show=function(){e.prototype.show.call(this),this.getPlayer().show(),this.getPlayer().off("play",this.pausePlayer)},t.prototype.width=function(){var t=this.getPlayer();return t&&t.width()||e.prototype.width.call(this)},t.prototype.height=function(){var t=this.getPlayer();return t&&t.height()||e.prototype.height.call(this)},t.prototype.ready=function(){var e=this;return new Promise(function(t){var n=window.setInterval(function(){var r=e.getPlayer();r&&(window.clearInterval(n),r.ready(function(){t()}))},250)})},t.prototype.getPlayer=function(){try{var e=this.getDOMElement();return e.id||(e.id=obfuscate(Math.random().toString(36))),this.id=e.id,videojs(this.id)}catch(e){return null}},t}(SitePlayer);function getSitePlayer(e,t){switch(Debug.log("site player type: "+e.site_player.type,e),e.site_player.type){case"videojs":return new SitePlayerVideojs(e,t);case"jwplayer":case"jwplayer-html5":return new SitePlayerJWPlayerHTML5(e,t);case"jwplayer-flash":return new SitePlayerJWPlayerFlash(e,t);case"iframe":return new SitePlayerIFrame(e,t);case"dm":return new SitePlayerDM(e,t);case"ima3":return new SitePlayerIMA3(e,t);default:return new SitePlayer(e,t)}}var startCount=0,isScriptInit=!1,isDisplayInit=!1;function filterByAdunitCustomParams(e,t){return e.filter(function(e){return e&&t.adunits.hasOwnProperty(e.adunit_uuid)})}function updateAdunitsCustomParams(e,t){return e.map(function(e){return updateAdunitCustomParams(e,t)})}function updateAdunitCustomParams(e,t){return Object.assign({},e,{adunit_custom:t.adunits[e.adunit_uuid]||{}})}function hasAdunitCustomParams(e){return Object.keys(e.adunits).length>0}function getCommands(e){var t=getAppCache(e).cache,n=t.options;return{backfill_script:function(n){Object.keys(n.adunits).forEach(function(n){var r=findAdunitByID(t,n),i=getAdsCache(n);i&&(i.type===IMA3PlayerAutoType?i.destroy():i.type===IMA3PlayerManualType&&i.destroy(),removeAdsCache(n)),new AdsScript(e,r,!0).load()})},display:function(r){if(!isDisplayInit){isDisplayInit=!0,Debug.log("[STARTAPP] trying to load position display");var i=getAdunitsByPosition(t,Position.DISPLAY);hasAdunitCustomParams(r)?i=filterByAdunitCustomParams(i,r):n.site_custom=Object.assign({},n.site_custom,r.site),(i=updateAdunitsCustomParams(i,r)).forEach(function(r){if(canRecover(r)&&canLoad(n,r)){Debug.log("[STARTAPP] found display selector: '"+r.selector+"', starting display",r),generateAdunitMeta(t,r.adunit_uuid);var i=new AdsDisplay(e,r);i.load(),setAdsCache(i)}})}},init:function(r){var i=!1;setTimeout(function(){i||CMDEvents.exec(ADSLOT_DETECTED,void 0,{adslot_detected:!1})},1e4),(startCount+=1)>1&&initPageID();var o=getInstreamOutstreamAdunits(t);1===startCount&&o.forEach(function(e){generateAdunitMeta(t,e.adunit_uuid,{divID:makeRandomId(10*Math.random()+6),videoID:makeRandomId(10*Math.random()+6)})}),hasAdunitCustomParams(r)?o=filterByAdunitCustomParams(o,r):n.site_custom=Object.assign({},n.site_custom,r.site),Debug.log("[STARTAPP] trying to load position instream/outstream");var a=[];o.forEach(function(e){var t=getAdsCache(e.adunit_uuid);t&&(Debug.log("[ADS] cleaning up existing ima3 instream/outstream adunit which are running",e),a.push(new Promise(function(e){t.type===IMA3PlayerManualType?t.destroy(e):t.type===IMA3PlayerAutoType&&t.destroy(e)})),removeAdsCache(e.adunit_uuid))}),Promise.all(a).then(function(){(o=updateAdunitsCustomParams(o,r)).forEach(function(r){if(getAdsCache(r.adunit_uuid))Debug.log("[ADS] adunit still pending. skipping init",r);else if(canRecover(r)&&canLoad(n,r)){generateAdunitMeta(t,r.adunit_uuid);var o=getSitePlayer(r,t.adUnitMeta[r.adunit_uuid]);Debug.log("[ADS] trying to find element: '"+r.selector+"'",r),o.findElement().then(function(){Debug.log("[ADS] found element: '"+r.selector+"', starting ads player",r),i=!0;try{var t;CMDEvents.exec(ADSLOT_DETECTED,r,{adslot_detected:!0}),r.auto_ad?((t=new IMA3PlayerAuto(e,r,o)).load(),setAdsCache(t)):((t=new IMA3PlayerManual(e,r,o)).load(),setAdsCache(t))}catch(e){Debug.log("[ADS] failed to start ads player: "+e.message,r)}}).catch(function(e){Debug.log("[ADS] failed to find the element "+r.selector+": "+e,r)})}})})},log_event:function(e){var r=t.adUnitOptions[0];"string"!=typeof e&&(e=JSON.stringify(e));var i=getAdsCache(r.adunit_uuid);requestURL("tracker",requestConfig(n,{logger_event:e,pass_through:!0},{},i))},scripts:function(r){if(!isScriptInit){isScriptInit=!0,Debug.log("[STARTAPP] trying to load position scripts");var i=getAdunitsByPosition(t,Position.SCRIPT);hasAdunitCustomParams(r)?i=filterByAdunitCustomParams(i,r):n.site_custom=Object.assign({},n.site_custom,r.site),(i=updateAdunitsCustomParams(i,r)).forEach(function(r){if(r.position===Position.SCRIPT&&canRecover(r)&&canLoad(n,r)){generateAdunitMeta(t,r.adunit_uuid),Debug.log("[STARTAPP] found script selector: '"+r.selector+"', starting script",r);var i=new AdsScript(e,r);i.load(),setAdsCache(i)}})}},ad:function(e){var n=findAdunit(t,function(t){return e.name===t.name||e.adunit_uuid===t.adunit_uuid||e.adunit_id===t.adunit_id}),r=setInterval(function(){var t,i=getAdsCache(n.adunit_uuid);i&&i.type===IMA3PlayerManualType&&(clearInterval(r),i.adUnitOptions=updateAdunitCustomParams(i.adUnitOptions,{adunits:(t={},t[n.adunit_uuid]=e,t)}),i.startAd(i.getCustomParams().breakId))},200)}}}var win=window,_a;setup(win,function(){var e=getAppCache(win).cache,t=e.appMeta.adblock_detected;if(t){if(initInventory(e),isValidSubscription(e.options)){var n=getPAPI();n.on("adslot_detected",function(e){execPAPIAdslotDetected({adblock_detected:t,adslot_detected:e.adslot_detected})}),initCMDQueue(getCommands(win))&&(e.options.display_onload?n.$cmd.push(["display"]):Debug.log("[STARTAPP] waiting for pAPI display cmd."),e.options.scripts_onload?n.$cmd.push(["scripts"]):Debug.log("[STARTAPP] waiting for pAPI scripts cmd."),e.options.start_onload?n.$cmd.push(["init"]):Debug.log("[STARTAPP] waiting for pAPI init."))}}else execPAPIAdslotDetected({adblock_detected:t,adslot_detected:!1})})}();